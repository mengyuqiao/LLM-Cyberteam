{"CVE Code": "CVE-2018-8897", "Description": "A statement in the System Programming Guide of the Intel 64 and IA-32 Architectures Software Developer's Manual (SDM) was mishandled in the development of some or all operating-system kernels, resulting in unexpected behavior for #DB exceptions that are deferred by MOV SS or POP SS, as demonstrated by (for example) privilege escalation in Windows, macOS, some Xen configurations, or FreeBSD, or a Linux kernel crash. The MOV to SS and POP SS instructions inhibit interrupts (including NMIs), data breakpoints, and single step trap exceptions until the instruction boundary following the next instruction (SDM Vol. 3A; section 6.8.3). (The inhibited data breakpoints are those on memory accessed by the MOV to SS or POP to SS instruction itself.) Note that debug exceptions are not inhibited by the interrupt enable (EFLAGS.IF) system flag (SDM Vol. 3A; section 2.3). If the instruction following the MOV to SS or POP to SS instruction is an instruction like SYSCALL, SYSENTER, INT 3, etc. that transfers control to the operating system at CPL < 3, the debug exception is delivered after the transfer to CPL < 3 is complete. OS kernels may not expect this order of events and may therefore experience unexpected behavior when it occurs.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2018-8897", "Vulnerability Categories": "Gain privilege", "Affected Products": "\nFreebsd\u00bbFreebsdVersions  from including (>=) 11.0andbefore (<) 11.1cpe:2.3:o:freebsd:freebsd:*:*:*:*:*:*:*:*Matching versions\nDebian\u00bbDebian Linux\u00bbVersion:7.0cpe:2.3:o:debian:debian_linux:7.0:*:*:*:*:*:*:*Matching versions\nDebian\u00bbDebian Linux\u00bbVersion:8.0cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*Matching versions\nDebian\u00bbDebian Linux\u00bbVersion:9.0cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*Matching versions\nRedhat\u00bbEnterprise Virtualization Manager\u00bbVersion:3.0cpe:2.3:o:redhat:enterprise_virtualization_manager:3.0:*:*:*:*:*:*:*Matching versions\nRedhat\u00bbEnterprise Linux Server\u00bbVersion:7.0cpe:2.3:o:redhat:enterprise_linux_server:7.0:*:*:*:*:*:*:*Matching versions\nRedhat\u00bbEnterprise Linux Workstation\u00bbVersion:7.0cpe:2.3:o:redhat:enterprise_linux_workstation:7.0:*:*:*:*:*:*:*Matching versions\nApple\u00bbMac Os XVersions  before (<) 10.13.4cpe:2.3:o:apple:mac_os_x:*:*:*:*:*:*:*:*Matching versions\nCitrix\u00bbXenserver\u00bbVersion:6.2.0cpe:2.3:a:citrix:xenserver:6.2.0:*:*:*:*:*:*:*Matching versions\nCitrix\u00bbXenserver\u00bbVersion:6.0.2cpe:2.3:a:citrix:xenserver:6.0.2:*:*:*:*:*:*:*Matching versions\nCitrix\u00bbXenserver\u00bbVersion:7.0cpe:2.3:a:citrix:xenserver:7.0:*:*:*:*:*:*:*Matching versions\nCitrix\u00bbXenserver\u00bbVersion:6.5cpe:2.3:a:citrix:xenserver:6.5:*:*:*:*:*:*:*Matching versions\nCitrix\u00bbXenserver\u00bbVersion:7.1cpe:2.3:a:citrix:xenserver:7.1:*:*:*:*:*:*:*Matching versions\nCitrix\u00bbXenserver\u00bbVersion:7.2cpe:2.3:a:citrix:xenserver:7.2:*:*:*:*:*:*:*Matching versions\nCitrix\u00bbXenserver\u00bbVersion:7.4cpe:2.3:a:citrix:xenserver:7.4:*:*:*:*:*:*:*Matching versions\nCitrix\u00bbXenserver\u00bbVersion:7.3cpe:2.3:a:citrix:xenserver:7.3:*:*:*:*:*:*:*Matching versions\nCanonical\u00bbUbuntu Linux\u00bbVersion:14.04    LTSEditioncpe:2.3:o:canonical:ubuntu_linux:14.04:*:*:*:lts:*:*:*Matching versions\nCanonical\u00bbUbuntu Linux\u00bbVersion:16.04    LTSEditioncpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*Matching versions\nCanonical\u00bbUbuntu Linux\u00bbVersion:17.10cpe:2.3:o:canonical:ubuntu_linux:17.10:*:*:*:*:*:*:*Matching versions\nXEN\u00bbXEN\u00bbVersion:N/AForX86cpe:2.3:o:xen:xen:-:*:*:*:*:*:x86:*Matching versions\nSynology\u00bbSkynas\u00bbVersion:N/Acpe:2.3:a:synology:skynas:-:*:*:*:*:*:*:*Matching versions\nSynology\u00bbDiskstation Manager\u00bbVersion:6.0cpe:2.3:o:synology:diskstation_manager:6.0:*:*:*:*:*:*:*Matching versions\nSynology\u00bbDiskstation Manager\u00bbVersion:5.2cpe:2.3:o:synology:diskstation_manager:5.2:*:*:*:*:*:*:*Matching versions\nSynology\u00bbDiskstation Manager\u00bbVersion:6.1cpe:2.3:o:synology:diskstation_manager:6.1:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.10% Probability of exploitation activity in the next 30 days\n~ 42 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.07%  0.10%  +0.03 \n 2  2023-06-25  0.08%  0.07%  -0.01 \n 3  2023-05-20  0.07%  0.08%  +0.01 \n 4  2023-05-02  0.06%  0.07%  +0.01 \n 5  2023-03-30  0.06%  0.06%  0.00 \n 6  2023-03-07  12.63%  0.06%  -12.56 ", "CVSS Scores": "7.2", "CWE": [{"CWE_ID": "CWE-362 Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')", "CWE_link": "/cwe-details/362/Concurrent-Execution-using-Shared-Resource-with-Improper-Syn.html"}], "Reference": [{"ref_link": "http://openwall.com/lists/oss-security/2018/05/08/1", "ref_desc": "oss-security - Xen Security Advisory 260 (CVE-2018-8897) - x86: mishandling of debug exceptionsMailing List;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "http://www.huawei.com/en/psirt/security-advisories/huawei-sa-20190921-01-debug-en", "ref_desc": "Privilege Escalation Vulnerability in Some Huawei Products", "ref_cve_link": "N/A"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2018:1345", "ref_desc": "RHSA-2018:1345 - Security Advisory - Red Hat Customer PortalThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/7i9S_Sbz8glswMHGd1DcLSN5TBM.html"}, {"ref_link": "https://support.apple.com/HT208742", "ref_desc": "About the security content of Security Update 2018-001 - Apple SupportThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/7thepUdVbul1c-QCN5_Wf-lCyjo.html"}, {"ref_link": "https://github.com/torvalds/linux/commit/d8ba61ba58c88d5207c1ba2f7d9a2280e7d03be9", "ref_desc": "x86/entry/64: Don't use IST entry for #BP stack \u00b7 torvalds/linux@d8ba61b \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://security.netapp.com/advisory/ntap-20180927-0002/", "ref_desc": "CVE-2018-8897 x86 Debug Exception Vulnerability in NetApp Products | NetApp Product Security", "ref_cve_link": "N/A"}, {"ref_link": "https://www.synology.com/support/security/Synology_SA_18_21", "ref_desc": "Synology Inc.Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://www.freebsd.org/security/advisories/FreeBSD-SA-18:06.debugreg.asc", "ref_desc": "Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://usn.ubuntu.com/3641-2/", "ref_desc": "USN-3641-2: Linux kernel vulnerabilities | Ubuntu security noticesThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/9-nBDk2ngp4_8QPT1pl1-Z7oS2E.html"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2018:1355", "ref_desc": "RHSA-2018:1355 - Security Advisory - Red Hat Customer PortalThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/AbFK5BnJxGpQ4RuwcJr98yAAikY.html"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2018:1346", "ref_desc": "RHSA-2018:1346 - Security Advisory - Red Hat Customer PortalThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://www.debian.org/security/2018/dsa-4196", "ref_desc": "Debian -- Security Information -- DSA-4196-1 linuxThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/bF-gmZHRlz_bfmVuH68DSImVMi0.html"}, {"ref_link": "http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=d8ba61ba58c88d5207c1ba2f7d9a2280e7d03be9", "ref_desc": "kernel/git/torvalds/linux.git - Linux kernel source treePatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://xenbits.xen.org/xsa/advisory-260.html", "ref_desc": "XSA-260 - Xen Security AdvisoriesPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "http://www.securitytracker.com/id/1040744", "ref_desc": "Apple macOS/OS X LinkPresentation, Crash Reporter, and Kernel Bugs Let Remote Users Spoof the User Interface and Local Users Gain Elevated Privileges - SecurityTrackerThird Party Advisory;VDB EntryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/Fey71XgMa5EikFjaRkD26CkhM1o.html"}, {"ref_link": "https://lists.debian.org/debian-lts-announce/2018/05/msg00015.html", "ref_desc": "[SECURITY] [DLA 1383-1] xen security updateThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/gAa0Jk1VhouxEPGf8WNVHP3Z2Nk.html"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2018:1352", "ref_desc": "RHSA-2018:1352 - Security Advisory - Red Hat Customer PortalThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://www.kb.cert.org/vuls/id/631579", "ref_desc": "VU#631579 - Hardware debug exception documentation may result in unexpected behavior", "ref_cve_link": "N/A"}, {"ref_link": "https://help.ecostruxureit.com/display/public/UADCE725/Security+fixes+in+StruxureWare+Data+Center+Expert+v7.6.0", "ref_desc": "Security fixes in StruxureWare Data Center Expert v7.6.0 - User assistance for StruxureWare Data Center Expert 7.x - Help Center: Support for EcoStruxure IT, StruxureWare for Data Centers, and NetBotzCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/hN_L6D9Ieu_q6eudvDMkkwodgy8.html"}, {"ref_link": "http://www.securitytracker.com/id/1040882", "ref_desc": "Xen Debug Exception Handling Flaw Lets Local Users on a PV Guest System Gain Elevated Privileges on the Host System - SecurityTrackerThird Party Advisory;VDB Entry", "ref_cve_link": "N/A"}, {"ref_link": "https://bugzilla.redhat.com/show_bug.cgi?id=1567074", "ref_desc": "1567074 \u2013 (CVE-2018-8897) CVE-2018-8897 Kernel: error in exception handling leads to DoSIssue Tracking;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.debian.org/debian-lts-announce/2018/11/msg00013.html", "ref_desc": "[SECURITY] [DLA 1577-1] xen security updateCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/Iu4MiO0qjgho7uKPBPe3fqq_oXM.html"}, {"ref_link": "https://www.exploit-db.com/exploits/45024/", "ref_desc": "Microsoft Windows - POP/MOV SS Local Privilege Elevation (Metasploit)", "ref_cve_link": "N/A"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2018:1318", "ref_desc": "RHSA-2018:1318 - Security Advisory - Red Hat Customer PortalThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/jewwsFgTXyFd-FVwgz6M9cF26BQ.html"}, {"ref_link": "http://www.securitytracker.com/id/1040861", "ref_desc": "Linux Kernel Debug Exception Handling Flaw Lets Local Users Cause Denial of Service Conditions on the Target System - SecurityTrackerThird Party Advisory;VDB Entry", "ref_cve_link": "N/A"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2018:1524", "ref_desc": "RHSA-2018:1524 - Security Advisory - Red Hat Customer PortalThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/l3QIARtwAgCeWTf6itkcASGqHkQ.html"}, {"ref_link": "https://svnweb.freebsd.org/base?view=revision&revision=333368", "ref_desc": "[base] Revision 333368Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2018:1350", "ref_desc": "RHSA-2018:1350 - Security Advisory - Red Hat Customer PortalThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://usn.ubuntu.com/3641-1/", "ref_desc": "USN-3641-1: Linux kernel vulnerabilities | Ubuntu security noticesThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/nLx03d8NnFI-ugaboieDkqP-frk.html"}, {"ref_link": "https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8897", "ref_desc": "CVE-2018-8897 | Windows Kernel Elevation of Privilege VulnerabilityPatch;Third Party Advisory;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2018:1353", "ref_desc": "RHSA-2018:1353 - Security Advisory - Red Hat Customer PortalThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.debian.org/debian-lts-announce/2018/06/msg00000.html", "ref_desc": "[SECURITY] [DLA 1392-1] linux security updateThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/Pv_7cmJ2qhwpUNGkvm6dQnKUN-I.html"}, {"ref_link": "https://www.triplefault.io/2018/05/spurious-db-exceptions-with-pop-ss.html", "ref_desc": "Spurious #DB exceptions with the \"MOV SS\" and \"POP SS\" instructions (CVE-2018-8897)Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "http://www.securitytracker.com/id/1040849", "ref_desc": "Windows Kernel Multiple Flaws Let Local Users Bypass Security Restictions, Obtain Potentially Sensitive Information, and Gain Elevated Privileges on the Target System - SecurityTrackerThird Party Advisory;VDB EntryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/RAUydMnKsPdgvNfBJGVZexwiklY.html"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2018:1351", "ref_desc": "RHSA-2018:1351 - Security Advisory - Red Hat Customer PortalThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://www.exploit-db.com/exploits/44697/", "ref_desc": "Microsoft Windows - 'POP/MOV SS' Privilege EscalationExploit;Third Party Advisory;VDB Entry", "ref_cve_link": "N/A"}, {"ref_link": "https://patchwork.kernel.org/patch/10386677/", "ref_desc": "selftests/x86: Add mov_to_ss - PatchworkPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://www.debian.org/security/2018/dsa-4201", "ref_desc": "Debian -- Security Information -- DSA-4201-1 xenThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/vXfKfdCazNAnlODpryD2DKCJeR0.html"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2018:1349", "ref_desc": "RHSA-2018:1349 - Security Advisory - Red Hat Customer PortalThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2018:1348", "ref_desc": "RHSA-2018:1348 - Security Advisory - Red Hat Customer PortalThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/wccMhXvaK-J1cKUnv4M5O-kWK0k.html"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2018:1319", "ref_desc": "RHSA-2018:1319 - Security Advisory - Red Hat Customer PortalThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/wKQIaKR731m9imYu14f_jm_WFa0.html"}, {"ref_link": "http://www.securityfocus.com/bid/104071", "ref_desc": "Microsoft Windows Kernel CVE-2018-8897 Local Privilege Escalation VulnerabilityThird Party Advisory;VDB Entry", "ref_cve_link": "N/A"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2018:1354", "ref_desc": "RHSA-2018:1354 - Security Advisory - Red Hat Customer PortalThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/xBD0Nkvwk0f07yaVHGIG2V_b-is.html"}, {"ref_link": "https://support.citrix.com/article/CTX234679", "ref_desc": "Citrix XenServer Multiple Security UpdatesThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/YbPxoV_tVGGjN5of4KqUUkcQFMI.html"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2018:1347", "ref_desc": "RHSA-2018:1347 - Security Advisory - Red Hat Customer PortalThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/YOUDxVRmTuidxuRLh9Tdkd4aGNk.html"}, {"ref_link": "http://www.securitytracker.com/id/1040866", "ref_desc": "FreeBSD Kernel Debug Exception Handling Flaw Lets Local Users Gain Elevated Privileges - SecurityTrackerThird Party Advisory;VDB Entry", "ref_cve_link": "N/A"}, {"ref_link": "http://openwall.com/lists/oss-security/2018/05/08/4", "ref_desc": "oss-security - CVE-2018-8897: #DB exceptions that are deferred by MOV SS or POP SS may cause unexpected behaviorMailing List;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/can1357/CVE-2018-8897/", "ref_desc": "GitHub - can1357/CVE-2018-8897: Arbitrary code execution with kernel privileges using CVE-2018-8897.Exploit;Third Party Advisory", "ref_cve_link": "N/A"}]}