{"CVE Code": "CVE-2023-50731", "Description": "MindsDB is a SQL Server for artificial intelligence. Prior to version 23.11.4.1, the `put` method in `mindsdb/mindsdb/api/http/namespaces/file.py` does not validate the user-controlled name value, which is used in a temporary file name, which is afterwards opened for writing on lines 122-125, which leads to path injection. Later in the method, the temporary directory is deleted on line 151, but since we can write outside of the directory using the path injection vulnerability, the potentially dangerous file is not deleted. Arbitrary file contents can be written due to `f.write(chunk)` on line 125. Mindsdb does check later on line 149 in the `save_file` method in `file-controller.py` which calls the `_handle_source` method in `file_handler.py` if a file is of one of the types `csv`, `json`, `parquet`, `xls`, or `xlsx`. However, since the check happens after the file has already been written, the files will still exist (and will not be removed due to the path injection described earlier), just the `_handle_source` method will return an error. The same user-controlled source source is used also in another path injection sink on line 138. This leads to another path injection, which allows an attacker to delete any `zip` or `tar.gz` files on the server.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-50731", "Vulnerability Categories": "Directory traversal;Server-side request forgery (SSRF)", "Affected Products": "\nMindsdb\u00bbMindsdbVersions  before (<) 23.11.4.1cpe:2.3:a:mindsdb:mindsdb:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.06% Probability of exploitation activity in the next 30 days\n~ 25 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-11-21  0.05%  0.06%  +0.01 \n 2  2024-01-06  0.06%  0.05%  -0.01 ", "CVSS Scores": "9.1", "CWE": [{"CWE_ID": "CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')", "CWE_link": "/cwe-details/22/Improper-Limitation-of-a-Pathname-to-a-Restricted-Directory-.html"}, {"CWE_ID": "CWE-918 Server-Side Request Forgery (SSRF)", "CWE_link": "/cwe-details/918/Server-Side-Request-Forgery-SSRF-.html"}], "Reference": [{"ref_link": "https://securitylab.github.com/advisories/GHSL-2023-182_GHSL-2023-184_mindsdb_mindsdb/", "ref_desc": "GHSL-2023-182_GHSL-2023-184: Server-side request forgery (SSRF), arbitrary file write and limited file write vulnerabilities in mindsdb/mindsdb - CVE-2023-49795, CVE-2023-50731, CVE-2023-49796 | GitHuExploit;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L138", "ref_desc": "mindsdb/mindsdb/api/http/namespaces/file.py at 1821da719f34c022890c9ff25810218e71c5abbc \u00b7 mindsdb/mindsdb \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/mindsdb/mindsdb/security/advisories/GHSA-j8w6-2r9h-cxhj", "ref_desc": "GitHub Security Lab (GHSL) Vulnerability Report: Arbitary write GHSL-2023-182 \u00b7 Advisory \u00b7 mindsdb/mindsdb \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L122-L125", "ref_desc": "mindsdb/mindsdb/api/http/namespaces/file.py at 1821da719f34c022890c9ff25810218e71c5abbc \u00b7 mindsdb/mindsdb \u00b7 GitHubProduct", "ref_cve_link": "N/A"}]}