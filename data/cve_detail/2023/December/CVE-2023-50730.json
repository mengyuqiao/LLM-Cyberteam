{"CVE Code": "CVE-2023-50730", "Description": "Grackle is a GraphQL server written in functional Scala, built on the Typelevel stack. The GraphQL specification requires that GraphQL fragments must not form cycles, either directly or indirectly. Prior to Grackle version 0.18.0, that requirement wasn't checked, and queries with cyclic fragments would have been accepted for type checking and compilation. The attempted compilation of such fragments would result in a JVM `StackOverflowError` being thrown. Some knowledge of an applications GraphQL schema would be required to construct such a query, however no knowledge of any application-specific performance or other behavioural characteristics would be needed.\n\nGrackle uses the cats-parse library for parsing GraphQL queries. Prior to version 0.18.0, Grackle made use of the cats-parse `recursive` operator. However, `recursive` is not currently stack safe. `recursive` was used in three places in the parser: nested selection sets, nested input values (lists and objects), and nested list type declarations. Consequently, queries with deeply nested selection sets, input values or list types could be constructed which exploited this, causing a JVM `StackOverflowException` to be thrown during parsing. Because this happens very early in query processing, no specific knowledge of an applications GraphQL schema would be required to construct such a query.\n\nThe possibility of small queries resulting in stack overflow is a potential denial of service vulnerability. This potentially affects all applications using Grackle which have untrusted users. Both stack overflow issues have been resolved in the v0.18.0 release of Grackle. As a workaround, users could interpose a sanitizing layer in between untrusted input and Grackle query processing.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-50730", "Vulnerability Categories": "Denial of service", "Affected Products": "\nTypelevel\u00bbGrackleVersions  before (<) 0.18.0cpe:2.3:a:typelevel:grackle:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.06% Probability of exploitation activity in the next 30 days\n~ 28 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-11-21  0.05%  0.06%  +0.01 \n 2  2024-01-09  0.07%  0.05%  -0.02 ", "CVSS Scores": "7.5", "CWE": [{"CWE_ID": "CWE-400 Uncontrolled Resource Consumption", "CWE_link": "/cwe-details/400/Uncontrolled-Resource-Consumption.html"}, {"CWE_ID": "CWE-770 Allocation of Resources Without Limits or Throttling", "CWE_link": "/cwe-details/770/Allocation-of-Resources-Without-Limits-or-Throttling.html"}], "Reference": [{"ref_link": "https://github.com/typelevel/grackle/commit/56e244b91659cf385df590fc6c46695b6f36cbfd", "ref_desc": "Merge pull request from GHSA-g56x-7j6w-g8r8 \u00b7 typelevel/grackle@56e244b \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/typelevel/grackle/releases/tag/v0.18.0", "ref_desc": "Release v0.18.0 \u00b7 typelevel/grackle \u00b7 GitHubRelease Notes", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/typelevel/grackle/security/advisories/GHSA-g56x-7j6w-g8r8", "ref_desc": "StackOverflowError in GraphQL query processing \u00b7 Advisory \u00b7 typelevel/grackle \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}]}