{"CVE Code": "CVE-2023-49797", "Description": "PyInstaller bundles a Python application and all its dependencies into a single package. A PyInstaller built application, elevated as a privileged process, may be tricked by an unprivileged attacker into deleting files the unprivileged user does not otherwise have access to. A user is affected if **all** the following are satisfied: 1. The user runs an application containing either `matplotlib` or `win32com`. 2. The application is ran as administrator (or at least a user with higher privileges than the attacker). 3. The user's temporary directory is not locked to that specific user (most likely due to `TMP`/`TEMP` environment variables pointing to an unprotected, arbitrary, non default location). Either: A. The attacker is able to very carefully time the replacement of a temporary file with a symlink. This switch must occur exactly between `shutil.rmtree()`'s builtin symlink check and the deletion itself B: The application was built with Python 3.7.x or earlier which has no protection against Directory Junctions links. The vulnerability has been addressed in PR #7827 which corresponds to `pyinstaller >= 5.13.1`. Users are advised to upgrade. There are no known workarounds for this vulnerability.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-49797", "Vulnerability Categories": "N/A", "Affected Products": "\nPyinstaller\u00bbPyinstallerVersions  before (<) 5.13.1cpe:2.3:a:pyinstaller:pyinstaller:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 6 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2023-12-13  0.05%  0.04%  0.00 ", "CVSS Scores": "7.8", "CWE": [{"CWE_ID": "CWE-379 Creation of Temporary File in Directory with Insecure Permissions", "CWE_link": "/cwe-details/379/Creation-of-Temporary-File-in-Directory-with-Insecure-Permis.html"}, {"CWE_ID": "CWE-732 Incorrect Permission Assignment for Critical Resource", "CWE_link": "/cwe-details/732/Incorrect-Permission-Assignment-for-Critical-Resource.html"}], "Reference": [{"ref_link": "https://github.com/pyinstaller/pyinstaller/security/advisories/GHSA-9w2p-rh8c-v9g5", "ref_desc": "Local Privilege Escalation in Windows \u00b7 Advisory \u00b7 pyinstaller/pyinstaller \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2K2XIQLEMZIKUQUOWNDYWTEWYQTKMAN7/", "ref_desc": "[SECURITY] Fedora 38 Update: rdiff-backup-2.2.6-3.fc38 - package-announce - Fedora Mailing-Lists", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/python/cpython/blob/0fb18b02c8ad56299d6a2910be0bab8ad601ef24/Lib/shutil.py#L623", "ref_desc": "cpython/Lib/shutil.py at 0fb18b02c8ad56299d6a2910be0bab8ad601ef24 \u00b7 python/cpython \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/pyinstaller/pyinstaller/pull/7827", "ref_desc": "rthooks: secure temp directories used by matplotlib and win32com rthooks by rokm \u00b7 Pull Request #7827 \u00b7 pyinstaller/pyinstaller \u00b7 GitHubIssue Tracking;Patch", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ISRWT34FAF23PUOLVZ7RVWBZMWPDR5U7/", "ref_desc": "[SECURITY] Fedora 39 Update: rdiff-backup-2.2.6-3.fc39 - package-announce - Fedora Mailing-Lists", "ref_cve_link": "N/A"}]}