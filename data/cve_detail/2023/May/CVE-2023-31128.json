{"CVE Code": "CVE-2023-31128", "Description": "NextCloud Cookbook is a recipe library app. Prior to commit a46d9855 on the `master` branch and commit 489bb744 on the `main-0.9.x` branch, the `pull-checks.yml` workflow is vulnerable to command injection attacks because of using an untrusted `github.head_ref` field. The `github.head_ref` value is an attacker-controlled value. Assigning the value to `zzz\";echo${IFS}\"hello\";#` can lead to command injection. Since the permission is not restricted, the attacker has a write-access to the repository. This issue is fixed in commit a46d9855 on the `master` branch and commit 489bb744 on the `main-0.9.x` branch. There is no risk for the user of the app within the NextCloud server. This only affects the main repository and possible forks of it. Those who have forked the NextCloud Cookbook repository should make sure their forks are on the latest version to prevent code injection attacks and similar.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-31128", "Vulnerability Categories": "N/A", "Affected Products": "\nNextcloud\u00bbCookbookVersions  from including (>=) 0.9.0andbefore (<) 0.9.19cpe:2.3:a:nextcloud:cookbook:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.98% Probability of exploitation activity in the next 30 days\n~ 84 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-10-23  0.69%  0.98%  +0.29 \n 2  2024-08-30  0.62%  0.69%  +0.07 \n 3  2024-08-17  0.44%  0.62%  +0.18 \n 4  2024-06-01  0.12%  0.44%  +0.32 \n 5  2024-04-25  0.11%  0.12%  +0.02 \n 6  2023-06-06  0.05%  0.11%  +0.06 ", "CVSS Scores": "8.8", "CWE": [{"CWE_ID": "CWE-78 Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')", "CWE_link": "/cwe-details/78/Improper-Neutralization-of-Special-Elements-used-in-an-OS-Co.html"}], "Reference": [{"ref_link": "https://github.com/nextcloud/cookbook/blob/a14d6ffc4d45e1447556f68606129dfd6c1505cf/.github/workflows/pull-checks.yml#L67", "ref_desc": "cookbook/pull-checks.yml at a14d6ffc4d45e1447556f68606129dfd6c1505cf \u00b7 nextcloud/cookbook \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://securitylab.github.com/research/github-actions-untrusted-input/", "ref_desc": "Keeping your GitHub Actions and workflows secure Part 2: Untrusted input | GitHub Security LabExploit;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/cnUbNXWMpwLVHiT6fB5Xtz4U36s.html"}, {"ref_link": "https://github.com/nextcloud/cookbook/commit/a46d98559e2c64292da9ffb06138cccc2e50ae1b", "ref_desc": "Fix typo in workflow file \u00b7 nextcloud/cookbook@a46d985 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/nextcloud/cookbook/security/advisories/GHSA-c5pc-mf2f-xq8h", "ref_desc": "pull-checks.yml workflow is vulnerable \u00b7 Advisory \u00b7 nextcloud/cookbook \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/nextcloud/cookbook/commit/489bb744", "ref_desc": "Fix typo in workflow file \u00b7 nextcloud/cookbook@489bb74 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}]}