{"CVE Code": "CVE-2023-31137", "Description": "MaraDNS is open-source software that implements the Domain Name System (DNS). In version 3.5.0024 and prior, a remotely exploitable integer underflow vulnerability in the DNS packet decompression function allows an attacker to cause a Denial of Service by triggering an abnormal program termination.\n\nThe vulnerability exists in the `decomp_get_rddata` function within the `Decompress.c` file. When handling a DNS packet with an Answer RR of qtype 16 (TXT record) and any qclass, if the `rdlength` is smaller than `rdata`, the result of the line `Decompress.c:886` is a negative number `len = rdlength - total;`. This value is then passed to the `decomp_append_bytes` function without proper validation, causing the program to attempt to allocate a massive chunk of memory that is impossible to allocate. Consequently, the program exits with an error code of 64, causing a Denial of Service.\n\nOne proposed fix for this vulnerability is to patch `Decompress.c:887` by breaking `if(len <= 0)`, which has been incorporated in version 3.5.0036 via commit bab062bde40b2ae8a91eecd522e84d8b993bab58.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-31137", "Vulnerability Categories": "Denial of service", "Affected Products": "\nDebian\u00bbDebian Linux\u00bbVersion:10.0cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*Matching versions\nDebian\u00bbDebian Linux\u00bbVersion:11.0cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*Matching versions\nMaradns\u00bbMaradnsVersions  before (<) 3.4.10cpe:2.3:a:maradns:maradns:*:*:*:*:*:*:*:*Matching versions\nMaradns\u00bbMaradnsVersions  from including (>=) 3.5.0001andbefore (<) 3.5.0036cpe:2.3:a:maradns:maradns:*:*:*:*:*:*:*:*Matching versions\nFedoraproject\u00bbFedora\u00bbVersion:37cpe:2.3:o:fedoraproject:fedora:37:*:*:*:*:*:*:*Matching versions\nFedoraproject\u00bbFedora\u00bbVersion:38cpe:2.3:o:fedoraproject:fedora:38:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.19% Probability of exploitation activity in the next 30 days\n~ 57 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-11-29  0.18%  0.19%  +0.01 \n 2  2024-10-19  0.15%  0.18%  +0.03 \n 3  2024-08-13  0.13%  0.15%  +0.02 \n 4  2024-06-10  0.13%  0.13%  +0.00 \n 5  2024-05-15  0.10%  0.13%  +0.03 \n 6  2024-03-08  0.13%  0.10%  -0.03 \n 7  2023-06-30  0.10%  0.13%  +0.03 \n 8  2023-06-20  0.06%  0.10%  +0.04 \n 9  2023-05-25  0.05%  0.06%  +0.01 \n 10  2023-05-17  0.05%  0.05%  +0.01 ", "CVSS Scores": "7.5", "CWE": [{"CWE_ID": "CWE-191 Integer Underflow (Wrap or Wraparound)", "CWE_link": "/cwe-details/191/Integer-Underflow-Wrap-or-Wraparound-.html"}], "Reference": [{"ref_link": "https://github.com/samboy/MaraDNS/blob/08b21ea20d80cedcb74aa8f14979ec7c61846663/dns/Decompress.c#L886", "ref_desc": "MaraDNS/Decompress.c at 08b21ea20d80cedcb74aa8f14979ec7c61846663 \u00b7 samboy/MaraDNS \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.debian.org/debian-lts-announce/2023/06/msg00019.html", "ref_desc": "[SECURITY] [DLA 3457-1] maradns security updateMailing List;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/AJDBe6e0QcGn83KqACXhCB-dNT4.html"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/NB7LDZM5AGWC5BHHQHW6CP5OFNBBKFOQ/", "ref_desc": "Mailing List;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/c1hJHug97-4Wk3mX0OMd8d6VW3E.html"}, {"ref_link": "https://github.com/samboy/MaraDNS/security/advisories/GHSA-58m7-826v-9c3c", "ref_desc": "Integer Underflow Vulnerability in DNS Packet Decompression \u00b7 Advisory \u00b7 samboy/MaraDNS \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://www.debian.org/security/2023/dsa-5441", "ref_desc": "Debian -- Security Information -- DSA-5441-1 maradnsMailing List;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/mhoVJKfHLxXbxDVUZI5hgcdObUg.html"}, {"ref_link": "https://github.com/samboy/MaraDNS/commit/bab062bde40b2ae8a91eecd522e84d8b993bab58", "ref_desc": "Fix long standing issue in this code from 2002 \u00b7 samboy/MaraDNS@bab062b \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/3VSMLJX25MXGQ6A7UPOGK7VPUVDESPHL/", "ref_desc": "Mailing List;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/uyFQYPrH4IClK97-cyFnfOs9-6g.html"}]}