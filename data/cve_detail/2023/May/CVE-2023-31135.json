{"CVE Code": "CVE-2023-31135", "Description": "Dgraph is an open source distributed GraphQL database. Existing Dgraph audit logs are vulnerable to brute force attacks due to nonce collisions. The first 12 bytes come from a baseIv which is initialized when an audit log is created. The last 4 bytes come from the length of the log line being encrypted. This is problematic because two log lines will often have the same length, so due to these collisions we are reusing the same nonce many times. All audit logs generated by versions of Dgraph <v23.0.0 are affected. Attackers must have access to the system the logs are stored on. Dgraph users should upgrade to v23.0.0. Users unable to upgrade should store existing audit logs in a secure location and for extra security, encrypt using an external tool like `gpg`.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-31135", "Vulnerability Categories": "N/A", "Affected Products": "\nDgraph\u00bbDgraph\u00bbForGOVersions  before (<) 23.0.0cpe:2.3:a:dgraph:dgraph:*:*:*:*:*:go:*:*Matching versions", "EPSS Score": "0.05% Probability of exploitation activity in the next 30 days\n~ 15 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-05-23  0.05%  0.05%  -0.01 \n 2  2023-05-26  0.05%  0.05%  +0.01 ", "CVSS Scores": "5.5", "CWE": [{"CWE_ID": "CWE-326 Inadequate Encryption Strength", "CWE_link": "/cwe-details/326/Inadequate-Encryption-Strength.html"}], "Reference": [{"ref_link": "https://github.com/dgraph-io/dgraph/security/advisories/GHSA-92wq-q9pq-gw47", "ref_desc": "Dgraph Audit Log Encryption Vulnerability \u00b7 Advisory \u00b7 dgraph-io/dgraph \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/dgraph-io/dgraph/pull/8323", "ref_desc": "security(logging): fix aes implementation in audit logging by joshua-goldstein \u00b7 Pull Request #8323 \u00b7 dgraph-io/dgraph \u00b7 GitHubIssue Tracking;Patch", "ref_cve_link": "N/A"}, {"ref_link": "https://en.wikipedia.org/wiki/Cryptographic_nonce", "ref_desc": "Cryptographic nonce - WikipediaTechnical Description", "ref_cve_link": "N/A"}]}