{"CVE Code": "CVE-2023-32322", "Description": "Ombi is an open source application which allows users to request specific media from popular self-hosted streaming servers. Versions prior to 4.38.2 contain an arbitrary file read vulnerability where an Ombi administrative user may access files available to the Ombi server process on the host operating system. Ombi administrators may not always be local system administrators and so this may violate the security expectations of the system. The arbitrary file read vulnerability was present in `ReadLogFile` and `Download` endpoints in `SystemControllers.cs` as the parameter `logFileName` is not sanitized before being combined with the `Logs` directory. When using `Path.Combine(arg1, arg2, arg3)`, an attacker may be able to escape to folders/files outside of `Path.Combine(arg1, arg2)` by using \"..\" in `arg3`. In addition, by specifying an absolute path for `arg3`, `Path.Combine` will completely ignore the first two arguments and just return just `arg3`. This vulnerability can lead to information disclosure. The Ombi `documentation` suggests running Ombi as a Service with Administrator privileges. An attacker targeting such an application may be able to read the files of any Windows user on the host machine and certain system files. This issue has been addressed in commit `b8a8f029` and in release version 4.38.2. Users are advised to upgrade. There are no known workarounds for this vulnerability. This issue is also tracked as GHSL-2023-088.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-32322", "Vulnerability Categories": "Directory traversal;Information leak", "Affected Products": "\nOmbi\u00bbOmbiVersions  before (<) 4.38.2cpe:2.3:a:ombi:ombi:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.16% Probability of exploitation activity in the next 30 days\n~ 54 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-08-22  0.15%  0.16%  +0.02 \n 2  2024-05-24  0.12%  0.15%  +0.03 \n 3  2024-04-17  0.10%  0.12%  +0.02 \n 4  2023-05-27  0.05%  0.10%  +0.06 ", "CVSS Scores": "4.9", "CWE": [{"CWE_ID": "CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')", "CWE_link": "/cwe-details/22/Improper-Limitation-of-a-Pathname-to-a-Restricted-Directory-.html"}], "Reference": [{"ref_link": "https://github.com/Ombi-app/Ombi/blob/v4.36.1/src/Ombi/Controllers/V2/SystemController.cs#L58", "ref_desc": "Ombi/SystemController.cs at v4.36.1 \u00b7 Ombi-app/Ombi \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/Ombi-app/Ombi/commit/b8a8f029d80454d582bc4a2a05175106809335d0", "ref_desc": "Merge pull request from GHSA-28j3-84m7-gpjp \u00b7 Ombi-app/Ombi@b8a8f02 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://docs.ombi.app/guides/installation/#windows", "ref_desc": "Installation - Ombi DocsProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/Ombi-app/Ombi/blob/v4.36.1/src/Ombi/Controllers/V2/SystemController.cs#L46", "ref_desc": "Ombi/SystemController.cs at v4.36.1 \u00b7 Ombi-app/Ombi \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/Ombi-app/Ombi/security/advisories/GHSA-28j3-84m7-gpjp", "ref_desc": "GitHub Security Lab (GHSL) Vulnerability Report, Ombi: GHSL-2023-088 \u00b7 Advisory \u00b7 Ombi-app/Ombi \u00b7 GitHubExploit;Mitigation;Third Party Advisory", "ref_cve_link": "N/A"}]}