{"CVE Code": "CVE-2023-43635", "Description": "Vault Key Sealed With SHA1 PCRs\n\n\n\n\n\n\nThe measured boot solution implemented in EVE OS leans on a PCR locking mechanism.\n\nDifferent parts of the system update different PCR values in the TPM, resulting in a unique\nvalue for each PCR entry.\n\nThese PCRs are then used in order to seal/unseal a key from the TPM which is used to\nencrypt/decrypt the \u201cvault\u201d directory.\n\nThis \u201cvault\u201d directory is the most sensitive point in the system and as such, its content should\nbe protected.\n\nThis mechanism is noted in Zededa\u2019s documentation as the \u201cmeasured boot\u201d mechanism,\ndesigned to protect said \u201cvault\u201d.\n\nThe code that\u2019s responsible for generating and fetching the key from the TPM assumes that\nSHA256 PCRs are used in order to seal/unseal the key, and as such their presence is being\nchecked.\n\nThe issue here is that the key is not sealed using SHA256 PCRs, but using SHA1 PCRs.\nThis leads to several issues:\n\n\u2022 Machines that have their SHA256 PCRs enabled but SHA1 PCRs disabled, as well\nas not sealing their keys at all, meaning the \u201cvault\u201d is not protected from an attacker.\n\n\u2022 SHA1 is considered insecure and reduces the complexity level required to unseal the\nkey in machines which have their SHA1 PCRs enabled.\n\n\n\nAn attacker can very easily retrieve the contents of the \u201cvault\u201d, which will effectively render\nthe \u201cmeasured boot\u201d mechanism meaningless.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-43635", "Vulnerability Categories": "N/A", "Affected Products": "\nLinuxfoundation\u00bbEdge Virtualization EngineVersions  before (<) 9.5.0cpe:2.3:o:linuxfoundation:edge_virtualization_engine:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 7 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "8.8", "CWE": [{"CWE_ID": "CWE-327 Use of a Broken or Risky Cryptographic Algorithm", "CWE_link": "/cwe-details/327/Use-of-a-Broken-or-Risky-Cryptographic-Algorithm.html"}, {"CWE_ID": "CWE-328 Use of Weak Hash", "CWE_link": "/cwe-details/328/Use-of-Weak-Hash.html"}, {"CWE_ID": "CWE-522 Insufficiently Protected Credentials", "CWE_link": "/cwe-details/522/Insufficiently-Protected-Credentials.html"}], "Reference": [{"ref_link": "https://asrg.io/security-advisories/vault-key-sealed-with-sha1-pcrs/", "ref_desc": "Vault Key Sealed With SHA1 PCRs - Automotive Security Research GroupThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://asrg.io/security-advisories/cve-2023-43635/", "ref_desc": "Vault Key Sealed With SHA1 PCRs - Automotive Security Research Group", "ref_cve_link": "N/A"}]}