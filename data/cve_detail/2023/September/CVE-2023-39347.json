{"CVE Code": "CVE-2023-39347", "Description": "Cilium is a networking, observability, and security solution with an eBPF-based dataplane. An attacker with the ability to update pod labels can cause Cilium to apply incorrect network policies. This issue arises due to the fact that on pod update, Cilium incorrectly uses user-provided pod labels to select the policies which apply to the workload in question. This can affect Cilium network policies that use the namespace, service account or cluster constructs to restrict traffic, Cilium clusterwide network policies that use Cilium namespace labels to select the Pod and Kubernetes network policies. Non-existent construct names can be provided, which bypass all network policies applicable to the construct. For example, providing a pod with a non-existent namespace as the value of the `io.kubernetes.pod.namespace` label results in none of the namespaced CiliumNetworkPolicies applying to the pod in question. This attack requires the attacker to have Kubernetes API Server access, as described in the Cilium Threat Model. This issue has been resolved in: Cilium versions 1.14.2, 1.13.7, and 1.12.14. Users are advised to upgrade. As a workaround an admission webhook can be used to prevent pod label updates to the `k8s:io.kubernetes.pod.namespace` and `io.cilium.k8s.policy.*` keys.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-39347", "Vulnerability Categories": "N/A", "Affected Products": "\nCilium\u00bbCiliumVersions  before (<) 1.12.14cpe:2.3:a:cilium:cilium:*:*:*:*:*:*:*:*Matching versions\nCilium\u00bbCiliumVersions  from including (>=) 1.14.0andbefore (<) 1.14.2cpe:2.3:a:cilium:cilium:*:*:*:*:*:*:*:*Matching versions\nCilium\u00bbCiliumVersions  from including (>=) 1.13.0andbefore (<) 1.13.7cpe:2.3:a:cilium:cilium:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 7 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "9.0", "CWE": [{"CWE_ID": "CWE-345 Insufficient Verification of Data Authenticity", "CWE_link": "/cwe-details/345/Insufficient-Verification-of-Data-Authenticity.html"}], "Reference": [{"ref_link": "https://docs.cilium.io/en/latest/security/threat-model/#kubernetes-api-server-attacker", "ref_desc": "Threat Model \u2014 Cilium 1.15.0-dev documentationExploit;Technical Description;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/cilium/cilium/security/advisories/GHSA-gj2r-phwg-6rww", "ref_desc": "Kubernetes users may update Pod labels to bypass network policy \u00b7 Advisory \u00b7 cilium/cilium \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}]}