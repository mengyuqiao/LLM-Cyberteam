{"CVE Code": "CVE-2023-41893", "Description": "Home assistant is an open source home automation. The audit team\u2019s analyses confirmed that the `redirect_uri` and `client_id` are alterable when logging in. Consequently, the code parameter utilized to fetch the `access_token` post-authentication will be sent to the URL specified in the aforementioned parameters. Since an arbitrary URL is permitted and `homeassistant.local` represents the preferred, default domain likely used and trusted by many users, an attacker could leverage this weakness to manipulate a user and retrieve account access. Notably, this attack strategy is plausible if the victim has exposed their Home Assistant to the Internet, since after acquiring the victim\u2019s `access_token` the adversary would need to utilize it directly towards the instance to achieve any pertinent malicious actions. To achieve this compromise attempt, the attacker must send a link with a `redirect_uri` that they control to the victim\u2019s own Home Assistant instance. In the eventuality the victim authenticates via said link, the attacker would obtain code sent to the specified URL in `redirect_uri`, which can then be leveraged to fetch an `access_token`. Pertinently, an attacker could increase the efficacy of this strategy by registering a near identical domain to `homeassistant.local`, which at first glance may appear legitimate and thereby obfuscate any malicious intentions. This issue has been addressed in version 2023.9.0 and all users are advised to upgrade. There are no known workarounds for this vulnerability.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-41893", "Vulnerability Categories": "Information leak", "Affected Products": "\nHome-assistant\u00bbHome-assistantVersions  before (<) 2023.9.0cpe:2.3:a:home-assistant:home-assistant:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.07% Probability of exploitation activity in the next 30 days\n~ 31 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-11-20  0.06%  0.07%  +0.01 \n 2  2024-10-25  0.05%  0.06%  +0.01 \n 3  2024-09-18  0.05%  0.05%  +0.00 \n 4  2023-10-27  0.04%  0.05%  +0.00 ", "CVSS Scores": "5.4", "CWE": [{"CWE_ID": "CWE-200 Exposure of Sensitive Information to an Unauthorized Actor", "CWE_link": "/cwe-details/200/Exposure-of-Sensitive-Information-to-an-Unauthorized-Actor.html"}], "Reference": [{"ref_link": "https://github.com/home-assistant/core/security/advisories/GHSA-qhhj-7hrc-gqj5", "ref_desc": "Account takeover via auth_callback login \u00b7 Advisory \u00b7 home-assistant/core \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://www.home-assistant.io/blog/2023/10/19/security-audits-of-home-assistant/", "ref_desc": "Security audits of Home Assistant - Home AssistantVendor AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/zwmDwr24LidXBA6gwAbCrVkZzHM.html"}]}