{"CVE Code": "CVE-2023-46139", "Description": "KernelSU is a Kernel based root solution for Android. Starting in version 0.6.1 and prior to version 0.7.0, if a KernelSU installed device is infected with a malware whose app signing block specially constructed, it can take over root privileges on the device. The vulnerable verification logic actually obtains the signature of the last block with an id of `0x7109871a`, while the verification logic during Android installation is to obtain the first one. In addition to the actual signature upgrade that has been fixed (KSU thought it was V2 but was actually V3), there is also the problem of actual signature downgrading (KSU thought it was V2 but was actually V1). Find a condition in the signature verification logic that will cause the signature not to be found error, and KernelSU does not implement the same conditions, so KSU thinks there is a V2 signature, but the APK signature verification actually uses the V1 signature. This issue is fixed in version 0.7.0. As workarounds, keep the KernelSU manager installed and avoid installing unknown apps.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-46139", "Vulnerability Categories": "N/A", "Affected Products": "\nKernelsu\u00bbKernelsuVersions  from including (>=) 0.6.1andbefore (<) 0.7.0cpe:2.3:a:kernelsu:kernelsu:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 9 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "5.7", "CWE": [{"CWE_ID": "CWE-863 Incorrect Authorization", "CWE_link": "/cwe-details/863/Incorrect-Authorization.html"}], "Reference": [{"ref_link": "https://github.com/tiann/KernelSU/security/advisories/GHSA-86cp-3prf-pwqq", "ref_desc": "KernelSU signature validation mismatch \u00b7 Advisory \u00b7 tiann/KernelSU \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "http://aospxref.com/android-14.0.0_r2/xref/frameworks/base/core/java/android/util/apk/ApkSigningBlockUtils.java#770", "ref_desc": "ApkSigningBlockUtils.java - OpenGrok cross reference for /frameworks/base/core/java/android/util/apk/ApkSigningBlockUtils.javaThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/tiann/KernelSU/blob/344c08bb79ba12b692016750cda363f9f3500182/kernel/apk_sign.c#L188", "ref_desc": "KernelSU/kernel/apk_sign.c at 344c08bb79ba12b692016750cda363f9f3500182 \u00b7 tiann/KernelSU \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "http://aospxref.com/android-14.0.0_r2/xref/frameworks/base/core/java/android/util/apk/ApkSigningBlockUtils.java#783", "ref_desc": "ApkSigningBlockUtils.java - OpenGrok cross reference for /frameworks/base/core/java/android/util/apk/ApkSigningBlockUtils.javaThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://drive.google.com/drive/folders/1XdYCCAhC_mkt1k1IyUiwcgFsuOFvwNRl", "ref_desc": "KSUPoC - Google DriveThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/tiann/KernelSU/commit/d24813b2c3738f2f9bd762932141cadd948c354f", "ref_desc": "Merge pull request from GHSA-86cp-3prf-pwqq \u00b7 tiann/KernelSU@d24813b \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/tiann/KernelSU/blob/344c08bb79ba12b692016750cda363f9f3500182/kernel/apk_sign.c#L179C32-L179C32", "ref_desc": "KernelSU/kernel/apk_sign.c at 344c08bb79ba12b692016750cda363f9f3500182 \u00b7 tiann/KernelSU \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}]}