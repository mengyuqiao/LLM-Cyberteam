{"CVE Code": "CVE-2023-45672", "Description": "Frigate is an open source network video recorder. Prior to version 0.13.0 Beta 3, an unsafe deserialization vulnerability was identified in the endpoints used to save configurations for Frigate. This can lead to unauthenticated remote code execution. This can be performed through the UI at `/config` or through a direct call to `/api/config/save`. Exploiting this vulnerability requires the attacker to both know very specific information about a user's Frigate server and requires an authenticated user to be tricked into clicking a specially crafted link to their Frigate instance. This vulnerability could exploited by an attacker under the following circumstances: Frigate publicly exposed to the internet (even with authentication); attacker knows the address of a user's Frigate instance; attacker crafts a specialized page which links to the user's Frigate instance; attacker finds a way to get an authenticated user to visit their specialized page and click the button/link. Input is initially accepted through `http.py`. The user-provided input is then parsed and loaded by `load_config_with_no_duplicates`. However, `load_config_with_no_duplicates` does not sanitize this input by merit of using `yaml.loader.Loader` which can instantiate custom constructors. A provided payload will be executed directly at `frigate/util/builtin.py:110`. This issue may lead to pre-authenticated Remote Code Execution. Version 0.13.0 Beta 3 contains a patch.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-45672", "Vulnerability Categories": "Execute code", "Affected Products": "\nFrigate\u00bbFrigateVersions  up to, including, (<=) 0.13.0cpe:2.3:a:frigate:frigate:*:*:*:*:*:*:*:*Matching versions\nFrigate\u00bbFrigate\u00bbVersion:0.13.0UpdateBeta1cpe:2.3:a:frigate:frigate:0.13.0:beta1:*:*:*:*:*:*Matching versions\nFrigate\u00bbFrigate\u00bbVersion:0.13.0UpdateBeta2cpe:2.3:a:frigate:frigate:0.13.0:beta2:*:*:*:*:*:*Matching versions", "EPSS Score": "5.20% Probability of exploitation activity in the next 30 days\n~ 93 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-02  6.85%  5.20%  -1.66 \n 2  2024-11-18  5.86%  6.85%  +1.00 \n 3  2024-11-05  3.84%  5.86%  +2.01 \n 4  2024-09-29  3.28%  3.84%  +0.56 \n 5  2024-03-18  2.50%  3.28%  +0.78 \n 6  2024-01-12  1.81%  2.50%  +0.69 \n 7  2023-12-14  1.45%  1.81%  +0.36 \n 8  2023-11-09  0.08%  1.45%  +1.37 ", "CVSS Scores": "7.5", "CWE": [{"CWE_ID": "CWE-502 Deserialization of Untrusted Data", "CWE_link": "/cwe-details/502/Deserialization-of-Untrusted-Data.html"}], "Reference": [{"ref_link": "https://github.com/blakeblackshear/frigate/blob/5658e5a4cc7376504af9de5e1eff178939a13e7f/frigate/http.py#L998-L998", "ref_desc": "frigate/frigate/http.py at 5658e5a4cc7376504af9de5e1eff178939a13e7f \u00b7 blakeblackshear/frigate \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://securitylab.github.com/advisories/GHSL-2023-190_Frigate/", "ref_desc": "GHSL-2023-190: Several vulnerabilities in Frigate - CVE-2023-45672, CVE-2023-45671, CVE-2023-45670 | GitHub Security LabCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/GHsLzANUjWwA9SX4CYcMr4gwyvk.html"}, {"ref_link": "https://github.com/blakeblackshear/frigate/blob/5658e5a4cc7376504af9de5e1eff178939a13e7f/frigate/config.py#L1244-L1244", "ref_desc": "frigate/frigate/config.py at 5658e5a4cc7376504af9de5e1eff178939a13e7f \u00b7 blakeblackshear/frigate \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/blakeblackshear/frigate/blob/5658e5a4cc7376504af9de5e1eff178939a13e7f/frigate/util/builtin.py#L110-L110", "ref_desc": "frigate/frigate/util/builtin.py at 5658e5a4cc7376504af9de5e1eff178939a13e7f \u00b7 blakeblackshear/frigate \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/blakeblackshear/frigate/security/advisories/GHSA-qp3h-4q62-p428", "ref_desc": "Unsafe deserialization in `load_config_with_no_duplicates` of `frigate/util/builtin.py` (GHSL-2023-190) \u00b7 Advisory \u00b7 blakeblackshear/frigate \u00b7 GitHubExploit;Vendor Advisory", "ref_cve_link": "N/A"}]}