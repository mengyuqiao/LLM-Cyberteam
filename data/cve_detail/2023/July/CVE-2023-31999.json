{"CVE Code": "CVE-2023-31999", "Description": "All versions of @fastify/oauth2 used a statically generated state parameter at startup time and were used across all requests for all users. The purpose of the Oauth2 state parameter is to prevent Cross-Site-Request-Forgery attacks. As such, it should be unique per user and should be connected to the user's session in some way that will allow the server to validate it.\r\n\r\nv7.2.0 changes the default behavior to store the state in a cookie with the http-only and same-site=lax attributes set. The state is now by default generated for every user. Note that this contains a breaking change in the checkStateFunction function, which now accepts the full Request object.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-31999", "Vulnerability Categories": "Cross-site request forgery (CSRF)", "Affected Products": "\nFastify\u00bbOauth2Versions  before (<) 7.2.0cpe:2.3:a:fastify:oauth2:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.14% Probability of exploitation activity in the next 30 days\n~ 50 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-08-05  0.12%  0.14%  +0.02 \n 2  2024-07-10  0.07%  0.12%  +0.06 \n 3  2024-06-03  0.06%  0.07%  +0.01 \n 4  2023-07-18  0.05%  0.06%  +0.01 ", "CVSS Scores": "8.8", "CWE": [{"CWE_ID": "CWE-352 Cross-Site Request Forgery (CSRF)", "CWE_link": "/cwe-details/352/Cross-Site-Request-Forgery-CSRF-.html"}], "Reference": [{"ref_link": "https://auth0.com/docs/secure/attack-protection/state-parameters", "ref_desc": "Prevent Attacks and Redirect Users with OAuth 2.0 State ParametersExploit", "ref_cve_link": "N/A"}, {"ref_link": "https://hackerone.com/reports/2020418", "ref_desc": "Sign in | HackerOnePermissions Required", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/fastify/fastify-oauth2/releases/tag/v7.2.0", "ref_desc": "Release v7.2.0 \u00b7 fastify/fastify-oauth2 \u00b7 GitHubRelease Notes", "ref_cve_link": "N/A"}]}