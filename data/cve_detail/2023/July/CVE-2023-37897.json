{"CVE Code": "CVE-2023-37897", "Description": "Grav is a file-based Web-platform built in PHP. Grav is subject to a server side template injection (SSTI) vulnerability. The fix for another SSTI vulnerability using `|map`, `|filter` and `|reduce` twigs implemented in the commit `71bbed1` introduces bypass of the denylist due to incorrect return value from `isDangerousFunction()`, which allows to execute the payload prepending double backslash (`\\\\`). The `isDangerousFunction()` check in version 1.7.42 and onwards retuns `false` value instead of `true` when the `\\` symbol is found in the `$name`. This vulnerability can be exploited if the attacker has access to: 1. an Administrator account, or 2. a non-administrator, user account that has Admin panel access and Create/Update page permissions. A fix for this vulnerability has been introduced in commit `b4c6210` and is included in release version `1.7.42.2`. Users are advised to upgrade. There are no known workarounds for this vulnerability.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-37897", "Vulnerability Categories": "N/A", "Affected Products": "\nGetgrav\u00bbGrav\u00bbVersion:1.7.42cpe:2.3:a:getgrav:grav:1.7.42:*:*:*:*:*:*:*Matching versions\nGetgrav\u00bbGrav\u00bbVersion:1.7.42.1cpe:2.3:a:getgrav:grav:1.7.42.1:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.15% Probability of exploitation activity in the next 30 days\n~ 52 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-07-24  0.07%  0.15%  +0.08 \n 2  2024-06-17  0.06%  0.07%  +0.01 \n 3  2024-05-24  0.06%  0.06%  +0.01 \n 4  2023-07-29  0.05%  0.06%  +0.01 ", "CVSS Scores": "8.8", "CWE": [{"CWE_ID": "CWE-74 Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')", "CWE_link": "/cwe-details/74/Improper-Neutralization-of-Special-Elements-in-Output-Used-b.html"}, {"CWE_ID": "CWE-393 Return of Wrong Status Code", "CWE_link": "/cwe-details/393/Return-of-Wrong-Status-Code.html"}], "Reference": [{"ref_link": "https://github.com/getgrav/grav/commit/71bbed12f950de8335006d7f91112263d8504f1b", "ref_desc": "more SSTI fixes in Utils::isDangerousFunction() \u00b7 getgrav/grav@71bbed1 \u00b7 GitHubProductCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/93jEqeDugwsAZUSUYr3Gj2UKl0M.html"}, {"ref_link": "https://github.com/getgrav/grav/security/advisories/GHSA-9436-3gmp-4f53", "ref_desc": "Server-side Template Injection (SSTI) mitigation bypass via incorrect filtering of double backslash \u00b7 Advisory \u00b7 getgrav/grav \u00b7 GitHubExploit;Mitigation;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/getgrav/grav/commit/b4c62101a43051fc7f5349c7d0a5b6085375c1d7", "ref_desc": "SSTI attack mitigation - GHSA-9436-3gmp-4f53 \u00b7 getgrav/grav@b4c6210 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}]}