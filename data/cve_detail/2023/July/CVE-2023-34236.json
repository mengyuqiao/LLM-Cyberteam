{"CVE Code": "CVE-2023-34236", "Description": "Weave GitOps Terraform Controller (aka Weave TF-controller) is a controller for Flux to reconcile Terraform resources in a GitOps way. A vulnerability has been identified in Weave GitOps Terraform Controller which could allow an authenticated remote attacker to view sensitive information. This vulnerability stems from Weave GitOps Terraform Runners (`tf-runner`), where sensitive data is inadvertently printed - potentially revealing sensitive user data in their pod logs. In particular, functions `tfexec.ShowPlan`, `tfexec.ShowPlanRaw`, and `tfexec.Output` are implicated when the `tfexec` object set its `Stdout` and `Stderr` to be `os.Stdout` and `os.Stderr`. An unauthorized remote attacker could exploit this vulnerability by accessing these prints of sensitive information, which may contain configurations or tokens that could be used to gain unauthorized control or access to resources managed by the Terraform controller. A successful exploit could allow the attacker to utilize this sensitive data, potentially leading to unauthorized access or control of the system. This vulnerability has been addressed in Weave GitOps Terraform Controller versions `v0.14.4` and `v0.15.0-rc.5`. Users are urged to upgrade to one of these versions to mitigate the vulnerability. As a temporary measure until the patch can be applied, users can add the environment variable `DISABLE_TF_LOGS` to the tf-runners via the runner pod template of the Terraform Custom Resource. This will prevent the logging of sensitive information and mitigate the risk of this vulnerability.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-34236", "Vulnerability Categories": "Bypass;Information leak", "Affected Products": "\nWeave\u00bbGitops Terraform ControllerVersions  before (<) 0.14.4cpe:2.3:a:weave:gitops_terraform_controller:*:*:*:*:*:*:*:*Matching versions\nWeave\u00bbGitops Terraform Controller\u00bbVersion:0.15.0UpdateRC1cpe:2.3:a:weave:gitops_terraform_controller:0.15.0:rc1:*:*:*:*:*:*Matching versions\nWeave\u00bbGitops Terraform Controller\u00bbVersion:0.15.0UpdateRC2cpe:2.3:a:weave:gitops_terraform_controller:0.15.0:rc2:*:*:*:*:*:*Matching versions\nWeave\u00bbGitops Terraform Controller\u00bbVersion:0.15.0UpdateRC3cpe:2.3:a:weave:gitops_terraform_controller:0.15.0:rc3:*:*:*:*:*:*Matching versions\nWeave\u00bbGitops Terraform Controller\u00bbVersion:0.15.0UpdateRC4cpe:2.3:a:weave:gitops_terraform_controller:0.15.0:rc4:*:*:*:*:*:*Matching versions", "EPSS Score": "0.16% Probability of exploitation activity in the next 30 days\n~ 53 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-10-18  0.14%  0.16%  +0.02 \n 2  2024-07-20  0.12%  0.14%  +0.02 \n 3  2024-06-13  0.10%  0.12%  +0.02 \n 4  2023-08-01  0.08%  0.10%  +0.02 ", "CVSS Scores": "6.5", "CWE": [{"CWE_ID": "CWE-200 Exposure of Sensitive Information to an Unauthorized Actor", "CWE_link": "/cwe-details/200/Exposure-of-Sensitive-Information-to-an-Unauthorized-Actor.html"}], "Reference": [{"ref_link": "https://github.com/weaveworks/tf-controller/commit/9708fda28ccd0466cb0a8fd409854ab4d92f7dca", "ref_desc": "fix logging in tf-runner \u00b7 weaveworks/tf-controller@9708fda \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/weaveworks/tf-controller/commit/28282bc644054e157c3b9a3d38f1f9551ce09074", "ref_desc": "fix loggin in tf.output \u00b7 weaveworks/tf-controller@28282bc \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/weaveworks/tf-controller/issues/649", "ref_desc": "Fix logging for tf.output \u00b7 Issue #649 \u00b7 weaveworks/tf-controller \u00b7 GitHubExploit;Issue Tracking;Patch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/weaveworks/tf-controller/commit/98a0688036e9dbcf43fa84960d9a1ef3e09a69cf", "ref_desc": "fix loggin in tf.output \u00b7 weaveworks/tf-controller@98a0688 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/weaveworks/tf-controller/security/advisories/GHSA-6hvv-j432-23cv", "ref_desc": "Information Disclosure Vulnerability in Weave GitOps Terraform Controller \u00b7 Advisory \u00b7 weaveworks/tf-controller \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/weaveworks/tf-controller/issues/637", "ref_desc": "Output of plan json to stdout since v0.14.1 \u00b7 Issue #637 \u00b7 weaveworks/tf-controller \u00b7 GitHubExploit;Issue Tracking", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/weaveworks/tf-controller/commit/6323b355bd7f5d2ce85d0244fe0883af3881df4e", "ref_desc": "fix logging in tf-runner \u00b7 weaveworks/tf-controller@6323b35 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}]}