{"CVE Code": "CVE-2023-48309", "Description": "NextAuth.js provides authentication for Next.js. `next-auth` applications prior to version 4.24.5 that rely on the default Middleware authorization are affected by a vulnerability. A bad actor could create an empty/mock user, by getting hold of a NextAuth.js-issued JWT from an interrupted OAuth sign-in flow (state, PKCE or nonce). Manually overriding the `next-auth.session-token` cookie value with this non-related JWT would let the user simulate a logged in user, albeit having no user information associated with it. (The only property on this user is an opaque randomly generated string). This vulnerability does not give access to other users' data, neither to resources that require proper authorization via scopes or other means. The created mock user has no information associated with it (ie. no name, email, access_token, etc.) This vulnerability can be exploited by bad actors to peek at logged in user states (e.g. dashboard layout). `next-auth` `v4.24.5` contains a patch for the vulnerability. As a workaround, using a custom authorization callback for Middleware, developers can manually do a basic authentication.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-48309", "Vulnerability Categories": "Bypass;Gain privilege", "Affected Products": "\nNextauth.js\u00bbNext-auth\u00bbForNode.jsVersions  before (<) 4.24.5cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*Matching versions", "EPSS Score": "0.08% Probability of exploitation activity in the next 30 days\n~ 35 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-11-26  0.07%  0.08%  +0.01 \n 2  2024-10-20  0.06%  0.07%  +0.01 \n 3  2023-11-25  0.05%  0.06%  +0.02 ", "CVSS Scores": "5.3", "CWE": [{"CWE_ID": "CWE-285 Improper Authorization", "CWE_link": "/cwe-details/285/Improper-Authorization.html"}, {"CWE_ID": "CWE-863 Incorrect Authorization", "CWE_link": "/cwe-details/863/Incorrect-Authorization.html"}], "Reference": [{"ref_link": "https://github.com/nextauthjs/next-auth/security/advisories/GHSA-v64w-49xw-qq89", "ref_desc": "Possible user mocking that bypasses basic authentication \u00b7 Advisory \u00b7 nextauthjs/next-auth \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://next-auth.js.org/configuration/nextjs#advanced-usage", "ref_desc": "Next.js | NextAuth.jsTechnical Description", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/nextauthjs/next-auth/commit/d237059b6d0cb868c041ba18b698e0cee20a2f10", "ref_desc": "fix: differentiate between issued JWTs \u00b7 nextauthjs/next-auth@d237059 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://authjs.dev/guides/basics/role-based-access-control", "ref_desc": "Role-based access control | Auth.jsTechnical Description", "ref_cve_link": "N/A"}, {"ref_link": "https://next-auth.js.org/configuration/nextjs#middlewar", "ref_desc": "Next.js | NextAuth.jsTechnical Description", "ref_cve_link": "N/A"}]}