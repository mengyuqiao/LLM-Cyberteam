{"CVE Code": "CVE-2023-46254", "Description": "capsule-proxy is a reverse proxy for Capsule kubernetes multi-tenancy framework. A bug in the RoleBinding reflector used by `capsule-proxy` gives ServiceAccount tenant owners the right to list Namespaces of other tenants backed by the same owner kind and name. For example consider two tenants `solar` and `wind`. Tenant `solar`, owned by a ServiceAccount named `tenant-owner` in the Namespace `solar`. Tenant `wind`, owned by a ServiceAccount named `tenant-owner` in the Namespace `wind`. The Tenant owner `solar` would be able to list the namespaces of the Tenant `wind` and vice-versa, although this is not correct. The bug introduces an exfiltration vulnerability since allows the listing of Namespace resources of other Tenants, although just in some specific conditions: 1. `capsule-proxy` runs with the `--disable-caching=false` (default value: `false`) and 2. Tenant owners are ServiceAccount, with the same resource name, but in different Namespaces. This vulnerability doesn't allow any privilege escalation on the outer tenant Namespace-scoped resources, since the Kubernetes RBAC is enforcing this. This issue has been addressed in version 0.4.5. Users are advised to upgrade. There are no known workarounds for this vulnerability.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-46254", "Vulnerability Categories": "Gain privilege;Information leak", "Affected Products": "\nClastix\u00bbCapsule-proxyVersions  before (<) 0.4.5cpe:2.3:a:clastix:capsule-proxy:*:*:*:*:*:*:*:*Matching versions\nClastix\u00bbCapsuleVersions  before (<) 0.4.5cpe:2.3:a:clastix:capsule:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.05% Probability of exploitation activity in the next 30 days\n~ 22 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-11-12  0.05%  0.05%  +0.01 \n 2  2024-10-06  0.05%  0.05%  +0.00 \n 3  2023-11-15  0.04%  0.05%  +0.00 ", "CVSS Scores": "4.3", "CWE": [{"CWE_ID": "CWE-200 Exposure of Sensitive Information to an Unauthorized Actor", "CWE_link": "/cwe-details/200/Exposure-of-Sensitive-Information-to-an-Unauthorized-Actor.html"}], "Reference": [{"ref_link": "https://github.com/projectcapsule/capsule-proxy/commit/615202f7b02eaec7681336bd63daed1f39ae00c5", "ref_desc": "fix(rolebinding-reflector): namespaced name for serviceaccount users \u00b7 projectcapsule/capsule-proxy@615202f \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/projectcapsule/capsule-proxy/security/advisories/GHSA-6758-979h-249x", "ref_desc": "Owners of different tenants but with the same ServiceAccount name can see Namespaces of colliding tenants \u00b7 Advisory \u00b7 projectcapsule/capsule-proxy \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}]}