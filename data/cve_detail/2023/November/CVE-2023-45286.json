{"CVE Code": "CVE-2023-45286", "Description": "A race condition in go-resty can result in HTTP request body disclosure across requests. This condition can be triggered by calling sync.Pool.Put with the same *bytes.Buffer more than once, when request retries are enabled and a retry occurs. The call to sync.Pool.Get will then return a bytes.Buffer that hasn't had bytes.Buffer.Reset called on it. This dirty buffer will contain the HTTP request body from an unrelated request, and go-resty will append the current HTTP request body to it, sending two bodies in one request. The sync.Pool in question is defined at package level scope, so a completely unrelated server could receive the request body.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-45286", "Vulnerability Categories": "N/A", "Affected Products": "\nResty Project\u00bbResty\u00bbForGOVersions  up to, including, (<=) 2.10.0cpe:2.3:a:resty_project:resty:*:*:*:*:*:go:*:*Matching versions", "EPSS Score": "0.10% Probability of exploitation activity in the next 30 days\n~ 44 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-10-28  0.09%  0.10%  +0.02 \n 2  2023-12-05  0.05%  0.09%  +0.04 ", "CVSS Scores": "5.9", "CWE": [{"CWE_ID": "CWE-362 Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')", "CWE_link": "/cwe-details/362/Concurrent-Execution-using-Shared-Resource-with-Improper-Syn.html"}], "Reference": [{"ref_link": "https://github.com/go-resty/resty/issues/743", "ref_desc": "Request body is written multiple times \u00b7 Issue #743 \u00b7 go-resty/resty \u00b7 GitHubIssue Tracking", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/go-resty/resty/issues/739", "ref_desc": "DATA RACE in resty's middleware (go-resty/resty/v2.releaseBuffer()) \u00b7 Issue #739 \u00b7 go-resty/resty \u00b7 GitHubExploit;Issue Tracking", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/go-resty/resty/pull/745", "ref_desc": "Security: Don't put the same bytes.Buffer into sync.Pool twice by lattwood \u00b7 Pull Request #745 \u00b7 go-resty/resty \u00b7 GitHubIssue Tracking;Patch", "ref_cve_link": "N/A"}, {"ref_link": "https://pkg.go.dev/vuln/GO-2023-2328", "ref_desc": "GO-2023-2328 - Go PackagesVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/go-resty/resty/commit/577fed8730d79f583eb48dfc81674164e1fc471e", "ref_desc": "Don't put the same bytes.Buffer into sync.Pool twice (#745) \u00b7 go-resty/resty@577fed8 \u00b7 GitHub", "ref_cve_link": "N/A"}]}