{"CVE Code": "CVE-2023-24814", "Description": "TYPO3 is a free and open source Content Management Framework released under the GNU General Public License. In affected versions the TYPO3 core component `GeneralUtility::getIndpEnv()` uses the unfiltered server environment variable `PATH_INFO`, which allows attackers to inject malicious content. In combination with the TypoScript setting `config.absRefPrefix=auto`, attackers can inject malicious HTML code to pages that have not been rendered and cached, yet. As a result, injected values would be cached and delivered to other website visitors (persisted cross-site scripting). Individual code which relies on the resolved value of `GeneralUtility::getIndpEnv('SCRIPT_NAME')` and corresponding usages (as shown below) are vulnerable as well. Additional investigations confirmed that at least Apache web server deployments using CGI (FPM, FCGI/FastCGI, and similar) are affected. However, there still might be the risk that other scenarios like nginx, IIS, or Apache/mod_php are vulnerable. The usage of server environment variable `PATH_INFO` has been removed from corresponding processings in `GeneralUtility::getIndpEnv()`. Besides that, the public property `TypoScriptFrontendController::$absRefPrefix` is encoded for both being used as a URI component and for being used as a prefix in an HTML context. This mitigates the cross-site scripting vulnerability. Users are advised to update to TYPO3 versions 8.7.51 ELTS, 9.5.40 ELTS, 10.4.35 LTS, 11.5.23 LTS and 12.2.0 which fix this problem. For users who are unable to patch in a timely manner the TypoScript setting `config.absRefPrefix` should at least be set to a static path value, instead of using auto - e.g. `config.absRefPrefix=/`. This workaround **does not fix all aspects of the vulnerability**, and is just considered to be an intermediate mitigation to the most prominent manifestation.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-24814", "Vulnerability Categories": "Cross site scripting (XSS)", "Affected Products": "\nTypo3\u00bbTypo3Versions  from including (>=) 11.0.0andbefore (<) 11.5.23cpe:2.3:a:typo3:typo3:*:*:*:*:*:*:*:*Matching versions\nTypo3\u00bbTypo3Versions  from including (>=) 10.0.0andbefore (<) 10.4.36cpe:2.3:a:typo3:typo3:*:*:*:*:*:*:*:*Matching versions\nTypo3\u00bbTypo3Versions  from including (>=) 12.0.0andbefore (<) 12.2.0cpe:2.3:a:typo3:typo3:*:*:*:*:*:*:*:*Matching versions\nTypo3\u00bbTypo3Versions  from including (>=) 8.7.0andbefore (<) 9.7.51cpe:2.3:a:typo3:typo3:*:*:*:*:*:*:*:*Matching versions\nTypo3\u00bbTypo3Versions  from including (>=) 9.0.0andbefore (<) 9.5.40cpe:2.3:a:typo3:typo3:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.25% Probability of exploitation activity in the next 30 days\n~ 66 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-08-30  0.22%  0.25%  +0.03 \n 2  2024-07-20  0.26%  0.22%  -0.04 \n 3  2024-05-14  0.25%  0.26%  +0.01 \n 4  2024-03-11  0.26%  0.25%  -0.01 \n 5  2024-02-14  0.24%  0.26%  +0.02 \n 6  2024-01-08  0.19%  0.24%  +0.04 \n 7  2023-09-26  0.16%  0.19%  +0.04 \n 8  2023-08-23  0.14%  0.16%  +0.02 \n 9  2023-03-11  0.10%  0.14%  +0.04 \n 10  2023-03-07  1.11%  0.10%  -1.01 ", "CVSS Scores": "6.1", "CWE": [{"CWE_ID": "CWE-79 Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "CWE_link": "/cwe-details/79/Improper-Neutralization-of-Input-During-Web-Page-Generation-.html"}], "Reference": [{"ref_link": "https://docs.typo3.org/m/typo3/reference-typoscript/main/en-us/Setup/Config/Index.html#absrefprefix", "ref_desc": "CONFIG & config \u2014 TypoScript Reference main documentationNot Applicable", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/TYPO3/typo3/commit/0005a6fd86ab97eff8bf2e3a5828bf0e7cb6263a", "ref_desc": "[SECURITY] Prevent XSS due to wrong PATH_INFO evaluation \u00b7 TYPO3/typo3@0005a6f \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/TYPO3/typo3/blob/v11.5.22/typo3/sysext/frontend/Classes/Controller/TypoScriptFrontendController.php#L2547-L2549", "ref_desc": "typo3/TypoScriptFrontendController.php at v11.5.22 \u00b7 TYPO3/typo3 \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/TYPO3/typo3/blob/v11.5.22/typo3/sysext/core/Classes/Utility/GeneralUtility.php#L2481-L2484", "ref_desc": "typo3/GeneralUtility.php at v11.5.22 \u00b7 TYPO3/typo3 \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://typo3.org/security/advisory/typo3-psa-2023-001", "ref_desc": "TYPO3-PSA-2023-001: Important Security-Bulletin Pre-AnnouncementVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://typo3.org/security/advisory/typo3-core-sa-2023-001", "ref_desc": "TYPO3-CORE-SA-2023-001: Persisted Cross-Site Scripting in Frontend RenderingExploit;Mitigation;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/TYPO3/typo3/security/advisories/GHSA-r4f8-f93x-5qh3", "ref_desc": "Persisted Cross-Site Scripting in Frontend Rendering \u00b7 Advisory \u00b7 TYPO3/typo3 \u00b7 GitHubExploit;Mitigation;Vendor Advisory", "ref_cve_link": "N/A"}]}