{"CVE Code": "CVE-2022-46163", "Description": "Travel support program is a rails app to support the travel support program of openSUSE (TSP). Sensitive user data (bank account details, password Hash) can be extracted via Ransack query injection. Every deployment of travel-support-program below the patched version is affected. The travel-support-program uses the Ransack library to implement search functionality. In its default configuration, Ransack will allow for query conditions based on properties of associated database objects [1]. The `*_start`, `*_end` or `*_cont` search matchers [2] can then be abused to exfiltrate sensitive string values of associated database objects via character-by-character brute-force (A match is indicated by the returned JSON not being empty). A single bank account number can be extracted with <200 requests, a password hash can be extracted with ~1200 requests, all within a few minutes. The problem has been patched in commit d22916275c51500b4004933ff1b0a69bc807b2b7. In order to work around this issue, you can also cherry pick that patch, however it will not work without the Rails 5.0 migration that was done in #150, which in turn had quite a few pull requests it depended on.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-46163", "Vulnerability Categories": "Sql Injection;Information leak", "Affected Products": "\nOpensuse\u00bbTravel Support ProgramVersions  before (<) 2022-11-29cpe:2.3:a:opensuse:travel_support_program:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.17% Probability of exploitation activity in the next 30 days\n~ 54 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-08-02  0.15%  0.17%  +0.02 \n 2  2024-06-22  0.14%  0.15%  +0.01 \n 3  2024-02-12  0.12%  0.14%  +0.02 \n 4  2024-01-17  0.07%  0.12%  +0.05 \n 5  2023-12-11  0.06%  0.07%  +0.01 \n 6  2023-03-07  0.95%  0.06%  -0.89 ", "CVSS Scores": "7.5", "CWE": [{"CWE_ID": "CWE-74 Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')", "CWE_link": "/cwe-details/74/Improper-Neutralization-of-Special-Elements-in-Output-Used-b.html"}, {"CWE_ID": "CWE-89 Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')", "CWE_link": "/cwe-details/89/Improper-Neutralization-of-Special-Elements-used-in-an-SQL-C.html"}, {"CWE_ID": "CWE-200 Exposure of Sensitive Information to an Unauthorized Actor", "CWE_link": "/cwe-details/200/Exposure-of-Sensitive-Information-to-an-Unauthorized-Actor.html"}], "Reference": [{"ref_link": "https://github.com/openSUSE/travel-support-program/pull/158", "ref_desc": "Allow specific ransack queries by hellcp \u00b7 Pull Request #158 \u00b7 openSUSE/travel-support-program \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/openSUSE/travel-support-program/security/advisories/GHSA-2wwv-c6xh-cf68", "ref_desc": "Data exfiltration via Ransack query injection \u00b7 Advisory \u00b7 openSUSE/travel-support-program \u00b7 GitHubExploit;Patch;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/openSUSE/travel-support-program/commit/d22916275c51500b4004933ff1b0a69bc807b2b7", "ref_desc": "Allow specific ransack queries \u00b7 openSUSE/travel-support-program@d229162 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}]}