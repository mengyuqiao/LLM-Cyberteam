{"CVE Code": "CVE-2023-0242", "Description": "Rapid7 Velociraptor allows users to be created with different privileges on the server. Administrators are generally allowed to run any command on the server including writing arbitrary files. However, lower privilege users are generally forbidden from writing or modifying files on the server. The VQL copy() function applies permission checks for reading files but does not check for permission to write files. This allows a low privilege user (usually, users with the Velociraptor \"investigator\" role) to overwrite files on the server, including Velociraptor configuration files. To exploit this vulnerability, the attacker must already have a Velociraptor user account at a low privilege level (at least \"analyst\") and be able to log into the GUI and create a notebook where they can run the VQL query invoking the copy() VQL function. Typically, most users deploy Velociraptor with limited access to a trusted group (most users will be administrators within the GUI). This vulnerability is associated with program files https://github.Com/Velocidex/velociraptor/blob/master/vql/filesystem/copy.go https://github.Com/Velocidex/velociraptor/blob/master/vql/filesystem/copy.go and program routines copy(). This issue affects Velociraptor versions before 0.6.7-5. Version 0.6.7-5, released January 16, 2023, fixes the issue.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-0242", "Vulnerability Categories": "N/A", "Affected Products": "\nRapid7\u00bbVelociraptorVersions  before (<) 0.6.7-5cpe:2.3:a:rapid7:velociraptor:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.10% Probability of exploitation activity in the next 30 days\n~ 43 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-08-10  0.09%  0.10%  +0.01 \n 2  2024-06-30  0.09%  0.09%  +0.00 \n 3  2024-01-25  0.06%  0.09%  +0.03 \n 4  2023-12-19  0.05%  0.06%  +0.01 \n 5  2023-03-07  0.89%  0.05%  -0.84 ", "CVSS Scores": "8.8", "CWE": [{"CWE_ID": "CWE-269 Improper Privilege Management", "CWE_link": "/cwe-details/269/Improper-Privilege-Management.html"}, {"CWE_ID": "CWE-862 Missing Authorization", "CWE_link": "/cwe-details/862/Missing-Authorization.html"}], "Reference": [{"ref_link": "https://docs.velociraptor.app/announcements/2023-cves/#:~:text=to%20upgrade%20clients.-,CVE%2D2023%2D0242,-Insufficient%20Permission%20Check", "ref_desc": "Current CVEs :: Velociraptor - Digging deeper!Vendor Advisory", "ref_cve_link": "N/A"}]}