{"CVE Code": "CVE-2023-28837", "Description": "Wagtail is an open source content management system built on Django. Prior to versions 4.1.4 and 4.2.2, a memory exhaustion bug exists in Wagtail's handling of uploaded images and documents. For both images and documents, files are loaded into memory during upload for additional processing. A user with access to upload images or documents through the Wagtail admin interface could upload a file so large that it results in a crash of denial of service. The vulnerability is not exploitable by an ordinary site visitor without access to the Wagtail admin. It can only be exploited by admin users with permission to upload images or documents. Image uploads are restricted to 10MB by default, however this validation only happens on the frontend and on the backend after the vulnerable code. Patched versions have been released as Wagtail 4.1.4 and Wagtail 4.2.2). Site owners who are unable to upgrade to the new versions are encouraged to add extra protections outside of Wagtail to limit the size of uploaded files.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-28837", "Vulnerability Categories": "Denial of service", "Affected Products": "\nTorchbox\u00bbWagtailVersions  from including (>=) 4.2andbefore (<) 4.2.2cpe:2.3:a:torchbox:wagtail:*:*:*:*:*:*:*:*Matching versions\nTorchbox\u00bbWagtailVersions  before (<) 4.1.4cpe:2.3:a:torchbox:wagtail:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.33% Probability of exploitation activity in the next 30 days\n~ 72 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-11-22  0.23%  0.33%  +0.10 \n 2  2024-11-08  0.22%  0.23%  +0.01 \n 3  2024-10-24  0.21%  0.22%  +0.01 \n 4  2024-07-08  0.20%  0.21%  +0.01 \n 5  2024-04-09  0.11%  0.20%  +0.09 \n 6  2024-03-03  0.09%  0.11%  +0.02 \n 7  2023-04-13  0.05%  0.09%  +0.05 ", "CVSS Scores": "4.9", "CWE": [{"CWE_ID": "CWE-400 Uncontrolled Resource Consumption", "CWE_link": "/cwe-details/400/Uncontrolled-Resource-Consumption.html"}, {"CWE_ID": "CWE-770 Allocation of Resources Without Limits or Throttling", "CWE_link": "/cwe-details/770/Allocation-of-Resources-Without-Limits-or-Throttling.html"}], "Reference": [{"ref_link": "https://github.com/wagtail/wagtail/commit/cfa11bbe00dbe7ce8cd4c0bbfe2a898a690df2bf", "ref_desc": "Don't load temporary uploaded files into memory \u00b7 wagtail/wagtail@cfa11bb \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/wagtail/wagtail/releases/tag/v4.2.2", "ref_desc": "Release 4.2.2 \u00b7 wagtail/wagtail \u00b7 GitHubRelease NotesCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/5C21c0vTromniIQx1-9IHCBqCTY.html"}, {"ref_link": "https://github.com/wagtail/wagtail/commit/3c0c64642b9e5b8d28b111263c7f4bddad6c3880", "ref_desc": "Don't load images / documents into memory when calculating their hash \u00b7 wagtail/wagtail@3c0c646 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/wagtail/wagtail/security/advisories/GHSA-33pv-vcgh-jfg9", "ref_desc": "Denial-of-service via memory exhaustion when uploading large files \u00b7 Advisory \u00b7 wagtail/wagtail \u00b7 GitHubMitigation;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/wagtail/wagtail/releases/tag/v4.1.4", "ref_desc": "Release 4.1.4 \u00b7 wagtail/wagtail \u00b7 GitHubRelease Notes", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/wagtail/wagtail/commit/d4022310cbe497993459c3136311467c7ac6329a", "ref_desc": "Release note for CVE-2023-28837 in 4.1.4 \u00b7 wagtail/wagtail@d402231 \u00b7 GitHubRelease Notes", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/wagtail/wagtail/commit/c9d2fcd650a88d76ae122646142245e5927a9165", "ref_desc": "Release note for CVE-2023-28837 in 4.2.2 \u00b7 wagtail/wagtail@c9d2fcd \u00b7 GitHubRelease Notes", "ref_cve_link": "N/A"}, {"ref_link": "https://docs.wagtail.org/en/stable/reference/settings.html#wagtailimages-max-upload-size", "ref_desc": "Settings \u2014 Wagtail Documentation 4.2.2 documentationProduct", "ref_cve_link": "N/A"}]}