{"CVE Code": "CVE-2023-30845", "Description": "ESPv2 is a service proxy that provides API management capabilities using Google Service Infrastructure. ESPv2 2.20.0 through 2.42.0 contains an authentication bypass vulnerability. API clients can craft a malicious `X-HTTP-Method-Override` header value to bypass JWT authentication in specific cases.\n\nESPv2 allows malicious requests to bypass authentication if both the conditions are true: The requested HTTP method is **not** in the API service definition (OpenAPI spec or gRPC `google.api.http` proto annotations, and the specified `X-HTTP-Method-Override` is a valid HTTP method in the API service definition. ESPv2 will forward the request to your backend without checking the JWT. Attackers can craft requests with a malicious `X-HTTP-Method-Override` value that allows them to bypass specifying JWTs. Restricting API access with API keys works as intended and is not affected by this vulnerability.\n\nUpgrade deployments to release v2.43.0 or higher to receive a patch. This release ensures that JWT authentication occurs, even when the caller specifies `x-http-method-override`. `x-http-method-override` is still supported by v2.43.0+. API clients can continue sending this header to ESPv2.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-30845", "Vulnerability Categories": "Bypass;Gain privilege", "Affected Products": "\nGoogle\u00bbEspv2Versions  from including (>=) 2.20.0andbefore (<) 2.43.0cpe:2.3:a:google:espv2:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.09% Probability of exploitation activity in the next 30 days\n~ 40 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-11-16  0.09%  0.09%  0.00 \n 2  2024-05-28  0.08%  0.09%  +0.02 \n 3  2024-05-02  0.12%  0.08%  -0.04 \n 4  2024-03-26  0.12%  0.12%  0.00 \n 5  2023-09-22  0.08%  0.12%  +0.04 \n 6  2023-08-03  0.06%  0.08%  +0.02 \n 7  2023-05-10  0.05%  0.06%  +0.01 ", "CVSS Scores": "9.8", "CWE": [{"CWE_ID": "CWE-287 Improper Authentication", "CWE_link": "/cwe-details/287/Improper-Authentication.html"}], "Reference": [{"ref_link": "https://github.com/GoogleCloudPlatform/esp-v2/commit/e95670146f5e96bb5565b0a9c1e153886b3e04ce", "ref_desc": "move x-http-method-override to beginning of filter chain (#801) \u00b7 GoogleCloudPlatform/esp-v2@e956701 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/GoogleCloudPlatform/esp-v2/commit/0bcdfc024ce96b34db4e1b4f2211b509d9be93cd", "ref_desc": "Changelog for v2.43.0 \u00b7 GoogleCloudPlatform/esp-v2@0bcdfc0 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/GoogleCloudPlatform/esp-v2/commit/e98061ee4527a564506ba4e814c0ecf324dc2c6f", "ref_desc": "Add back in HTTP method override in service control filter (#802) \u00b7 GoogleCloudPlatform/esp-v2@e98061e \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/GoogleCloudPlatform/esp-v2/security/advisories/GHSA-6qmp-9p95-fc5f", "ref_desc": "JWT authentication bypass via `X-HTTP-Method-Override` header \u00b7 Advisory \u00b7 GoogleCloudPlatform/esp-v2 \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}]}