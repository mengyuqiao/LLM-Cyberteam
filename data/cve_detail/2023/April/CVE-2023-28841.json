{"CVE Code": "CVE-2023-28841", "Description": "Moby is an open source container framework developed by Docker Inc. that is distributed as Docker, Mirantis Container Runtime, and various other downstream projects/products. The Moby daemon component (`dockerd`), which is developed as moby/moby is commonly referred to as *Docker*.\n\nSwarm Mode, which is compiled in and delivered by default in `dockerd` and is thus present in most major Moby downstreams, is a simple, built-in container orchestrator that is implemented through a combination of SwarmKit and supporting network code.\n\nThe `overlay` network driver is a core feature of Swarm Mode, providing isolated virtual LANs that allow communication between containers and services across the cluster. This driver is an implementation/user of VXLAN, which encapsulates link-layer (Ethernet) frames in UDP datagrams that tag the frame with the VXLAN metadata, including a VXLAN Network ID (VNI) that identifies the originating overlay network. In addition, the overlay network driver supports an optional, off-by-default encrypted mode, which is especially useful when VXLAN packets traverses an untrusted network between nodes.\n\nEncrypted overlay networks function by encapsulating the VXLAN datagrams through the use of the IPsec Encapsulating Security Payload protocol in Transport mode. By deploying IPSec encapsulation, encrypted overlay networks gain the additional properties of source authentication through cryptographic proof, data integrity through check-summing, and confidentiality through encryption.\n\nWhen setting an endpoint up on an encrypted overlay network, Moby installs three iptables (Linux kernel firewall) rules that enforce both incoming and outgoing IPSec. These rules rely on the `u32` iptables extension provided by the `xt_u32` kernel module to directly filter on a VXLAN packet's VNI field, so that IPSec guarantees can be enforced on encrypted overlay networks without interfering with other overlay networks or other users of VXLAN.\n\nAn iptables rule designates outgoing VXLAN datagrams with a VNI that corresponds to an encrypted overlay network for IPsec encapsulation.\n\nEncrypted overlay networks on affected platforms silently transmit unencrypted data. As a result, `overlay` networks may appear to be functional, passing traffic as expected, but without any of the expected confidentiality or data integrity guarantees.\n\nIt is possible for an attacker sitting in a trusted position on the network to read all of the application traffic that is moving across the overlay network, resulting in unexpected secrets or user data disclosure. Thus, because many database protocols, internal APIs, etc. are not protected by a second layer of encryption, a user may use Swarm encrypted overlay networks to provide confidentiality, which due to this vulnerability this is no longer guaranteed.\n\nPatches are available in Moby releases 23.0.3, and 20.10.24. As Mirantis Container Runtime's 20.10 releases are numbered differently, users of that platform should update to 20.10.16.\n\nSome workarounds are available. Close the VXLAN port (by default, UDP port 4789) to outgoing traffic at the Internet boundary in order to prevent unintentionally leaking unencrypted traffic over the Internet, and/or ensure that the `xt_u32` kernel module is available on all nodes of the Swarm cluster.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-28841", "Vulnerability Categories": "N/A", "Affected Products": "\nMobyproject\u00bbMobyVersions  from including (>=) 23.0.0andbefore (<) 23.0.3cpe:2.3:a:mobyproject:moby:*:*:*:*:*:*:*:*Matching versions\nMobyproject\u00bbMobyVersions  from including (>=) 1.12.0andbefore (<) 20.10.24cpe:2.3:a:mobyproject:moby:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.36% Probability of exploitation activity in the next 30 days\n~ 73 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-10-25  0.32%  0.36%  +0.04 \n 2  2024-09-14  0.28%  0.32%  +0.05 \n 3  2024-07-09  0.25%  0.28%  +0.03 \n 4  2024-05-06  0.24%  0.25%  +0.01 \n 5  2024-04-10  0.21%  0.24%  +0.03 \n 6  2024-03-04  0.17%  0.21%  +0.03 \n 7  2023-09-05  0.13%  0.17%  +0.04 \n 8  2023-05-06  0.09%  0.13%  +0.04 \n 9  2023-04-15  0.04%  0.09%  +0.05 ", "CVSS Scores": "6.8", "CWE": [{"CWE_ID": "CWE-311 Missing Encryption of Sensitive Data", "CWE_link": "/cwe-details/311/Missing-Encryption-of-Sensitive-Data.html"}, {"CWE_ID": "CWE-636 Not Failing Securely ('Failing Open')", "CWE_link": "/cwe-details/636/Not-Failing-Securely-Failing-Open-.html"}, {"CWE_ID": "CWE-755 Improper Handling of Exceptional Conditions", "CWE_link": "/cwe-details/755/Improper-Handling-of-Exceptional-Conditions.html"}], "Reference": [{"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZTE4ITXXPIWZEQ4HYQCB6N6GZIMWXDAI/", "ref_desc": "[SECURITY] Fedora 38 Update: moby-engine-24.0.5-1.fc38 - package-announce - Fedora Mailing-ListsCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/-nKAnb_q49MI-XpxQtKj8uVy1NQ.html"}, {"ref_link": "https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw", "ref_desc": "The Swarm VXLAN port may be exposed to attack due to ambiguous documentation \u00b7 Advisory \u00b7 moby/moby \u00b7 GitHubVendor AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/HwHluqF1R29FwzNcaN-ECE-x2L0.html"}, {"ref_link": "https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p", "ref_desc": "Encrypted overlay network with a single endpoint is unauthenticated \u00b7 Advisory \u00b7 moby/moby \u00b7 GitHubNot ApplicableCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/i-_g-Nzt3ToEh8ZxBVkWg-DH1EY.html"}, {"ref_link": "https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333", "ref_desc": "Security issues in encrypted overlay networks \u00b7 Advisory \u00b7 moby/libnetwork \u00b7 GitHubVendor AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/iogwyecDEtl5V7xByzaJImj0UG8.html"}, {"ref_link": "https://github.com/moby/moby/pull/45118", "ref_desc": "libnetwork: support encrypted overlay networks on systems without xt_u32 kernel module by corhere \u00b7 Pull Request #45118 \u00b7 moby/moby \u00b7 GitHubIssue Tracking;PatchCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/JZwgbPNdzsVaEqR_mwJnmtarklI.html"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XNF4OLYZRQE75EB5TW5N42FSXHBXGWFE/", "ref_desc": "[SECURITY] Fedora 39 Update: moby-engine-24.0.5-1.fc39 - package-announce - Fedora Mailing-ListsCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/O-Zjdl35ylHSIbles1TeS6vAufE.html"}, {"ref_link": "https://github.com/moby/libnetwork/blob/d9fae4c73daf76c3b0f77e14b45b8bf612ba764d/drivers/overlay/encryption.go#L205-L207", "ref_desc": "libnetwork/encryption.go at d9fae4c73daf76c3b0f77e14b45b8bf612ba764d \u00b7 moby/libnetwork \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/LYZOKMMVX4SIEHPJW3SJUQGMO5YZCPHC/", "ref_desc": "[SECURITY] Fedora 37 Update: moby-engine-24.0.5-1.fc37 - package-announce - Fedora Mailing-ListsCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/PIH0G-hQaYGuv59PpClc9M8TGRY.html"}, {"ref_link": "https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp", "ref_desc": "Encrypted overlay network may be unauthenticated \u00b7 Advisory \u00b7 moby/moby \u00b7 GitHubNot ApplicableCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/RxkN6aYgkajO4qDCD-OLBZxaTO8.html"}, {"ref_link": "https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237", "ref_desc": "Encrypted overlay network traffic may be unencrypted \u00b7 Advisory \u00b7 moby/moby \u00b7 GitHubMitigation;Vendor AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/yqRRUsWJVzFvfm-xH2-8b6RPyR0.html"}, {"ref_link": "https://github.com/moby/moby/issues/43382", "ref_desc": "issues with swarm encrypted overlay network and iptables-nft on RHEL 8+ \u00b7 Issue #43382 \u00b7 moby/moby \u00b7 GitHubExploit;Issue Tracking;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/ZbY41XkFrgtWZJuf3VoljzIty2o.html"}]}