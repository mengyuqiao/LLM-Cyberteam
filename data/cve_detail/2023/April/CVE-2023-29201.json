{"CVE Code": "CVE-2023-29201", "Description": "XWiki Commons are technical libraries common to several other top level XWiki projects. The \"restricted\" mode of the HTML cleaner in XWiki, introduced in version 4.2-milestone-1, only escaped `<script>` and `<style>`-tags but neither attributes that can be used to inject scripts nor other dangerous HTML tags like `<iframe>`. As a consequence, any code relying on this \"restricted\" mode for security is vulnerable to JavaScript injection (\"cross-site scripting\"/XSS). When a privileged user with programming rights visits such a comment in XWiki, the malicious JavaScript code is executed in the context of the user session. This allows server-side code execution with programming rights, impacting the confidentiality, integrity and availability of the XWiki instance. This problem has been patched in XWiki 14.6 RC1 with the introduction of a filter with allowed HTML elements and attributes that is enabled in restricted mode. There are no known workarounds apart from upgrading to a version including the fix.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-29201", "Vulnerability Categories": "Cross site scripting (XSS)", "Affected Products": "\nXwiki\u00bbXwikiVersions  from including (>=) 5.0andup to, including, (<=) 14.5cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.44% Probability of exploitation activity in the next 30 days\n~ 75 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-11-20  0.36%  0.44%  +0.08 \n 2  2024-11-05  0.35%  0.36%  +0.01 \n 3  2024-07-20  0.32%  0.35%  +0.04 \n 4  2024-04-21  0.27%  0.32%  +0.05 \n 5  2024-03-15  0.23%  0.27%  +0.04 \n 6  2023-07-31  0.33%  0.23%  -0.10 \n 7  2023-07-08  0.25%  0.33%  +0.08 \n 8  2023-05-08  0.23%  0.25%  +0.01 \n 9  2023-04-26  0.04%  0.23%  +0.19 ", "CVSS Scores": "9.0", "CWE": [{"CWE_ID": "CWE-79 Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "CWE_link": "/cwe-details/79/Improper-Neutralization-of-Input-During-Web-Page-Generation-.html"}], "Reference": [{"ref_link": "https://github.com/xwiki/xwiki-commons/commit/b11eae9d82cb53f32962056b5faa73f3720c6182", "ref_desc": "XCOMMONS-1680: Filter Html attributes in restricted mode based on a w\u2026 \u00b7 xwiki/xwiki-commons@b11eae9 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://jira.xwiki.org/browse/XCOMMONS-2426", "ref_desc": "[XCOMMONS-2426] Provide a component for filtering safe HTML elements and attributes - XWiki.org JIRAExploit;Issue Tracking", "ref_cve_link": "N/A"}, {"ref_link": "https://jira.xwiki.org/browse/XWIKI-9118", "ref_desc": "[XWIKI-9118] XSS in restricted context via html macro - XWiki.org JIRAExploit;Issue Tracking", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/xwiki/xwiki-commons/security/advisories/GHSA-m3jr-cvhj-f35j", "ref_desc": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') in org.xwiki.commons:xwiki-commons-xml \u00b7 Advisory \u00b7 xwiki/xwiki-commons \u00b7 GitHubExploit;Patch;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://jira.xwiki.org/browse/XCOMMONS-1680", "ref_desc": "[XCOMMONS-1680] Filter Html attributes in restricted mode based on a whitelist - XWiki.org JIRAExploit;Issue Tracking", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/xwiki/xwiki-commons/commit/4a185e0594d90cd4916d60aa60bb4333dc5623b2", "ref_desc": "XCOMMONS-2426: Provide a component for filtering safe HTML elements a\u2026 \u00b7 xwiki/xwiki-commons@4a185e0 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}]}