{"CVE Code": "CVE-2023-27488", "Description": "Envoy is an open source edge and service proxy designed for cloud-native applications. Prior to versions 1.26.0, 1.25.3, 1.24.4, 1.23.6, and 1.22.9, escalation of privileges is possible when `failure_mode_allow: true` is configured for `ext_authz` filter. For affected components that are used for logging and/or visibility, requests may not be logged by the receiving service. When Envoy was configured to use ext_authz, ext_proc, tap, ratelimit filters, and grpc access log service and an http header with non-UTF-8 data was received, Envoy would generate an invalid protobuf message and send it to the configured service. The receiving service would typically generate an error when decoding the protobuf message. For ext_authz that was configured with ``failure_mode_allow: true``, the request would have been allowed in this case. For the other services, this could have resulted in other unforeseen errors such as a lack of visibility into requests. As of versions 1.26.0, 1.25.3, 1.24.4, 1.23.6, and 1.22.9, Envoy by default sanitizes the values sent in gRPC service calls to be valid UTF-8, replacing data that is not valid UTF-8 with a `!` character. This behavioral change can be temporarily reverted by setting runtime guard `envoy.reloadable_features.service_sanitize_non_utf8_strings` to false. As a workaround, one may set `failure_mode_allow: false` for `ext_authz`.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-27488", "Vulnerability Categories": "Input validation", "Affected Products": "\nEnvoyproxy\u00bbEnvoyVersions  from including (>=) 1.23.0andbefore (<) 1.23.6cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*Matching versions\nEnvoyproxy\u00bbEnvoyVersions  from including (>=) 1.25.0andbefore (<) 1.25.3cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*Matching versions\nEnvoyproxy\u00bbEnvoyVersions  from including (>=) 1.24.0andbefore (<) 1.24.4cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*Matching versions\nEnvoyproxy\u00bbEnvoyVersions  before (<) 1.22.9cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.28% Probability of exploitation activity in the next 30 days\n~ 69 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-10-25  0.25%  0.28%  +0.03 \n 2  2024-09-14  0.23%  0.25%  +0.02 \n 3  2024-05-06  0.19%  0.23%  +0.04 \n 4  2024-04-10  0.12%  0.19%  +0.07 \n 5  2024-03-04  0.10%  0.12%  +0.02 \n 6  2023-05-06  0.14%  0.10%  -0.04 \n 7  2023-04-12  0.04%  0.14%  +0.10 ", "CVSS Scores": "9.8", "CWE": [{"CWE_ID": "CWE-20 Improper Input Validation", "CWE_link": "/cwe-details/20/Improper-Input-Validation.html"}], "Reference": [{"ref_link": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-9g5w-hqr3-w2ph", "ref_desc": "gRPC client produces invalid protobuf when an HTTP header with non-UTF8 value is received. \u00b7 Advisory \u00b7 envoyproxy/envoy \u00b7 GitHubExploit;Mitigation;Vendor Advisory", "ref_cve_link": "N/A"}]}