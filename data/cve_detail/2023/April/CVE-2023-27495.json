{"CVE Code": "CVE-2023-27495", "Description": "@fastify/csrf-protection is a plugin which helps protect Fastify servers against CSRF attacks. The CSRF protection enforced by the @fastify/csrf-protection library in combination with @fastify/cookie can be bypassed from network and same-site attackers under certain conditions. @fastify/csrf-protection supports an optional userInfo parameter that binds the CSRF token to the user. This parameter has been introduced to prevent cookie-tossing attacks as a fix for CVE-2021-29624. Whenever userInfo parameter is missing, or its value can be predicted for the target user account, network and same-site attackers can 1. fixate a _csrf cookie in the victim's browser, and 2. forge CSRF tokens that are valid for the victim's session. This allows attackers to bypass the CSRF protection mechanism. As a fix, @fastify/csrf-protection starting from version 6.3.0 (and v4.1.0) includes a server-defined secret hmacKey that cryptographically binds the CSRF token to the value of the _csrf cookie and the userInfo parameter, making tokens non-spoofable by attackers. This protection is effective as long as the userInfo parameter is unique for each user. This is patched in versions 6.3.0 and v4.1.0. Users are advised to upgrade. Users unable to upgrade may use a random, non-predictable userInfo parameter for each user as a mitigation.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-27495", "Vulnerability Categories": "Cross-site request forgery (CSRF)", "Affected Products": "\nFastify\u00bbCsrf-protection\u00bbForNode.jsVersions  from including (>=) 5.0.0andbefore (<) 6.3.0cpe:2.3:a:fastify:csrf-protection:*:*:*:*:*:node.js:*:*Matching versions\nFastify\u00bbCsrf-protection\u00bbForNode.jsVersions  before (<) 4.1.0cpe:2.3:a:fastify:csrf-protection:*:*:*:*:*:node.js:*:*Matching versions", "EPSS Score": "0.09% Probability of exploitation activity in the next 30 days\n~ 39 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-11-10  0.09%  0.09%  +0.00 \n 2  2024-09-30  0.08%  0.09%  +0.01 \n 3  2024-04-26  0.05%  0.08%  +0.03 \n 4  2024-03-20  0.06%  0.05%  0.00 \n 5  2023-05-02  0.05%  0.06%  +0.01 ", "CVSS Scores": "6.5", "CWE": [{"CWE_ID": "CWE-352 Cross-Site Request Forgery (CSRF)", "CWE_link": "/cwe-details/352/Cross-Site-Request-Forgery-CSRF-.html"}], "Reference": [{"ref_link": "https://www.cvedetails.com/cve/CVE-2021-29624", "ref_desc": "CVE-2021-29624 : fastify-csrf is an open-source plugin helps developers protect their Fastify server against CSRF attacks. Versions of faThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/fastify/csrf-protection/security/advisories/GHSA-qrgf-9gpc-vrxw", "ref_desc": "Bypass of CSRF protection in the presence of predictable userInfo \u00b7 Advisory \u00b7 fastify/csrf-protection \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/fastify/csrf-protection/commit/be3e5761f37aa05c7c1ac8ed44499c51ecec8058", "ref_desc": "Merge pull request from GHSA-qrgf-9gpc-vrxw \u00b7 fastify/csrf-protection@be3e576 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}]}