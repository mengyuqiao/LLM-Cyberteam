{"CVE Code": "CVE-2023-24536", "Description": "Multipart form parsing can consume large amounts of CPU and memory when processing form inputs containing very large numbers of parts. This stems from several causes: 1. mime/multipart.Reader.ReadForm limits the total memory a parsed multipart form can consume. ReadForm can undercount the amount of memory consumed, leading it to accept larger inputs than intended. 2. Limiting total memory does not account for increased pressure on the garbage collector from large numbers of small allocations in forms with many parts. 3. ReadForm can allocate a large number of short-lived buffers, further increasing pressure on the garbage collector. The combination of these factors can permit an attacker to cause an program that parses multipart forms to consume large amounts of CPU and memory, potentially resulting in a denial of service. This affects programs that use mime/multipart.Reader.ReadForm, as well as form parsing in the net/http package with the Request methods FormFile, FormValue, ParseMultipartForm, and PostFormValue. With fix, ReadForm now does a better job of estimating the memory consumption of parsed forms, and performs many fewer short-lived allocations. In addition, the fixed mime/multipart.Reader imposes the following limits on the size of parsed forms: 1. Forms parsed with ReadForm may contain no more than 1000 parts. This limit may be adjusted with the environment variable GODEBUG=multipartmaxparts=. 2. Form parts parsed with NextPart and NextRawPart may contain no more than 10,000 header fields. In addition, forms parsed with ReadForm may contain no more than 10,000 header fields across all parts. This limit may be adjusted with the environment variable GODEBUG=multipartmaxheaders=.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-24536", "Vulnerability Categories": "Denial of service", "Affected Products": "\nGolang\u00bbGOVersions  before (<) 1.19.8cpe:2.3:a:golang:go:*:*:*:*:*:*:*:*Matching versions\nGolang\u00bbGOVersions  from including (>=) 1.20.0andbefore (<) 1.20.3cpe:2.3:a:golang:go:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.96% Probability of exploitation activity in the next 30 days\n~ 84 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-11-25  0.82%  0.96%  +0.14 \n 2  2024-11-11  0.71%  0.82%  +0.11 \n 3  2024-10-27  0.73%  0.71%  -0.02 \n 4  2024-09-16  0.61%  0.73%  +0.12 \n 5  2024-07-11  0.54%  0.61%  +0.07 \n 6  2024-05-08  0.45%  0.54%  +0.09 \n 7  2024-04-12  0.27%  0.45%  +0.18 \n 8  2023-11-26  0.37%  0.27%  -0.09 \n 9  2023-05-27  0.13%  0.37%  +0.24 \n 10  2023-04-18  0.05%  0.13%  +0.08 ", "CVSS Scores": "7.5", "CWE": [{"CWE_ID": "CWE-400 Uncontrolled Resource Consumption", "CWE_link": "/cwe-details/400/Uncontrolled-Resource-Consumption.html"}, {"CWE_ID": "CWE-770 Allocation of Resources Without Limits or Throttling", "CWE_link": "/cwe-details/770/Allocation-of-Resources-Without-Limits-or-Throttling.html"}], "Reference": [{"ref_link": "https://security.netapp.com/advisory/ntap-20230526-0007/", "ref_desc": "April 2023 Golang Vulnerabilities in NetApp Products | NetApp Product SecurityCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/AEZ2HjUCDVXAfKQwYOWCU1VksCo.html"}, {"ref_link": "https://go.dev/cl/482076", "ref_desc": "net/textproto, mime/multipart: improve accounting of non-file data (482076) \u00b7 Gerrit Code ReviewPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://go.dev/cl/482075", "ref_desc": "mime/multipart: avoid excessive copy buffer allocations in ReadForm (482075) \u00b7 Gerrit Code ReviewPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://pkg.go.dev/vuln/GO-2023-1705", "ref_desc": "GO-2023-1705 - Go PackagesVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://go.dev/cl/482077", "ref_desc": "mime/multipart: limit parsed mime message sizes (482077) \u00b7 Gerrit Code ReviewPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://security.gentoo.org/glsa/202311-09", "ref_desc": "Go: Multiple Vulnerabilities (GLSA 202311-09) \u2014 Gentoo securityCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/p0S2LtT_x1kmcmHYI6CuiiC_cDA.html"}, {"ref_link": "https://groups.google.com/g/golang-announce/c/Xdv6JL9ENs8", "ref_desc": "[security] Go 1.20.3 and Go 1.19.8 are releasedMailing ListCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/RWU9YNPtPKwUYnyTd9WeWl4RVRI.html"}, {"ref_link": "https://go.dev/issue/59153", "ref_desc": "net/http, net/textproto, mime/multipart: denial of service from excessive resource consumption (CVE-2023-24536) \u00b7 Issue #59153 \u00b7 golang/go \u00b7 GitHubIssue Tracking;Patch", "ref_cve_link": "N/A"}]}