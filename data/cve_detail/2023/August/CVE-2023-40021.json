{"CVE Code": "CVE-2023-40021", "Description": "Oppia is an online learning platform. When comparing a received CSRF token against the expected token, Oppia uses the string equality operator (`==`), which is not safe against timing attacks. By repeatedly submitting invalid tokens, an attacker can brute-force the expected CSRF token character by character. Once they have recovered the token, they can then submit a forged request on behalf of a logged-in user and execute privileged actions on that user's behalf. In particular the function to validate received CSRF tokens is at `oppia.core.controllers.base.CsrfTokenManager.is_csrf_token_valid`. An attacker who can lure a logged-in Oppia user to a malicious website can perform any change on Oppia that the user is authorized to do, including changing profile information; creating, deleting, and changing explorations; etc. Note that the attacker cannot change a user's login credentials. An attack would need to complete within 1 second because every second, the time used in computing the token changes. This issue has been addressed in commit `b89bf80837` which has been included in release `3.3.2-hotfix-2`. Users are advised to upgrade. There are no known workarounds for this vulnerability.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-40021", "Vulnerability Categories": "Cross-site request forgery (CSRF)", "Affected Products": "\nOppia\u00bbOppiaVersions  from including (>=) 1.1.0andbefore (<) 3.3.2cpe:2.3:a:oppia:oppia:*:*:*:*:*:*:*:*Matching versions\nOppia\u00bbOppia\u00bbVersion:3.3.2cpe:2.3:a:oppia:oppia:3.3.2:-:*:*:*:*:*:*Matching versions", "EPSS Score": "0.10% Probability of exploitation activity in the next 30 days\n~ 42 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-09-17  0.09%  0.10%  +0.01 \n 2  2024-08-22  0.06%  0.09%  +0.03 \n 3  2024-07-16  0.05%  0.06%  +0.01 \n 4  2023-08-26  0.05%  0.05%  +0.01 ", "CVSS Scores": "5.3", "CWE": [{"CWE_ID": "CWE-203 Observable Discrepancy", "CWE_link": "/cwe-details/203/Observable-Discrepancy.html"}, {"CWE_ID": "CWE-208 Observable Timing Discrepancy", "CWE_link": "/cwe-details/208/Observable-Timing-Discrepancy.html"}], "Reference": [{"ref_link": "https://github.com/oppia/oppia/blob/3a05c3558a292f3db9e658e60e708c266c003fd0/core/controllers/base.py#L964-L990", "ref_desc": "oppia/core/controllers/base.py at 3a05c3558a292f3db9e658e60e708c266c003fd0 \u00b7 oppia/oppia \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/oppia/oppia/commit/b89bf808378c1236874b5797a7bda32c77b4af23", "ref_desc": "Fix GHSA-49jp-pjc3-2532: Strengthen CSRF Protections (#18769) \u00b7 oppia/oppia@b89bf80 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/oppia/oppia/security/advisories/GHSA-49jp-pjc3-2532", "ref_desc": "CVE-2023-40021: Timing Attack Reveals CSRF Tokens \u00b7 Advisory \u00b7 oppia/oppia \u00b7 GitHubExploit;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/oppia/oppia/pull/18769", "ref_desc": "Fix GHSA-49jp-pjc3-2532: Strengthen CSRF Protections by U8NWXD \u00b7 Pull Request #18769 \u00b7 oppia/oppia \u00b7 GitHubPatch", "ref_cve_link": "N/A"}]}