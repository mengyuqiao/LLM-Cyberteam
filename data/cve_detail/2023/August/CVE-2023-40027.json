{"CVE Code": "CVE-2023-40027", "Description": "Keystone is an open source headless CMS for Node.js \u2014 built with GraphQL and React. When `ui.isAccessAllowed` is set as `undefined`, the `adminMeta` GraphQL query is publicly accessible (no session required). This is different to the behaviour of the default AdminUI middleware, which by default will only be publicly accessible (no session required) if a `session` strategy is not defined. This vulnerability does not affect developers using the `@keystone-6/auth` package, or any users that have written their own `ui.isAccessAllowed` (that is to say, `isAccessAllowed` is not `undefined`). This vulnerability does affect users who believed that their `session` strategy will, by default, enforce that `adminMeta` is inaccessible by the public in accordance with that strategy; akin to the behaviour of the AdminUI middleware. This vulnerability has been patched in `@keystone-6/core` version `5.5.1`. Users are advised to upgrade. Users unable to upgrade may opt to write their own `isAccessAllowed` functionality to work-around this vulnerability.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-40027", "Vulnerability Categories": "N/A", "Affected Products": "\nKeystonejs\u00bbKeystone\u00bbForNode.jsVersions  before (<) 5.5.1cpe:2.3:a:keystonejs:keystone:*:*:*:*:*:node.js:*:*Matching versions", "EPSS Score": "0.07% Probability of exploitation activity in the next 30 days\n~ 30 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-09-16  0.06%  0.07%  +0.00 \n 2  2024-08-21  0.06%  0.06%  +0.01 \n 3  2024-07-15  0.05%  0.06%  +0.00 \n 4  2023-08-23  0.05%  0.05%  +0.01 ", "CVSS Scores": "5.3", "CWE": [{"CWE_ID": "CWE-862 Missing Authorization", "CWE_link": "/cwe-details/862/Missing-Authorization.html"}], "Reference": [{"ref_link": "https://github.com/keystonejs/keystone/commit/650e27e6e9b42abfb94c340c8470faf61f0ff284", "ref_desc": "Fix `ui.isAccessAllowed` when `undefined` to prevent access (#8771) \u00b7 keystonejs/keystone@650e27e \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/keystonejs/keystone/pull/8771", "ref_desc": "Fix `ui.isAccessAllowed` when `undefined` to prevent access by dcousens \u00b7 Pull Request #8771 \u00b7 keystonejs/keystone \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/keystonejs/keystone/security/advisories/GHSA-9cvc-v7wm-992c", "ref_desc": "When `ui.isAccessAllowed` is undefined, the admin meta GraphQL query is publicly accessible \u00b7 Advisory \u00b7 keystonejs/keystone \u00b7 GitHubPatch;Vendor Advisory", "ref_cve_link": "N/A"}]}