{"CVE Code": "CVE-2023-39363", "Description": "Vyper is a Pythonic Smart Contract Language for the Ethereum Virtual Machine (EVM). In versions 0.2.15, 0.2.16 and 0.3.0, named re-entrancy locks are allocated incorrectly. Each function using a named re-entrancy lock gets a unique lock regardless of the key, allowing cross-function re-entrancy in contracts compiled with the susceptible versions. A specific set of conditions is required to result in misbehavior of affected contracts, specifically: a `.vy` contract compiled with `vyper` versions `0.2.15`, `0.2.16`, or `0.3.0`; a primary function that utilizes the `@nonreentrant` decorator with a specific `key` and does not strictly follow the check-effects-interaction pattern (i.e. contains an external call to an untrusted party before storage updates); and a secondary function that utilizes the same `key` and would be affected by the improper state caused by the primary function. Version 0.3.1 contains a fix for this issue.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-39363", "Vulnerability Categories": "N/A", "Affected Products": "\nVyperlang\u00bbVyper\u00bbVersion:0.2.15ForPythoncpe:2.3:a:vyperlang:vyper:0.2.15:*:*:*:*:python:*:*Matching versions\nVyperlang\u00bbVyper\u00bbVersion:0.2.16ForPythoncpe:2.3:a:vyperlang:vyper:0.2.16:*:*:*:*:python:*:*Matching versions\nVyperlang\u00bbVyper\u00bbVersion:0.3.0ForPythoncpe:2.3:a:vyperlang:vyper:0.3.0:*:*:*:*:python:*:*Matching versions", "EPSS Score": "0.12% Probability of exploitation activity in the next 30 days\n~ 47 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-11-11  0.11%  0.12%  +0.01 \n 2  2024-09-08  0.13%  0.11%  -0.02 \n 3  2024-08-13  0.06%  0.13%  +0.07 \n 4  2024-07-07  0.05%  0.06%  +0.01 \n 5  2023-08-12  0.05%  0.05%  +0.01 ", "CVSS Scores": "5.9", "CWE": [{"CWE_ID": "CWE-863 Incorrect Authorization", "CWE_link": "/cwe-details/863/Incorrect-Authorization.html"}], "Reference": [{"ref_link": "https://github.com/vyperlang/vyper/security/advisories/GHSA-5824-cm3x-3c38", "ref_desc": "Incorrectly allocated named re-entrancy locks \u00b7 Advisory \u00b7 vyperlang/vyper \u00b7 GitHubExploit;Patch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/vyperlang/vyper/pull/2514", "ref_desc": "fix codegen failure with nonreentrant keys by charles-cooper \u00b7 Pull Request #2514 \u00b7 vyperlang/vyper \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://hackmd.io/@LlamaRisk/BJzSKHNjn", "ref_desc": "Curve Pool Reentrancy Exploit Postmortem July 30th, 2023 - HackMDExploit;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/vyperlang/vyper/pull/2439", "ref_desc": "Fix unused storage slots by charles-cooper \u00b7 Pull Request #2439 \u00b7 vyperlang/vyper \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://hackmd.io/@vyperlang/HJUgNMhs2", "ref_desc": "Vyper Nonreentrancy Lock Vulnerability Technical Post-Mortem Report - HackMDExploit;Third Party Advisory", "ref_cve_link": "N/A"}]}