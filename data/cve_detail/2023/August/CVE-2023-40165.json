{"CVE Code": "CVE-2023-40165", "Description": "rubygems.org is the Ruby community's primary gem (library) hosting service. Insufficient input validation allowed malicious actors to replace any uploaded gem version that had a platform, version number, or gem name matching `/-\\d/`, permanently replacing the legitimate upload in the canonical gem storage bucket, and triggering an immediate CDN purge so that the malicious gem would be served immediately. The maintainers have checked all gems matching the `/-\\d/` pattern and can confirm that no unexpected `.gem`s were found. As a result, we believe this vulnerability was _not_ exploited. The easiest way to ensure that a user's applications were not exploited by this vulnerability is to check that all of your downloaded .gems have a checksum that matches the checksum recorded in the RubyGems.org database. RubyGems contributor Maciej Mensfeld wrote a tool to automatically check that all downloaded .gem files match the checksums recorded in the RubyGems.org database. You can use it by running: `bundle add bundler-integrity` followed by `bundle exec bundler-integrity`. Neither this tool nor anything else can prove you were not exploited, but the can assist your investigation by quickly comparing RubyGems API-provided checksums with the checksums of files on your disk. The issue has been patched with improved input validation and the changes are live. No action is required on the part of the user. Users are advised to validate their local gems.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-40165", "Vulnerability Categories": "Input validation", "Affected Products": "N/A", "EPSS Score": "0.07% Probability of exploitation activity in the next 30 days\n~ 31 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-09-18  0.06%  0.07%  +0.01 \n 2  2024-08-23  0.05%  0.06%  +0.01 \n 3  2024-07-17  0.05%  0.05%  +0.00 \n 4  2023-08-25  0.04%  0.05%  +0.00 ", "CVSS Scores": "7.4", "CWE": [{"CWE_ID": "CWE-20 Improper Input Validation", "CWE_link": "/cwe-details/20/Improper-Input-Validation.html"}], "Reference": [{"ref_link": "https://github.com/rubygems/rubygems.org/commit/7e19c19247ddf5885a915710afc60ec6663d8502", "ref_desc": "Merge pull request from GHSA-rxcq-2m4f-94wm \u00b7 rubygems/rubygems.org@7e19c19 \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/rubygems/rubygems.org/security/advisories/GHSA-rxcq-2m4f-94wm", "ref_desc": "Unauthorized gem replacement for full names ending in numbers \u00b7 Advisory \u00b7 rubygems/rubygems.org \u00b7 GitHub", "ref_cve_link": "N/A"}]}