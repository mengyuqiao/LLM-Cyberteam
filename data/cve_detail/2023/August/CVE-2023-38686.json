{"CVE Code": "CVE-2023-38686", "Description": "Sydent is an identity server for the Matrix communications protocol. Prior to version 2.5.6, if configured to send emails using TLS, Sydent does not verify SMTP servers' certificates. This makes  Sydent's emails vulnerable to interception via a man-in-the-middle (MITM) attack. Attackers with privileged access to the network can intercept room invitations and address confirmation emails. This is patched in Sydent 2.5.6. When patching, make sure that Sydent trusts the certificate of the server it is connecting to. This should happen automatically when using properly issued certificates. Those who use self-signed certificates should make sure to copy their Certification Authority certificate, or their self signed certificate if using only one, to the trust store of your operating system. As a workaround, one can ensure Sydent's emails fail to send by setting the configured SMTP server to a loopback or non-routable address under one's control which does not have a listening SMTP server.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-38686", "Vulnerability Categories": "N/A", "Affected Products": "\nMatrix\u00bbSydentVersions  before (<) 2.5.6cpe:2.3:a:matrix:sydent:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.05% Probability of exploitation activity in the next 30 days\n~ 21 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-08-10  0.06%  0.05%  -0.01 \n 2  2023-08-11  0.04%  0.06%  +0.02 ", "CVSS Scores": "5.3", "CWE": [{"CWE_ID": "CWE-295 Improper Certificate Validation", "CWE_link": "/cwe-details/295/Improper-Certificate-Validation.html"}], "Reference": [{"ref_link": "https://github.com/python/cpython/issues/91826", "ref_desc": "Enable TLS certificate validation by default for SMTP/IMAP/FTP/POP/NNTP protocols \u00b7 Issue #91826 \u00b7 python/cpython \u00b7 GitHubIssue Tracking", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/matrix-org/sydent/pull/574", "ref_desc": "Explicitly create an SSL context when emailing by DMRobertson \u00b7 Pull Request #574 \u00b7 matrix-org/sydent \u00b7 GitHubIssue Tracking;Patch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/matrix-org/sydent/commit/1cd748307c6b168b66154e6c4db715d4b9551261", "ref_desc": "Explicitly create an SSL context when emailing (#574) \u00b7 matrix-org/sydent@1cd7483 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://peps.python.org/pep-0476/", "ref_desc": "PEP 476 \u2013 Enabling certificate verification by default for stdlib http clients | peps.python.orgThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://docs.python.org/3/library/ssl.html?highlight=ssl#security-considerations", "ref_desc": "ssl \u2014 TLS/SSL wrapper for socket objects \u2014 Python 3.11.4 documentationTechnical Description", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/matrix-org/sydent/releases/tag/v2.5.6", "ref_desc": "Release v2.5.6 \u00b7 matrix-org/sydent \u00b7 GitHubRelease Notes", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/matrix-org/sydent/security/advisories/GHSA-p6hw-wm59-3g5g", "ref_desc": "Sydent does not verify email server certificates \u00b7 Advisory \u00b7 matrix-org/sydent \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}]}