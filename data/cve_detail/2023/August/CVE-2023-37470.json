{"CVE Code": "CVE-2023-37470", "Description": "Metabase is an open-source business intelligence and analytics platform. Prior to versions 0.43.7.3, 0.44.7.3, 0.45.4.3, 0.46.6.4, 1.43.7.3, 1.44.7.3, 1.45.4.3, and 1.46.6.4, a vulnerability could potentially allow remote code execution on one's Metabase server. The core issue is that one of the supported data warehouses (an embedded in-memory database H2), exposes a number of ways for a connection string to include code that is then executed by the process running the embedded database. Because Metabase allows users to connect to databases, this means that a user supplied string can be used to inject executable code. Metabase allows users to validate their connection string before adding a database (including on setup), and this validation API was the primary vector used as it can be called without validation. Versions 0.43.7.3, 0.44.7.3, 0.45.4.3, 0.46.6.4, 1.43.7.3, 1.44.7.3, 1.45.4.3, and 1.46.6.4 fix this issue by removing the ability of users to add H2 databases entirely. As a workaround, it is possible to block these vulnerabilities at the network level by blocking the endpoints `POST /api/database`, `PUT /api/database/:id`, and `POST /api/setup/validateuntil`. Those who use H2 as a file-based database should migrate to SQLite.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-37470", "Vulnerability Categories": "Execute code", "Affected Products": "\nMetabase\u00bbMetabase\u00bb     EnterpriseEditionVersions  from including (>=) 1.45.0andbefore (<) 1.45.4.3cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*Matching versions\nMetabase\u00bbMetabase\u00bbVersions  from including (>=) 0.44.0andbefore (<) 0.44.7.3cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*Matching versions\nMetabase\u00bbMetabase\u00bbVersions  from including (>=) 0.46.0andbefore (<) 0.46.6.4cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*Matching versions\nMetabase\u00bbMetabase\u00bb     EnterpriseEditionVersions  before (<) 1.43.7.3cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*Matching versions\nMetabase\u00bbMetabase\u00bbVersions  from including (>=) 0.45.0andbefore (<) 0.45.4.3cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*Matching versions\nMetabase\u00bbMetabase\u00bb     EnterpriseEditionVersions  from including (>=) 1.44.0andbefore (<) 1.44.7.3cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*Matching versions\nMetabase\u00bbMetabase\u00bbVersions  before (<) 0.43.7.3cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*Matching versions\nMetabase\u00bbMetabase\u00bb     EnterpriseEditionVersions  from including (>=) 1.46.0andbefore (<) 1.46.6.4cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*Matching versions", "EPSS Score": "0.57% Probability of exploitation activity in the next 30 days\n~ 78 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-11-08  0.40%  0.57%  +0.17 \n 2  2024-09-05  0.47%  0.40%  -0.07 \n 3  2024-08-10  0.28%  0.47%  +0.19 \n 4  2024-07-04  0.25%  0.28%  +0.04 \n 5  2024-04-24  0.35%  0.25%  -0.10 \n 6  2024-04-15  0.25%  0.35%  +0.10 \n 7  2023-08-10  0.05%  0.25%  +0.20 ", "CVSS Scores": "9.8", "CWE": [{"CWE_ID": "CWE-94 Improper Control of Generation of Code ('Code Injection')", "CWE_link": "/cwe-details/94/Improper-Control-of-Generation-of-Code-Code-Injection-.html"}], "Reference": [{"ref_link": "https://github.com/metabase/metabase/security/advisories/GHSA-p7w3-9m58-rq83", "ref_desc": "Remote code execution via user-supplied H2 connection strings \u00b7 Advisory \u00b7 metabase/metabase \u00b7 GitHubMitigation;Patch;Third Party Advisory", "ref_cve_link": "N/A"}]}