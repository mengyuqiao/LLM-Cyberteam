{"CVE Code": "CVE-2023-34252", "Description": "Grav is a file-based Web platform. Prior to version 1.7.42, there is a logic flaw in the `GravExtension.filterFilter()` function whereby validation against a denylist of unsafe functions is only performed when the argument passed to filter is a string. However, passing an array as a callable argument allows the validation check to be skipped. Consequently, a low privileged attacker with login access to Grav Admin panel and page creation/update permissions is able to inject malicious templates to obtain remote code execution. The vulnerability can be found in the `GravExtension.filterFilter()` function declared in `/system/src/Grav/Common/Twig/Extension/GravExtension.php`. Version 1.7.42 contains a patch for this issue. End users should also ensure that `twig.undefined_functions` and `twig.undefined_filters` properties in `/path/to/webroot/system/config/system.yaml` configuration file are set to `false` to disallow Twig from treating undefined filters/functions as PHP functions and executing them.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-34252", "Vulnerability Categories": "Execute code", "Affected Products": "\nGetgrav\u00bbGravVersions  before (<) 1.7.42cpe:2.3:a:getgrav:grav:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.82% Probability of exploitation activity in the next 30 days\n~ 82 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-07-16  0.74%  0.82%  +0.08 \n 2  2024-06-20  0.32%  0.74%  +0.42 \n 3  2024-06-09  0.24%  0.32%  +0.07 \n 4  2024-05-14  0.20%  0.24%  +0.04 \n 5  2024-02-24  0.29%  0.20%  -0.08 \n 6  2023-12-05  0.25%  0.29%  +0.04 \n 7  2023-07-08  0.22%  0.25%  +0.03 \n 8  2023-06-24  0.06%  0.22%  +0.15 ", "CVSS Scores": "7.2", "CWE": [{"CWE_ID": "CWE-94 Improper Control of Generation of Code ('Code Injection')", "CWE_link": "/cwe-details/94/Improper-Control-of-Generation-of-Code-Code-Injection-.html"}, {"CWE_ID": "CWE-184 Incomplete List of Disallowed Inputs", "CWE_link": "/cwe-details/184/Incomplete-List-of-Disallowed-Inputs.html"}, {"CWE_ID": "CWE-1336 Improper Neutralization of Special Elements Used in a Template Engine", "CWE_link": "/cwe-details/1336/Improper-Neutralization-of-Special-Elements-Used-in-a-Templa.html"}], "Reference": [{"ref_link": "https://github.com/getgrav/grav/commit/244758d4383034fe4cd292d41e477177870b65ec", "ref_desc": "also handle SSTI in reduce twig filter + function \u00b7 getgrav/grav@244758d \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/getgrav/grav/blob/1.7.40/system/src/Grav/Common/Utils.php#L1956-L2074", "ref_desc": "grav/system/src/Grav/Common/Utils.php at 1.7.40 \u00b7 getgrav/grav \u00b7 GitHubIssue Tracking", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/getgrav/grav/security/advisories/GHSA-96xv-rmwj-6p9w", "ref_desc": "Grav Server-side Template Injection (SSTI) via Insufficient Validation in filterFilter \u00b7 Advisory \u00b7 getgrav/grav \u00b7 GitHubExploit;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/getgrav/grav/blob/1.7.40/system/src/Grav/Common/Twig/Extension/GravExtension.php#L1692-L1698", "ref_desc": "grav/system/src/Grav/Common/Twig/Extension/GravExtension.php at 1.7.40 \u00b7 getgrav/grav \u00b7 GitHubIssue Tracking", "ref_cve_link": "N/A"}]}