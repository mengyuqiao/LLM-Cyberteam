{"CVE Code": "CVE-2023-35165", "Description": "AWS Cloud Development Kit (AWS CDK) is an open-source software development framework to define cloud infrastructure in code and provision it through AWS CloudFormation. In the packages `aws-cdk-lib` 2.0.0 until 2.80.0 and `@aws-cdk/aws-eks` 1.57.0 until 1.202.0, `eks.Cluster` and `eks.FargateCluster` constructs create two roles, `CreationRole` and `default MastersRole`, that have an overly permissive trust policy. \n \nThe first, referred to as the `CreationRole`, is used by lambda handlers to create the cluster and deploy Kubernetes resources (e.g `KubernetesManifest`, `HelmChart`, ...) onto it. Users with CDK version higher or equal to 1.62.0 (including v2 users) may be affected.\n \nThe second, referred to as the `default MastersRole`, is provisioned only if the `mastersRole` property isn't provided and has permissions to execute `kubectl` commands on the cluster. Users with CDK version higher or equal to 1.57.0 (including v2 users) may be affected.\n\nThe issue has been fixed in `@aws-cdk/aws-eks` v1.202.0 and `aws-cdk-lib` v2.80.0. These versions no longer use the account root principal. Instead, they restrict the trust policy to the specific roles of lambda handlers that need it. There is no workaround available for CreationRole. To avoid creating the `default MastersRole`, use the `mastersRole` property to explicitly provide a role.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-35165", "Vulnerability Categories": "N/A", "Affected Products": "\nAmazon\u00bbAws Cloud Development KitVersions  from including (>=) 2.0.0andbefore (<) 2.80.0cpe:2.3:a:amazon:aws_cloud_development_kit:*:*:*:*:*:*:*:*Matching versions\nAmazon\u00bbAws Cloud Development KitVersions  from including (>=) 1.57.0andbefore (<) 1.202.0cpe:2.3:a:amazon:aws_cloud_development_kit:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.09% Probability of exploitation activity in the next 30 days\n~ 40 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-06-29  0.05%  0.09%  +0.04 \n 2  2024-05-23  0.05%  0.05%  +0.00 \n 3  2024-04-29  0.05%  0.05%  +0.00 \n 4  2023-07-07  0.04%  0.05%  +0.01 ", "CVSS Scores": "8.8", "CWE": [{"CWE_ID": "CWE-863 Incorrect Authorization", "CWE_link": "/cwe-details/863/Incorrect-Authorization.html"}], "Reference": [{"ref_link": "https://github.com/aws/aws-cdk/security/advisories/GHSA-rx28-r23p-2qc3", "ref_desc": "EKS overly permissive trust policies \u00b7 Advisory \u00b7 aws/aws-cdk \u00b7 GitHubExploit;Mitigation;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/aws/aws-cdk/issues/25674", "ref_desc": "\u203c\ufe0f NOTICE: eks overly permissive trust policies \u00b7 Issue #25674 \u00b7 aws/aws-cdk \u00b7 GitHubIssue Tracking;Mitigation;Third Party Advisory", "ref_cve_link": "N/A"}]}