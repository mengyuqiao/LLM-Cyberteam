{"CVE Code": "CVE-2023-34253", "Description": "Grav is a file-based Web platform. Prior to version 1.7.42, the denylist introduced in commit 9d6a2d to prevent dangerous functions from being executed via injection of malicious templates was insufficient and could be easily subverted in multiple ways -- (1) using unsafe functions that are not banned, (2) using capitalised callable names, and (3) using fully-qualified names for referencing callables. Consequently, a low privileged attacker with login access to Grav Admin panel and page creation/update permissions is able to inject malicious templates to obtain remote code execution. A patch in version 1.7.42 improves the denylist.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-34253", "Vulnerability Categories": "Execute code", "Affected Products": "\nGetgrav\u00bbGravVersions  before (<) 1.7.42cpe:2.3:a:getgrav:grav:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "1.53% Probability of exploitation activity in the next 30 days\n~ 87 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-09-18  1.38%  1.53%  +0.15 \n 2  2024-06-20  0.65%  1.38%  +0.73 \n 3  2024-05-14  0.54%  0.65%  +0.12 \n 4  2023-06-24  0.18%  0.54%  +0.36 ", "CVSS Scores": "7.2", "CWE": [{"CWE_ID": "CWE-94 Improper Control of Generation of Code ('Code Injection')", "CWE_link": "/cwe-details/94/Improper-Control-of-Generation-of-Code-Code-Injection-.html"}, {"CWE_ID": "CWE-184 Incomplete List of Disallowed Inputs", "CWE_link": "/cwe-details/184/Incomplete-List-of-Disallowed-Inputs.html"}, {"CWE_ID": "CWE-1336 Improper Neutralization of Special Elements Used in a Template Engine", "CWE_link": "/cwe-details/1336/Improper-Neutralization-of-Special-Elements-Used-in-a-Templa.html"}], "Reference": [{"ref_link": "https://github.com/getgrav/grav/commit/71bbed12f950de8335006d7f91112263d8504f1b", "ref_desc": "more SSTI fixes in Utils::isDangerousFunction() \u00b7 getgrav/grav@71bbed1 \u00b7 GitHubPatchCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/93jEqeDugwsAZUSUYr3Gj2UKl0M.html"}, {"ref_link": "https://github.com/getgrav/grav/blob/1.7.40/system/src/Grav/Common/Utils.php#L1952-L2190", "ref_desc": "grav/system/src/Grav/Common/Utils.php at 1.7.40 \u00b7 getgrav/grav \u00b7 GitHubIssue Tracking", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/getgrav/grav/security/advisories/GHSA-j3v8-v77f-fvgm", "ref_desc": "Grav Server-side Template Injection (SSTI) via Denylist Bypass Vulnerability \u00b7 Advisory \u00b7 getgrav/grav \u00b7 GitHubExploit;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://huntr.dev/bounties/3ef640e6-9e25-4ecb-8ec1-64311d63fe66/", "ref_desc": "Server Side Template Injection vulnerability found in gravExploit;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/m7LLn0_uYgzSu4f5A7RkPfYOyzA.html"}, {"ref_link": "https://www.github.com/getgrav/grav/commit/9d6a2dba09fd4e56f5cdfb9a399caea355bfeb83", "ref_desc": "Fixed Twig `|filter()` allowing code execution \u00b7 getgrav/grav@9d6a2db \u00b7 GitHubPatchCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/SqHTFo0QxMjEMYjM6rkOxBpNKog.html"}]}