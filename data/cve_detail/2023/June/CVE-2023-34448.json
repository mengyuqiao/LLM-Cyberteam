{"CVE Code": "CVE-2023-34448", "Description": "Grav is a flat-file content management system. Prior to version 1.7.42, the patch for CVE-2022-2073, a server-side template injection vulnerability in Grav leveraging the default `filter()` function, did not block other built-in functions exposed by Twig's Core Extension that could be used to invoke arbitrary unsafe functions, thereby allowing for remote code execution. A patch in version 1.74.2 overrides the built-in Twig `map()` and `reduce()` filter functions in `system/src/Grav/Common/Twig/Extension/GravExtension.php` to validate the argument passed to the filter in `$arrow`.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-34448", "Vulnerability Categories": "Input validation;Execute code", "Affected Products": "\nGetgrav\u00bbGravVersions  before (<) 1.7.42cpe:2.3:a:getgrav:grav:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.86% Probability of exploitation activity in the next 30 days\n~ 83 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-09-18  0.77%  0.86%  +0.09 \n 2  2024-07-16  0.79%  0.77%  -0.02 \n 3  2024-06-20  0.28%  0.79%  +0.51 \n 4  2024-04-20  0.28%  0.28%  +0.01 \n 5  2023-07-24  0.32%  0.28%  -0.04 \n 6  2023-07-17  0.37%  0.32%  -0.05 \n 7  2023-07-08  0.28%  0.37%  +0.09 \n 8  2023-06-23  0.18%  0.28%  +0.10 ", "CVSS Scores": "7.2", "CWE": [{"CWE_ID": "CWE-20 Improper Input Validation", "CWE_link": "/cwe-details/20/Improper-Input-Validation.html"}, {"CWE_ID": "CWE-94 Improper Control of Generation of Code ('Code Injection')", "CWE_link": "/cwe-details/94/Improper-Control-of-Generation-of-Code-Code-Injection-.html"}, {"CWE_ID": "CWE-1336 Improper Neutralization of Special Elements Used in a Template Engine", "CWE_link": "/cwe-details/1336/Improper-Neutralization-of-Special-Elements-Used-in-a-Templa.html"}], "Reference": [{"ref_link": "https://github.com/twigphp/Twig/blob/v1.44.7/src/Environment.php#L148", "ref_desc": "Twig/src/Environment.php at v1.44.7 \u00b7 twigphp/Twig \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/getgrav/grav/commit/8c2c1cb72611a399f13423fc6d0e1d998c03e5c8", "ref_desc": "better SSTI in |map and |filter \u00b7 getgrav/grav@8c2c1cb \u00b7 GitHubPatch;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://huntr.dev/bounties/3ef640e6-9e25-4ecb-8ec1-64311d63fe66/", "ref_desc": "Server Side Template Injection vulnerability found in gravExploit;Patch;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/m7LLn0_uYgzSu4f5A7RkPfYOyzA.html"}, {"ref_link": "https://www.github.com/getgrav/grav/commit/9d6a2dba09fd4e56f5cdfb9a399caea355bfeb83", "ref_desc": "Fixed Twig `|filter()` allowing code execution \u00b7 getgrav/grav@9d6a2db \u00b7 GitHubExploit;Mitigation;Vendor AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/SqHTFo0QxMjEMYjM6rkOxBpNKog.html"}, {"ref_link": "https://github.com/getgrav/grav/security/advisories/GHSA-whr7-m3f8-mpm8", "ref_desc": "Grav Server-side Template Injection (SSTI) via Twig Default Filters \u00b7 Advisory \u00b7 getgrav/grav \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}]}