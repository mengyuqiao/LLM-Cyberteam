{"CVE Code": "CVE-2023-34108", "Description": "mailcow is a mail server suite based on Dovecot, Postfix and other open source software, that provides a modern web UI for user/server administration. A vulnerability has been discovered in mailcow which allows an attacker to manipulate internal Dovecot variables by using specially crafted passwords during the authentication process. The issue arises from the behavior of the `passwd-verify.lua` script, which is responsible for verifying user passwords during login attempts. Upon a successful login, the script returns a response in the format of \"password=<valid-password>\", indicating the successful authentication. By crafting a password with additional key-value pairs appended to it, an attacker can manipulate the returned string and influence the internal behavior of Dovecot. For example, using the password \"123 mail_crypt_save_version=0\" would cause the `passwd-verify.lua` script to return the string \"password=123 mail_crypt_save_version=0\". Consequently, Dovecot will interpret this string and set the internal variables accordingly, leading to unintended consequences. This vulnerability can be exploited by an authenticated attacker who has the ability to set their own password. Successful exploitation of this vulnerability could result in unauthorized access to user accounts, bypassing security controls, or other malicious activities. This issue has been patched in version `2023-05a`. Users are advised to upgrade. There are no known workarounds for this vulnerability.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-34108", "Vulnerability Categories": "Bypass", "Affected Products": "\nMailcow\u00bbMailcow: DockerizedVersions  up to, including, (<=) 2023-05cpe:2.3:a:mailcow:mailcow\\:_dockerized:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.10% Probability of exploitation activity in the next 30 days\n~ 43 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-11-17  0.10%  0.10%  +0.01 \n 2  2024-06-13  0.06%  0.10%  +0.04 \n 3  2024-05-07  0.06%  0.06%  0.00 \n 4  2024-04-13  0.06%  0.06%  +0.01 \n 5  2023-06-16  0.05%  0.06%  +0.00 ", "CVSS Scores": "8.8", "CWE": [{"CWE_ID": "CWE-78 Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')", "CWE_link": "/cwe-details/78/Improper-Neutralization-of-Special-Elements-used-in-an-OS-Co.html"}], "Reference": [{"ref_link": "https://github.com/VladimirBorisov/CVE_proposal/blob/main/MailcowUserPassword.md", "ref_desc": "CVE_proposal/MailcowUserPassword.md at main \u00b7 VladimirBorisov/CVE_proposal \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/mailcow/mailcow-dockerized/commit/f80940efdccd393bf5fccec2886795372a38c445", "ref_desc": "[Dovecot] remove pass return in Dovecot lua auth \u00b7 mailcow/mailcow-dockerized@f80940e \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/mailcow/mailcow-dockerized/security/advisories/GHSA-mhh4-qchc-pv22", "ref_desc": "Manipulation of Internal Dovecot Variables in mailcow via crafted Passwords \u00b7 Advisory \u00b7 mailcow/mailcow-dockerized \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}]}