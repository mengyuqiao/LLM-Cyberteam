{"CVE Code": "CVE-2023-22462", "Description": "Grafana is an open-source platform for monitoring and observability. On 2023-01-01 during an internal audit of Grafana, a member of the security team found a stored XSS vulnerability affecting the core plugin \"Text\". The stored XSS vulnerability requires several user interactions in order to be fully exploited. The vulnerability was possible due to React's render cycle that will pass though the unsanitized HTML code, but in the next cycle the HTML is cleaned up and saved in Grafana's database. An attacker needs to have the Editor role in order to change a Text panel to include JavaScript. Another user needs to edit the same Text panel, and click on \"Markdown\" or \"HTML\" for the code to be executed. This means that vertical privilege escalation is possible, where a user with Editor role can change to a known password for a user having Admin role if the user with Admin role executes malicious JavaScript viewing a dashboard. This issue has been patched in versions 9.2.10 and 9.3.4.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-22462", "Vulnerability Categories": "Cross site scripting (XSS);Gain privilege", "Affected Products": "\nGrafana\u00bbGrafanaVersions  from including (>=) 9.2.0andbefore (<) 9.2.10cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*Matching versions\nGrafana\u00bbGrafanaVersions  from including (>=) 9.3.0andbefore (<) 9.3.4cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.17% Probability of exploitation activity in the next 30 days\n~ 55 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-09-22  0.24%  0.17%  -0.07 \n 2  2024-03-08  0.12%  0.24%  +0.13 \n 3  2024-01-30  0.08%  0.12%  +0.03 \n 4  2023-07-08  0.12%  0.08%  -0.04 \n 5  2023-05-08  0.08%  0.12%  +0.04 \n 6  2023-04-15  0.07%  0.08%  +0.01 \n 7  2023-03-16  0.05%  0.07%  +0.03 \n 8  2023-03-07  0.89%  0.05%  -0.85 ", "CVSS Scores": "5.4", "CWE": [{"CWE_ID": "CWE-79 Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "CWE_link": "/cwe-details/79/Improper-Neutralization-of-Input-During-Web-Page-Generation-.html"}], "Reference": [{"ref_link": "https://github.com/grafana/grafana/commit/db83d5f398caffe35c5846cfa7727d1a2a414165", "ref_desc": "[v9.3.x] Plugins: Fix plugin query help markdown (#60907) \u00b7 grafana/grafana@db83d5f \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://security.netapp.com/advisory/ntap-20230413-0004/", "ref_desc": "CVE-2023-22462 Grafana Vulnerability in NetApp Products | NetApp Product SecurityThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/grafana/grafana/security/advisories/GHSA-7rqg-hjwc-6mjf", "ref_desc": "Stored XSS in Text plugin \u00b7 Advisory \u00b7 grafana/grafana \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://grafana.com/blog/2023/02/28/grafana-security-release-new-versions-with-security-fixes-for-cve-2023-0594-cve-2023-0507-and-cve-2023-22462/", "ref_desc": "Grafana security release: New versions with security fixes for CVE-2023-0594, CVE-2023-0507, and CVE-2023-22462 | Grafana LabsPatch;Vendor Advisory", "ref_cve_link": "N/A"}]}