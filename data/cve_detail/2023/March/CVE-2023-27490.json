{"CVE Code": "CVE-2023-27490", "Description": "NextAuth.js is an open source authentication solution for Next.js applications. `next-auth` applications using OAuth provider versions before `v4.20.1` have been found to be subject to an authentication vulnerability. A bad actor who can read traffic on the victim's network or who is able to social engineer the victim to click a manipulated login link could intercept and tamper with the authorization URL to **log in as the victim**, bypassing the CSRF protection. This is due to a partial failure during a compromised OAuth session where a session code is erroneously generated. This issue has been addressed in version 4.20.1. Users are advised to upgrade. Users unable to upgrade may using Advanced Initialization, manually check the callback request for state, pkce, and nonce against the provider configuration to prevent this issue. See the linked GHSA for details.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-27490", "Vulnerability Categories": "Cross-site request forgery (CSRF)", "Affected Products": "\nNextauth.js\u00bbNext-auth\u00bbForNode.jsVersions  before (<) 4.20.1cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*Matching versions", "EPSS Score": "0.39% Probability of exploitation activity in the next 30 days\n~ 74 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-10-14  0.32%  0.39%  +0.08 \n 2  2024-09-29  0.29%  0.32%  +0.03 \n 3  2024-07-10  0.20%  0.29%  +0.08 \n 4  2024-06-13  0.17%  0.20%  +0.03 \n 5  2024-04-10  0.14%  0.17%  +0.03 \n 6  2024-03-15  0.11%  0.14%  +0.03 \n 7  2024-02-07  0.08%  0.11%  +0.03 \n 8  2023-04-20  0.07%  0.08%  +0.01 \n 9  2023-03-17  0.05%  0.07%  +0.02 ", "CVSS Scores": "8.8", "CWE": [{"CWE_ID": "CWE-352 Cross-Site Request Forgery (CSRF)", "CWE_link": "/cwe-details/352/Cross-Site-Request-Forgery-CSRF-.html"}, {"CWE_ID": "CWE-384 Session Fixation", "CWE_link": "/cwe-details/384/Session-Fixation.html"}], "Reference": [{"ref_link": "https://danielfett.de/2020/05/16/pkce-vs-nonce-equivalent-or-not/", "ref_desc": "PKCE vs. Nonce: Equivalent or Not? - danielfett.deNot Applicable", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/nextauthjs/next-auth/security/advisories/GHSA-7r7x-4c4q-c4qf", "ref_desc": "Missing proper state, nonce and PKCE checks for OAuth authentication \u00b7 Advisory \u00b7 nextauthjs/next-auth \u00b7 GitHubExploit;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://next-auth.js.org/configuration/initialization#advanced-initialization", "ref_desc": "Initialization | NextAuth.jsProductCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/7sj56KZ6sNRCDWaPqss-m-HzKDA.html"}, {"ref_link": "https://www.rfc-editor.org/rfc/rfc6749#section-10.12", "ref_desc": "RFC 6749: The OAuth 2.0 Authorization FrameworkNot Applicable", "ref_cve_link": "N/A"}, {"ref_link": "https://security.netapp.com/advisory/ntap-20230420-0006/", "ref_desc": "CVE-2023-27490 Node.js Vulnerability in NetApp Products | NetApp Product Security", "ref_cve_link": "N/A"}, {"ref_link": "https://authjs.dev/reference/core/providers#checks", "ref_desc": "providers | Auth.jsProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://next-auth.js.org/configuration/providers/oauth", "ref_desc": "OAuth | NextAuth.jsProduct", "ref_cve_link": "N/A"}]}