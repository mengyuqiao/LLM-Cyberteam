{"CVE Code": "CVE-2023-28431", "Description": "Frontier is an Ethereum compatibility layer for Substrate. Frontier's `modexp` precompile uses `num-bigint` crate under the hood. In the implementation prior to pull request 1017, the cases for modulus being even and modulus being odd are treated separately. Odd modulus uses the fast Montgomery multiplication, and even modulus uses the slow plain power algorithm. This gas cost discrepancy was not accounted for in the `modexp` precompile, leading to possible denial of service attacks. No fixes for `num-bigint` are currently available, and thus this issue is fixed in the short term by raising the gas costs for even modulus, and in the long term fixing it in `num-bigint` or switching to another modexp implementation. The short-term fix for Frontier is deployed at pull request 1017. There are no known workarounds aside from applying the fix.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2023-28431", "Vulnerability Categories": "Denial of service", "Affected Products": "\nParity\u00bbFrontierVersions  before (<) 2023-03-15cpe:2.3:a:parity:frontier:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.22% Probability of exploitation activity in the next 30 days\n~ 60 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-11-10  0.15%  0.22%  +0.06 \n 2  2024-10-27  0.13%  0.15%  +0.02 \n 3  2024-10-12  0.14%  0.13%  0.00 \n 4  2024-09-01  0.12%  0.14%  +0.01 \n 5  2024-04-23  0.10%  0.12%  +0.02 \n 6  2024-03-28  0.07%  0.10%  +0.03 \n 7  2024-02-20  0.06%  0.07%  +0.01 \n 8  2023-03-29  0.05%  0.06%  +0.01 ", "CVSS Scores": "7.5", "CWE": [{"CWE_ID": "CWE-682 Incorrect Calculation", "CWE_link": "/cwe-details/682/Incorrect-Calculation.html"}], "Reference": [{"ref_link": "https://github.com/paritytech/frontier/commit/5af12e94d7dfc8a0208a290643a800f55de7b219", "ref_desc": "Increase modexp gas cost when mod is even (#1017) \u00b7 paritytech/frontier@5af12e9 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/rust-num/num-bigint/blob/6f2b8e0fc218dbd0f49bebb8db2d1a771fe6bafa/src/biguint/power.rs#L134", "ref_desc": "num-bigint/power.rs at 6f2b8e0fc218dbd0f49bebb8db2d1a771fe6bafa \u00b7 rust-num/num-bigint \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/paritytech/frontier/security/advisories/GHSA-fcmm-54jp-7vf6", "ref_desc": "modexp precompile is slow for even modulus \u00b7 Advisory \u00b7 paritytech/frontier \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/paritytech/frontier/pull/1017", "ref_desc": "Increase modexp gas cost when mod is even by sorpaas \u00b7 Pull Request #1017 \u00b7 paritytech/frontier \u00b7 GitHubPatch", "ref_cve_link": "N/A"}]}