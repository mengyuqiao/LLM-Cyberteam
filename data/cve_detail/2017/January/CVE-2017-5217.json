{"CVE Code": "CVE-2017-5217", "Description": "Installing a zero-permission Android application on certain Samsung Android devices with KK(4.4), L(5.0/5.1), and M(6.0) software can continually crash the system_server process in the Android OS. The zero-permission app will create an active install session for a separate app that it has embedded within it. The active install session of the embedded app is performed using the android.content.pm.PackageInstaller class and its nested classes in the Android API. The active install session will write the embedded APK file to the /data/app directory, but the app will not be installed since third-party applications cannot programmatically install apps. Samsung has modified AOSP in order to accelerate the parsing of APKs by introducing the com.android.server.pm.PackagePrefetcher class and its nested classes. These classes will parse the APKs present in the /data/app directory and other directories, even if the app is not actually installed. The embedded APK that was written to the /data/app directory via the active install session has a very large but valid AndroidManifest.xml file. Specifically, the AndroidManifest.xml file contains a very large string value for the name of a permission-tree that it declares. When system_server tries to parse the APK file of the embedded app from the active install session, it will crash due to an uncaught error (i.e., java.lang.OutOfMemoryError) or an uncaught exception (i.e., std::bad_alloc) because of memory constraints. The Samsung Android device will encounter a soft reboot due to a system_server crash, and this action will keep repeating since parsing the APKs in the /data/app directory as performed by the system_server process is part of the normal boot process. The Samsung ID is SVE-2016-6917.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2017-5217", "Vulnerability Categories": "Overflow;Input validation", "Affected Products": "\nSamsung\u00bbSamsung Mobile\u00bbVersion:5.0cpe:2.3:o:samsung:samsung_mobile:5.0:*:*:*:*:*:*:*Matching versions\nSamsung\u00bbSamsung Mobile\u00bbVersion:6.0cpe:2.3:o:samsung:samsung_mobile:6.0:*:*:*:*:*:*:*Matching versions\nSamsung\u00bbSamsung Mobile\u00bbVersion:5.1cpe:2.3:o:samsung:samsung_mobile:5.1:*:*:*:*:*:*:*Matching versions\nSamsung\u00bbSamsung Mobile\u00bbVersion:4.4cpe:2.3:o:samsung:samsung_mobile:4.4:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.06% Probability of exploitation activity in the next 30 days\n~ 21 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2023-03-07  0.89%  0.06%  -0.83 ", "CVSS Scores": "7.1", "CWE": [{"CWE_ID": "CWE-20 Improper Input Validation", "CWE_link": "/cwe-details/20/Improper-Input-Validation.html"}, {"CWE_ID": "CWE-119 Improper Restriction of Operations within the Bounds of a Memory Buffer", "CWE_link": "/cwe-details/119/Improper-Restriction-of-Operations-within-the-Bounds-of-a-Me.html"}], "Reference": [{"ref_link": "http://www.securityfocus.com/bid/95319", "ref_desc": "Multiple Samsung Android Mobile Phones CVE-2017-5217 Denial of Service Vulnerability", "ref_cve_link": "N/A"}, {"ref_link": "http://security.samsungmobile.com/smrupdate.html#SMR-JAN-2017", "ref_desc": "Error Message | SAMSUNG Mobile SecurityVendor AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/o-uIID1Yv6TyO2Y3n5zIlOsWlUc.html"}]}