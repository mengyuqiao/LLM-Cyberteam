{"CVE Code": "CVE-2017-7692", "Description": "SquirrelMail 1.4.22 (and other versions before 20170427_0200-SVN) allows post-authentication remote code execution via a sendmail.cf file that is mishandled in a popen call. It's possible to exploit this vulnerability to execute arbitrary shell commands on the remote server. The problem is in the Deliver_SendMail.class.php with the initStream function that uses escapeshellcmd() to sanitize the sendmail command before executing it. The use of escapeshellcmd() is not correct in this case since it doesn't escape whitespaces, allowing the injection of arbitrary command parameters. The problem is in -f$envelopefrom within the sendmail command line. Hence, if the target server uses sendmail and SquirrelMail is configured to use it as a command-line program, it's possible to trick sendmail into using an attacker-provided configuration file that triggers the execution of an arbitrary command. For exploitation, the attacker must upload a sendmail.cf file as an email attachment, and inject the sendmail.cf filename with the -C option within the \"Options > Personal Informations > Email Address\" setting.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2017-7692", "Vulnerability Categories": "Input validation;Execute code", "Affected Products": "\nSquirrelmail\u00bbSquirrelmail\u00bbVersion:1.4.22cpe:2.3:a:squirrelmail:squirrelmail:1.4.22:*:*:*:*:*:*:*Matching versions", "EPSS Score": "6.23% Probability of exploitation activity in the next 30 days\n~ 94 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  7.27%  6.23%  -1.03 \n 2  2024-06-12  7.46%  7.27%  -0.19 \n 3  2023-03-31  6.97%  7.46%  +0.49 \n 4  2023-03-07  20.23%  6.97%  -13.26 ", "CVSS Scores": "9.0", "CWE": [{"CWE_ID": "CWE-20 Improper Input Validation", "CWE_link": "/cwe-details/20/Improper-Input-Validation.html"}], "Reference": [{"ref_link": "http://openwall.com/lists/oss-security/2017/04/19/6", "ref_desc": "oss-security - CVE-2017-7692: Squirrelmail 1.4.22 Remote Code ExecutionMailing List;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://www.exploit-db.com/exploits/41910/", "ref_desc": "SquirrelMail < 1.4.22 - Remote Code Execution", "ref_cve_link": "N/A"}, {"ref_link": "http://www.debian.org/security/2017/dsa-3852", "ref_desc": "Debian -- Security Information -- DSA-3852-1 squirrelmail", "ref_cve_link": "N/A"}, {"ref_link": "http://www.securityfocus.com/bid/98067", "ref_desc": "Squirrelmail CVE-2017-7692 Command Injection Vulnerability", "ref_cve_link": "N/A"}, {"ref_link": "https://legalhackers.com/advisories/SquirrelMail-Exploit-Remote-Code-Exec-CVE-2017-7692-Vuln.html", "ref_desc": "SquirrelMail-Exploit-Remote-Code-Exec-CVE-2017-7692-VulnExploit;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "http://openwall.com/lists/oss-security/2017/04/27/1", "ref_desc": "oss-security - Re: SquirrelMail <= 1.4.23 Remote Code Execution (CVE-2017-7692)", "ref_cve_link": "N/A"}, {"ref_link": "https://security.gentoo.org/glsa/201709-13", "ref_desc": "SquirrelMail: Remote Code Execution (GLSA 201709-13) \u2014 Gentoo security", "ref_cve_link": "N/A"}, {"ref_link": "http://www.securitytracker.com/id/1038312", "ref_desc": "SquirrelMail Input Validation Flaw in 'Deliver_SendMail.class.php' Lets Remote Authenticated Users Execute Arbitrary Commands on the Target System - SecurityTracker", "ref_cve_link": "N/A"}]}