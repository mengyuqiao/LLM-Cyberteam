{"CVE Code": "CVE-2017-1000112", "Description": "Linux kernel: Exploitable memory corruption due to UFO to non-UFO path switch. When building a UFO packet with MSG_MORE __ip_append_data() calls ip_ufo_append_data() to append. However in between two send() calls, the append path can be switched from UFO to non-UFO one, which leads to a memory corruption. In case UFO packet lengths exceeds MTU, copy = maxfraglen - skb->len becomes negative on the non-UFO path and the branch to allocate new skb is taken. This triggers fragmentation and computation of fraggap = skb_prev->len - maxfraglen. Fraggap can exceed MTU, causing copy = datalen - transhdrlen - fraggap to become negative. Subsequently skb_copy_and_csum_bits() writes out-of-bounds. A similar issue is present in IPv6 code. The bug was introduced in e89e9cf539a2 (\"[IPv4/IPv6]: UFO Scatter-gather approach\") on Oct 18 2005.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2017-1000112", "Vulnerability Categories": "Memory Corruption", "Affected Products": "\nLinux\u00bbLinux KernelVersions  from including (>=) 3.17andbefore (<) 3.18.65cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*Matching versions\nLinux\u00bbLinux KernelVersions  from including (>=) 3.11andbefore (<) 3.16.47cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*Matching versions\nLinux\u00bbLinux KernelVersions  from including (>=) 4.10andbefore (<) 4.12.7cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*Matching versions\nLinux\u00bbLinux KernelVersions  from including (>=) 3.19andbefore (<) 4.4.82cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*Matching versions\nLinux\u00bbLinux KernelVersions  from including (>=) 2.6.15andbefore (<) 3.10.108cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*Matching versions\nLinux\u00bbLinux KernelVersions  from including (>=) 4.5andbefore (<) 4.9.43cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.13% Probability of exploitation activity in the next 30 days\n~ 48 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.09%  0.13%  +0.04 \n 2  2023-04-29  0.10%  0.09%  -0.01 \n 3  2023-04-05  0.09%  0.10%  +0.01 \n 4  2023-03-07  15.85%  0.09%  -15.77 ", "CVSS Scores": "6.9", "CWE": [{"CWE_ID": "CWE-362 Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')", "CWE_link": "/cwe-details/362/Concurrent-Execution-using-Shared-Resource-with-Improper-Syn.html"}], "Reference": [{"ref_link": "http://www.debian.org/security/2017/dsa-3981", "ref_desc": "Debian -- Security Information -- DSA-3981-1 linuxThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/0bT7hlf91BtrXETBxsEIRXKrmeM.html"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2017:2930", "ref_desc": "RHSA-2017:2930 - Security Advisory - Red Hat Customer PortalThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/6jR2nu4_rJvPO6s942BUDtsSfQ0.html"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2019:1931", "ref_desc": "RHSA-2019:1931 - Security Advisory - Red Hat Customer PortalThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2017:2918", "ref_desc": "RHSA-2017:2918 - Security Advisory - Red Hat Customer PortalThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/EtAYisIwx4I_l5Q0A5l5MNk3cTc.html"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2017:2931", "ref_desc": "RHSA-2017:2931 - Security Advisory - Red Hat Customer PortalThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/MIFfRpuTjR57f_0YLtCYGQVYi0Y.html"}, {"ref_link": "http://www.securityfocus.com/bid/100262", "ref_desc": "Linux Kernel CVE-2017-1000112 Local Memory Corruption VulnerabilityThird Party Advisory;VDB Entry", "ref_cve_link": "N/A"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2017:3200", "ref_desc": "RHSA-2017:3200 - Security Advisory - Red Hat Customer PortalThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/rXNzDjzfODtIRoev2wHNRL_YhNc.html"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2019:4159", "ref_desc": "RHSA-2019:4159 - Security Advisory - Red Hat Customer PortalThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/vhBkgQyy6KD4-IssX999YNLe6GQ.html"}, {"ref_link": "https://github.com/xairy/kernel-exploits/tree/master/CVE-2017-1000112", "ref_desc": "kernel-exploits/CVE-2017-1000112 at master \u00b7 xairy/kernel-exploits \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "http://www.securitytracker.com/id/1039162", "ref_desc": "Linux Kernel UDP Fragmentation Offload Race Condition Lets Local Users Gain Elevated Privileges - SecurityTrackerThird Party Advisory;VDB Entry", "ref_cve_link": "N/A"}, {"ref_link": "https://www.exploit-db.com/exploits/45147/", "ref_desc": "Linux Kernel - UDP Fragmentation Offset 'UFO' Privilege Escalation (Metasploit)Third Party Advisory;VDB Entry", "ref_cve_link": "N/A"}, {"ref_link": "http://seclists.org/oss-sec/2017/q3/277", "ref_desc": "oss-sec: Linux kernel: CVE-2017-1000112: Exploitable memory corruption due to UFO to non-UFO path switchMailing List;Patch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2019:1932", "ref_desc": "RHSA-2019:1932 - Security Advisory - Red Hat Customer PortalThird Party Advisory", "ref_cve_link": "N/A"}]}