{"CVE Code": "CVE-2017-12629", "Description": "Remote code execution occurs in Apache Solr before 7.1 with Apache Lucene before 7.1 by exploiting XXE in conjunction with use of a Config API add-listener command to reach the RunExecutableListener class. Elasticsearch, although it uses Lucene, is NOT vulnerable to this. Note that the XML external entity expansion vulnerability occurs in the XML Query Parser which is available, by default, for any query request with parameters deftype=xmlparser and can be exploited to upload malicious data to the /upload request handler or as Blind XXE using ftp wrapper in order to read arbitrary local files from the Solr server. Note also that the second vulnerability relates to remote code execution using the RunExecutableListener available on all affected versions of Solr.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2017-12629", "Vulnerability Categories": "XML external entity (XXE) injection;Execute code", "Affected Products": "\nDebian\u00bbDebian Linux\u00bbVersion:7.0cpe:2.3:o:debian:debian_linux:7.0:*:*:*:*:*:*:*Matching versions\nDebian\u00bbDebian Linux\u00bbVersion:8.0cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*Matching versions\nDebian\u00bbDebian Linux\u00bbVersion:9.0cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*Matching versions\nRedhat\u00bbJboss Enterprise Application Platform\u00bbVersion:7.0.0cpe:2.3:a:redhat:jboss_enterprise_application_platform:7.0.0:*:*:*:*:*:*:*Matching versionsWhen used together with:Redhat\u00bbEnterprise Linux Server\u00bbVersion:6.0When used together with:Redhat\u00bbEnterprise Linux Server\u00bbVersion:7.0\nRedhat\u00bbJboss Enterprise Application Platform\u00bbVersion:7.1.0cpe:2.3:a:redhat:jboss_enterprise_application_platform:7.1.0:*:*:*:*:*:*:*Matching versionsWhen used together with:Redhat\u00bbEnterprise Linux Server\u00bbVersion:6.0When used together with:Redhat\u00bbEnterprise Linux Server\u00bbVersion:7.0\nApache\u00bbSolrVersions  from including (>=) 5.5.0andup to, including, (<=) 5.5.4cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*Matching versions\nApache\u00bbSolrVersions  from including (>=) 7.0.0andup to, including, (<=) 7.0.1cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*Matching versions\nApache\u00bbSolrVersions  from including (>=) 6.0.0andup to, including, (<=) 6.6.1cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*Matching versions\nCanonical\u00bbUbuntu Linux\u00bbVersion:16.04    LTSEditioncpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*Matching versions", "EPSS Score": "97.08% Probability of exploitation activity in the next 30 days\n~ 100 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  97.41%  97.08%  -0.32 \n 2  2024-10-26  97.43%  97.41%  -0.02 \n 3  2024-04-09  97.42%  97.43%  +0.01 \n 4  2024-02-29  97.42%  97.42%  -0.01 \n 5  2024-01-18  97.44%  97.42%  -0.02 \n 6  2023-12-10  97.44%  97.44%  0.00 \n 7  2023-10-30  97.42%  97.44%  +0.02 \n 8  2023-09-24  97.45%  97.42%  -0.03 \n 9  2023-08-24  97.49%  97.45%  -0.04 \n 10  2023-05-08  97.45%  97.49%  +0.04 \n 11  2023-03-28  97.48%  97.45%  -0.03 \n 12  2023-03-07  93.08%  97.48%  +4.41 ", "CVSS Scores": "7.5", "CWE": [{"CWE_ID": "CWE-611 Improper Restriction of XML External Entity Reference", "CWE_link": "/cwe-details/611/Improper-Restriction-of-XML-External-Entity-Reference.html"}], "Reference": [{"ref_link": "https://lists.apache.org/thread.html/r3da74965aba2b5f5744b7289ad447306eeb2940c872801819faa9314@%3Cusers.solr.apache.org%3E", "ref_desc": "Re: CVE-2021-27905 Apache Solr ReplicationHandler/SSRF vulnerability - Pony MailMailing List;Vendor AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/AHEDXRBEuiayPbRMDKsP3QjpRso.html"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2017:3124", "ref_desc": "RHSA-2017:3124 - Security Advisory - Red Hat Customer PortalThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.apache.org/thread.html/r140128dc6bb4f4e0b6a39e962c7ca25a8cbc8e48ed766176c931fccc@%3Cusers.solr.apache.org%3E", "ref_desc": "Re: CVE-2021-27905 Apache Solr ReplicationHandler/SSRF vulnerability - Pony MailMailing List;Vendor AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/bPONlgJ_yaEVc8VGYHy67ykSueM.html"}, {"ref_link": "https://lists.debian.org/debian-lts-announce/2018/01/msg00028.html", "ref_desc": "[SECURITY] [DLA 1254-1] lucene-solr security updateMailing List;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2017:3123", "ref_desc": "RHSA-2017:3123 - Security Advisory - Red Hat Customer PortalThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "http://www.securityfocus.com/bid/101261", "ref_desc": "Apache Solr/Lucene CVE-2017-12629 Information Disclosure and Remote Code Execution VulnerabilitiesThird Party Advisory;VDB Entry", "ref_cve_link": "N/A"}, {"ref_link": "https://www.debian.org/security/2018/dsa-4124", "ref_desc": "Debian -- Security Information -- DSA-4124-1 lucene-solrThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/cyISh8MkuQiQluj1xf3x85ZjvyI.html"}, {"ref_link": "http://openwall.com/lists/oss-security/2017/10/13/1", "ref_desc": "oss-security - CVE-2017-12629 Solr: Code execution via entity expansionMailing List;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2018:0004", "ref_desc": "RHSA-2018:0004 - Security Advisory - Red Hat Customer PortalThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/DOs7zayoE7sEXbCmYDdfcwtcCmk.html"}, {"ref_link": "https://lists.apache.org/thread.html/r95df34bb158375948da82b4dfe9a1b5d528572d586584162f8f5aeef@%3Cusers.solr.apache.org%3E", "ref_desc": "CVE-2021-27905 Apache Solr ReplicationHandler/SSRF vulnerability - Pony MailMailing List;Vendor AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/e2aEZXBjIcP5PSYAd0dGkLYZeYY.html"}, {"ref_link": "https://usn.ubuntu.com/4259-1/", "ref_desc": "USN-4259-1: Apache Solr vulnerability | Ubuntu security notices | UbuntuThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://twitter.com/searchtools_avi/status/918904813613543424", "ref_desc": "SearchTools_Avi on Twitter: \"Lucidworks Fusion does not use the Solr\u2019s Config API, to avoid the vulnerability, add the startup flag -Ddisable.configEdit=true\"Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "http://mail-archives.us.apache.org/mod_mbox/www-announce/201710.mbox/%3CCAOOKt51UO_6Vy%3Dj8W%3Dx1pMbLW9VJfZyFWz7pAnXJC_OAdSZubA%40mail.gmail.com%3E", "ref_desc": "[ANNOUNCE] [SECURITY] CVE-2017-12629: Several critical vulnerabilities discovered in Apache Solr (XXE & RCE)Mailing List;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2017:3451", "ref_desc": "RHSA-2017:3451 - Security Advisory - Red Hat Customer PortalThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2017:3244", "ref_desc": "RHSA-2017:3244 - Security Advisory - Red Hat Customer PortalThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/gIuc0BwdXhgZk8uexzcscYv1K2g.html"}, {"ref_link": "https://lists.apache.org/thread.html/r26c996b068ef6c5e89aa59acb769025cfd343a08e63fbe9e7f3f720f@%3Coak-issues.jackrabbit.apache.org%3E", "ref_desc": "[jira] [Created] (OAK-9537) Security vulnerability in org/apache/lucene/queryparser/xml/CoreParser.java - Pony MailMailing List;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2018:0003", "ref_desc": "RHSA-2018:0003 - Security Advisory - Red Hat Customer PortalThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/HdWeZdnlYWdk7Oxg6xO86IHXHUY.html"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2017:3452", "ref_desc": "RHSA-2017:3452 - Security Advisory - Red Hat Customer PortalThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://www.exploit-db.com/exploits/43009/", "ref_desc": "Apache Solr 7.0.1 - XML External Entity Expansion / Remote Code ExecutionExploit;Third Party Advisory;VDB Entry", "ref_cve_link": "N/A"}, {"ref_link": "https://s.apache.org/FJDl", "ref_desc": "Re: Several critical vulnerabilities discovered in Apache Solr (XXE & RCE)Exploit;Mailing List;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://twitter.com/ApacheSolr/status/918731485611401216", "ref_desc": "Apache Solr on Twitter: \"Please secure your #Solr servers since a zero-day exploit has been reported on a public mailing list -- see https://t.co/mFDvxrdm0T\"Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2018:0005", "ref_desc": "RHSA-2018:0005 - Security Advisory - Red Hat Customer PortalThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/pKn1L_3bothS-DUgLxILF0TK4Lc.html"}, {"ref_link": "https://access.redhat.com/errata/RHSA-2018:0002", "ref_desc": "RHSA-2018:0002 - Security Advisory - Red Hat Customer PortalThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/Rpk9UEcF30dsLMpiCGv1ZVo1R4Q.html"}, {"ref_link": "https://twitter.com/joshbressers/status/919258716297420802", "ref_desc": "Josh Bressers on Twitter: \"I've had a number of people ask me about CVE-2017-12629. The lucene XXE issue doesn't affect Elasticsearch. https://t.co/9F1wsrtt6Q\"Third Party Advisory", "ref_cve_link": "N/A"}]}