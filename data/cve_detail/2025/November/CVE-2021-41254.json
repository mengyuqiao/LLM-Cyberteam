{"CVE Code": "CVE-2021-41254", "Description": "kustomize-controller is a Kubernetes operator, specialized in running continuous delivery pipelines for infrastructure and workloads defined with Kubernetes manifests and assembled with Kustomize. Users that can create Kubernetes Secrets, Service Accounts and Flux Kustomization objects, could execute commands inside the kustomize-controller container by embedding a shell script in a Kubernetes Secret. This can be used to run `kubectl` commands under the Service Account of kustomize-controller, thus allowing an authenticated Kubernetes user to gain cluster admin privileges. In affected versions multitenant environments where non-admin users have permissions to create Flux Kustomization objects are affected by this issue. This vulnerability was fixed in kustomize-controller v0.15.0 (included in flux2 v0.18.0) released on 2021-10-08. Starting with v0.15, the kustomize-controller no longer executes shell commands on the container OS and the `kubectl` binary has been removed from the container image. To prevent the creation of Kubernetes Service Accounts with `secrets` in namespaces owned by tenants, a Kubernetes validation webhook such as Gatekeeper OPA or Kyverno can be used.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-41254", "Vulnerability Categories": "N/A", "Affected Products": "\nFluxcd\u00bbKustomize-controllerVersions  before (<) 0.15.0cpe:2.3:a:fluxcd:kustomize-controller:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.65% Probability of exploitation activity in the next 30 days\n~ 70 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2025-05-08  0.68%  0.65%  -0.03 \n 2  2025-03-30  1.41%  0.68%  -0.73 \n 3  2025-03-29  0.68%  1.41%  +0.73 \n 4  2025-03-17  1.66%  0.68%  -0.98 \n 5  2025-01-29  1.18%  1.66%  +0.48 \n 6  2024-12-17  0.64%  1.18%  +0.53 \n 7  2024-11-29  0.45%  0.64%  +0.19 \n 8  2024-10-31  0.32%  0.45%  +0.13 \n 9  2024-10-04  0.31%  0.32%  +0.01 \n 10  2024-04-13  0.22%  0.31%  +0.09 \n 11  2023-07-18  0.22%  0.22%  +0.00 \n 12  2023-06-20  0.21%  0.22%  +0.01 \n 13  2023-06-05  0.11%  0.21%  +0.10 \n 14  2023-04-25  0.11%  0.11%  0.00 \n 15  2023-03-07  0.89%  0.11%  -0.77 ", "CVSS Scores": "9.0", "CWE": [{"CWE_ID": "CWE-78 Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')", "CWE_link": "/cwe-details/78/Improper-Neutralization-of-Special-Elements-used-in-an-OS-Co.html"}], "Reference": [{"ref_link": "https://github.com/fluxcd/kustomize-controller/security/advisories/GHSA-35rf-v2jv-gfg7", "ref_desc": "Privilege escalation to cluster admin on multi-tenant environments \u00b7 Advisory \u00b7 fluxcd/kustomize-controller \u00b7 GitHubExploit;Mitigation;Third Party Advisory", "ref_cve_link": "N/A"}]}