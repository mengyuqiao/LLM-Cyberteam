{"CVE Code": "CVE-2021-43777", "Description": "Redash is a package for data visualization and sharing. In Redash version 10.0 and prior, the implementation of Google Login (via OAuth) incorrectly uses the `state` parameter to pass the next URL to redirect the user to after login. The `state` parameter should be used for a Cross-Site Request Forgery (CSRF) token, not a static and easily predicted value. This vulnerability does not affect users who do not use Google Login for their instance of Redash. A patch in the `master` and `release/10.x.x` branches addresses this by replacing `Flask-Oauthlib` with `Authlib` which automatically provides and validates a CSRF token for the state variable. The new implementation stores the next URL on the user session object. As a workaround, one may disable Google Login to mitigate the vulnerability.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-43777", "Vulnerability Categories": "Cross-site request forgery (CSRF);Open redirect", "Affected Products": "\nRedash\u00bbRedashVersions  up to, including, (<=) 10.0.0cpe:2.3:a:redash:redash:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.10% Probability of exploitation activity in the next 30 days\n~ 29 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2025-05-19  0.10%  0.10%  +0.01 \n 2  2025-03-30  0.08%  0.10%  +0.02 \n 3  2025-03-29  0.10%  0.08%  -0.02 \n 4  2025-03-17  0.05%  0.10%  +0.04 \n 5  2023-06-16  0.05%  0.05%  +0.00 \n 6  2023-05-06  0.05%  0.05%  +0.01 \n 7  2023-03-07  0.89%  0.05%  -0.84 ", "CVSS Scores": "5.8", "CWE": [{"CWE_ID": "CWE-352 Cross-Site Request Forgery (CSRF)", "CWE_link": "/cwe-details/352/Cross-Site-Request-Forgery-CSRF-.html"}, {"CWE_ID": "CWE-601 URL Redirection to Untrusted Site ('Open Redirect')", "CWE_link": "/cwe-details/601/URL-Redirection-to-Untrusted-Site-Open-Redirect-.html"}], "Reference": [{"ref_link": "https://github.com/getredash/redash/security/advisories/GHSA-vhc7-w7r8-8m34", "ref_desc": "Insecure use of state parameter for Google OAuth Login \u00b7 Advisory \u00b7 getredash/redash \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/getredash/redash/commit/da696ff7f84787cbf85967460fac52886cbe063e", "ref_desc": "Merge pull request from GHSA-vhc7-w7r8-8m34 \u00b7 getredash/redash@da696ff \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}]}