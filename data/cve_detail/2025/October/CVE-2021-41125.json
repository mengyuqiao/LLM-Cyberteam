{"CVE Code": "CVE-2021-41125", "Description": "Scrapy is a high-level web crawling and scraping framework for Python. If you use `HttpAuthMiddleware` (i.e. the `http_user` and `http_pass` spider attributes) for HTTP authentication, all requests will expose your credentials to the request target. This includes requests generated by Scrapy components, such as `robots.txt` requests sent by Scrapy when the `ROBOTSTXT_OBEY` setting is set to `True`, or as requests reached through redirects. Upgrade to Scrapy 2.5.1 and use the new `http_auth_domain` spider attribute to control which domains are allowed to receive the configured HTTP authentication credentials. If you are using Scrapy 1.8 or a lower version, and upgrading to Scrapy 2.5.1 is not an option, you may upgrade to Scrapy 1.8.1 instead. If you cannot upgrade, set your HTTP authentication credentials on a per-request basis, using for example the `w3lib.http.basic_auth_header` function to convert your credentials into a value that you can assign to the `Authorization` header of your request, instead of defining your credentials globally using `HttpAuthMiddleware`.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-41125", "Vulnerability Categories": "Information leak", "Affected Products": "\nDebian\u00bbDebian Linux\u00bbVersion:9.0cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*Matching versions\nScrapy\u00bbScrapyVersions  before (<) 1.8.1cpe:2.3:a:scrapy:scrapy:*:*:*:*:*:*:*:*Matching versions\nScrapy\u00bbScrapyVersions  from including (>=) 2.0.0andbefore (<) 2.5.1cpe:2.3:a:scrapy:scrapy:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.47% Probability of exploitation activity in the next 30 days\n~ 64 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2025-05-28  0.48%  0.47%  -0.01 \n 2  2025-05-15  0.51%  0.48%  -0.03 \n 3  2025-05-14  0.47%  0.51%  +0.04 \n 4  2025-03-30  1.11%  0.47%  -0.64 \n 5  2025-03-29  0.47%  1.11%  +0.64 \n 6  2025-03-20  0.32%  0.47%  +0.15 \n 7  2025-03-17  0.25%  0.32%  +0.08 \n 8  2024-12-17  0.52%  0.25%  -0.27 \n 9  2024-10-23  0.37%  0.52%  +0.15 \n 10  2023-12-29  0.18%  0.37%  +0.18 \n 11  2023-04-29  0.17%  0.18%  +0.01 \n 12  2023-03-07  0.95%  0.17%  -0.78 ", "CVSS Scores": "4.0", "CWE": [{"CWE_ID": "CWE-200 Exposure of Sensitive Information to an Unauthorized Actor", "CWE_link": "/cwe-details/200/Exposure-of-Sensitive-Information-to-an-Unauthorized-Actor.html"}, {"CWE_ID": "CWE-522 Insufficiently Protected Credentials", "CWE_link": "/cwe-details/522/Insufficiently-Protected-Credentials.html"}], "Reference": [{"ref_link": "http://doc.scrapy.org/en/latest/topics/downloader-middleware.html#module-scrapy.downloadermiddlewares.httpauth", "ref_desc": "Downloader Middleware \u2014 Scrapy 2.5.1 documentationVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.debian.org/debian-lts-announce/2022/03/msg00021.html", "ref_desc": "[SECURITY] [DLA 2950-1] python-scrapy security updateMailing List;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/h3rQ77l37c2l0MJCzo3LIn3PLvc.html"}, {"ref_link": "https://github.com/scrapy/scrapy/security/advisories/GHSA-jwqp-28gf-p498", "ref_desc": "HTTP authentication credentials potentially leaked to target websites \u00b7 Advisory \u00b7 scrapy/scrapy \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/scrapy/scrapy/commit/b01d69a1bf48060daec8f751368622352d8b85a6", "ref_desc": "Add http_auth_domain to HttpAuthMiddleware. \u00b7 scrapy/scrapy@b01d69a \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://w3lib.readthedocs.io/en/latest/w3lib.html#w3lib.http.basic_auth_header", "ref_desc": "w3lib Package \u2014 w3lib 1.22.0 documentationThird Party Advisory", "ref_cve_link": "N/A"}]}