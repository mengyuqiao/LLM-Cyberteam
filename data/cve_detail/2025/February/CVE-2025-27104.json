{"CVE Code": "CVE-2025-27104", "Description": "vyper is a Pythonic Smart Contract Language for the EVM. Multiple evaluation of a single expression is possible in the iterator target of a for loop. While the iterator expression cannot produce multiple writes, it can consume side effects produced in the loop body (e.g. read a storage variable updated in the loop body) and thus lead to unexpected program behavior. Specifically, reads in iterators which contain an ifexp (e.g. `for s: uint256 in ([read(), read()] if True else [])`) may interleave reads with writes in the loop body. Vyper for loops allow two kinds of iterator targets, namely the `range()` builtin and an iterable type, like SArray and DArray. During codegen, iterable lists are required to not produce any side-effects (in the following code, `range_scope` forces `iter_list` to be parsed in a constant context, which is checked against `is_constant`). However, this does not prevent the iterator from consuming side effects provided by the body of the loop. For SArrays on the other hand, `iter_list` is instantiated in the body of a `repeat` ir, so it can be evaluated several times. This issue is being addressed and is expected to be available in version 0.4.1. Users are advised to upgrade as soon as the patched release is available. There are no known workarounds for this vulnerability.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2025-27104", "Vulnerability Categories": "N/A", "Affected Products": "\nVyperlang\u00bbVyper\u00bbForPythonVersions  before (<) 0.4.1cpe:2.3:a:vyperlang:vyper:*:*:*:*:*:python:*:*Matching versions", "EPSS Score": "0.05% Probability of exploitation activity in the next 30 days\n~ 13 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2025-03-25  0.05%  0.05%  +0.01 \n 2  2025-03-17  0.04%  0.05%  +0.00 ", "CVSS Scores": "7.5", "CWE": [{"CWE_ID": "CWE-662 Improper Synchronization", "CWE_link": "/cwe-details/662/Improper-Synchronization.html"}], "Reference": [{"ref_link": "https://github.com/vyperlang/vyper/security/advisories/GHSA-h33q-mhmp-8p67", "ref_desc": "double eval in For List Iter \u00b7 Advisory \u00b7 vyperlang/vyper \u00b7 GitHubVendor Advisory;Exploit", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/vyperlang/vyper/pull/4488", "ref_desc": "Issue Tracking;Patch", "ref_cve_link": "N/A"}]}