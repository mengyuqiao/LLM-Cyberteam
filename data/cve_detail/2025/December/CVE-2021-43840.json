{"CVE Code": "CVE-2021-43840", "Description": "message_bus is a messaging bus for Ruby processes and web clients. In versions prior to 3.3.7 users who deployed message bus with diagnostics features enabled (default off) are vulnerable to a path traversal bug, which could lead to disclosure of secret information on a machine if an unintended user were to gain access to the diagnostic route. The impact is also greater if there is no proxy for your web application as the number of steps up the directories is not bounded. For deployments which uses a proxy, the impact varies. For example, If a request goes through a proxy like Nginx with `merge_slashes` enabled, the number of steps up the directories that can be read is limited to 3 levels. This issue has been patched in version 3.3.7. Users unable to upgrade should ensure that MessageBus::Diagnostics is disabled.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-43840", "Vulnerability Categories": "Directory traversal", "Affected Products": "\nDiscourse\u00bbMessage Bus\u00bbForRubyVersions  before (<) 3.3.7cpe:2.3:a:discourse:message_bus:*:*:*:*:*:ruby:*:*Matching versions", "EPSS Score": "0.22% Probability of exploitation activity in the next 30 days\n~ 42 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2025-03-30  0.43%  0.22%  -0.21 \n 2  2025-03-29  0.22%  0.43%  +0.21 \n 3  2025-03-17  0.07%  0.22%  +0.15 \n 4  2023-07-10  0.07%  0.07%  0.00 \n 5  2023-03-07  0.89%  0.07%  -0.81 ", "CVSS Scores": "3.5", "CWE": [{"CWE_ID": "CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')", "CWE_link": "/cwe-details/22/Improper-Limitation-of-a-Pathname-to-a-Restricted-Directory-.html"}], "Reference": [{"ref_link": "https://github.com/discourse/message_bus/commit/9b6deee01ed474c7e9b5ff65a06bb0447b4db2ba", "ref_desc": "SECURITY: Fix path traversal on diagnostics route. \u00b7 discourse/message_bus@9b6deee \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/discourse/message_bus/security/advisories/GHSA-xmgj-5fh3-xjmm", "ref_desc": "Path traversal when MessageBus::Diagnostics is enabled \u00b7 Advisory \u00b7 discourse/message_bus \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}]}