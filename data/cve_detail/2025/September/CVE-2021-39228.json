{"CVE Code": "CVE-2021-39228", "Description": "Tremor is an event processing system for unstructured data. A vulnerability exists between versions 0.7.2 and 0.11.6. This vulnerability is a memory safety Issue when using `patch` or `merge` on `state` and assign the result back to `state`. In this case, affected versions of Tremor and the tremor-script crate maintains references to memory that might have been freed already. And these memory regions can be accessed by retrieving the `state`, e.g. send it over TCP or HTTP. This requires the Tremor server (or any other program using tremor-script) to execute a tremor-script script that uses the mentioned language construct. The issue has been patched in version 0.11.6 by removing the optimization and always cloning the target expression of a Merge or Patch. If an upgrade is not possible, a possible workaround is to avoid the optimization by introducing a temporary variable and not immediately reassigning to `state`.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-39228", "Vulnerability Categories": "N/A", "Affected Products": "\nLinuxfoundation\u00bbTremorVersions  from including (>=) 0.7.2andbefore (<) 0.11.6cpe:2.3:a:linuxfoundation:tremor:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.55% Probability of exploitation activity in the next 30 days\n~ 65 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2025-03-30  0.79%  0.55%  -0.24 \n 2  2025-03-29  0.55%  0.79%  +0.24 \n 3  2025-03-17  0.34%  0.55%  +0.21 \n 4  2024-12-17  0.31%  0.34%  +0.03 \n 5  2024-06-02  0.28%  0.31%  +0.03 \n 6  2024-04-23  0.23%  0.28%  +0.05 \n 7  2023-12-10  0.18%  0.23%  +0.05 \n 8  2023-05-09  0.15%  0.18%  +0.03 \n 9  2023-04-25  0.13%  0.15%  +0.03 \n 10  2023-04-10  0.13%  0.13%  0.00 \n 11  2023-03-07  1.02%  0.13%  -0.89 ", "CVSS Scores": "7.5", "CWE": [{"CWE_ID": "CWE-416 Use After Free", "CWE_link": "/cwe-details/416/Use-After-Free.html"}, {"CWE_ID": "CWE-825 Expired Pointer Dereference", "CWE_link": "/cwe-details/825/Expired-Pointer-Dereference.html"}], "Reference": [{"ref_link": "https://github.com/tremor-rs/tremor-runtime/security/advisories/GHSA-mc22-5q92-8v85", "ref_desc": "Memory Safety Issue when using patch or merge on state and assign the result back to state \u00b7 Advisory \u00b7 tremor-rs/tremor-runtime \u00b7 GitHubMitigation;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/tremor-rs/tremor-runtime/commit/1a2efcdbe68e5e7fd0a05836ac32d2cde78a0b2e", "ref_desc": "Remove patch and merge in_place optimizations. \u00b7 tremor-rs/tremor-runtime@1a2efcd \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/tremor-rs/tremor-runtime/pull/1217", "ref_desc": "Remove in-place optimizations of patch and merge by mfelsche \u00b7 Pull Request #1217 \u00b7 tremor-rs/tremor-runtime \u00b7 GitHubExploit;Patch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/tremor-rs/tremor-runtime/releases/tag/v0.11.6", "ref_desc": "Release v0.11.6 - Fix Memory safety issue \u00b7 tremor-rs/tremor-runtime \u00b7 GitHubRelease Notes;Third Party Advisory", "ref_cve_link": "N/A"}]}