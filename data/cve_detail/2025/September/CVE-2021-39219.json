{"CVE Code": "CVE-2021-39219", "Description": "Wasmtime is an open source runtime for WebAssembly & WASI. Wasmtime before version 0.30.0 is affected by a type confusion vulnerability. As a Rust library the `wasmtime` crate clearly marks which functions are safe and which are `unsafe`, guaranteeing that if consumers never use `unsafe` then it should not be possible to have memory unsafety issues in their embeddings of Wasmtime. An issue was discovered in the safe API of `Linker::func_*` APIs. These APIs were previously not sound when one `Engine` was used to create the `Linker` and then a different `Engine` was used to create a `Store` and then the `Linker` was used to instantiate a module into that `Store`. Cross-`Engine` usage of functions is not supported in Wasmtime and this can result in type confusion of function pointers, resulting in being able to safely call a function with the wrong type. Triggering this bug requires using at least two `Engine` values in an embedding and then additionally using two different values with a `Linker` (one at the creation time of the `Linker` and another when instantiating a module with the `Linker`). It's expected that usage of more-than-one `Engine` in an embedding is relatively rare since an `Engine` is intended to be a globally shared resource, so the expectation is that the impact of this issue is relatively small. The fix implemented is to change this behavior to `panic!()` in Rust instead of silently allowing it. Using different `Engine` instances with a `Linker` is a programmer bug that `wasmtime` catches at runtime. This bug has been patched and users should upgrade to Wasmtime version 0.30.0. If you cannot upgrade Wasmtime and are using more than one `Engine` in your embedding it's recommended to instead use only one `Engine` for the entire program if possible. An `Engine` is designed to be a globally shared resource that is suitable to have only one for the lifetime of an entire process. If using multiple `Engine`s is required then code should be audited to ensure that `Linker` is only used with one `Engine`.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-39219", "Vulnerability Categories": "N/A", "Affected Products": "\nFedoraproject\u00bbFedora\u00bbVersion:34cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*Matching versions\nFedoraproject\u00bbFedora\u00bbVersion:35cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*Matching versions\nBytecodealliance\u00bbWasmtimeVersions  before (<) 0.30.0cpe:2.3:a:bytecodealliance:wasmtime:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.07% Probability of exploitation activity in the next 30 days\n~ 20 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2025-04-14  0.15%  0.07%  -0.08 \n 2  2025-03-30  0.19%  0.15%  -0.04 \n 3  2025-03-29  0.15%  0.19%  +0.04 \n 4  2025-03-17  0.05%  0.15%  +0.11 \n 5  2023-03-07  0.95%  0.05%  -0.91 ", "CVSS Scores": "3.3", "CWE": [{"CWE_ID": "CWE-843 Access of Resource Using Incompatible Type ('Type Confusion')", "CWE_link": "/cwe-details/843/Access-of-Resource-Using-Incompatible-Type-Type-Confusion-.html"}], "Reference": [{"ref_link": "https://crates.io/crates/wasmtime", "ref_desc": "wasmtime - crates.io: Rust Package RegistryProductCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/_M19B_Su0oM92pYQsnLOPFVNzgI.html"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WAVBRYDDUIY2ZR3K3FO4BVYJKIMJ5TP7/", "ref_desc": "[SECURITY] Fedora 34 Update: rust-wasmtime-fiber-0.30.0-1.fc34 - package-announce - Fedora Mailing-ListsMailing List;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/7yGRoWVRdCzC6SgCX_7W8ckN5oc.html"}, {"ref_link": "https://github.com/bytecodealliance/wasmtime/commit/b39f087414f27ae40c44449ed5d1154e03449bff", "ref_desc": "Merge pull request from GHSA-q879-9g95-56mx \u00b7 bytecodealliance/wasmtime@b39f087 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-q879-9g95-56mx", "ref_desc": "Wrong type for `Linker`-define functions when used across two `Engine`s \u00b7 Advisory \u00b7 bytecodealliance/wasmtime \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/Z2Z33FTXFQ6EOINVEQIP4DFBG53G5XIY/", "ref_desc": "[SECURITY] Fedora 35 Update: rust-cranelift-frontend-0.77.0-1.fc35 - package-announce - Fedora Mailing-ListsMailing List;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/u0mTmSTW1ujAY8shCuFOZmJw6-U.html"}]}