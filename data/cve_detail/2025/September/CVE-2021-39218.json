{"CVE Code": "CVE-2021-39218", "Description": "Wasmtime is an open source runtime for WebAssembly & WASI. In Wasmtime from version 0.26.0 and before version 0.30.0 is affected by a memory unsoundness vulnerability. There was an invalid free and out-of-bounds read and write bug when running Wasm that uses `externref`s in Wasmtime. To trigger this bug, Wasmtime needs to be running Wasm that uses `externref`s, the host creates non-null `externrefs`, Wasmtime performs a garbage collection (GC), and there has to be a Wasm frame on the stack that is at a GC safepoint where there are no live references at this safepoint, and there is a safepoint with live references earlier in this frame's function. Under this scenario, Wasmtime would incorrectly use the GC stack map for the safepoint from earlier in the function instead of the empty safepoint. This would result in Wasmtime treating arbitrary stack slots as `externref`s that needed to be rooted for GC. At the *next* GC, it would be determined that nothing was referencing these bogus `externref`s (because nothing could ever reference them, because they are not really `externref`s) and then Wasmtime would deallocate them and run `<ExternRef as Drop>::drop` on them. This results in a free of memory that is not necessarily on the heap (and shouldn't be freed at this moment even if it was), as well as potential out-of-bounds reads and writes. Even though support for `externref`s (via the reference types proposal) is enabled by default, unless you are creating non-null `externref`s in your host code or explicitly triggering GCs, you cannot be affected by this bug. We have reason to believe that the effective impact of this bug is relatively small because usage of `externref` is currently quite rare. This bug has been patched and users should upgrade to Wasmtime version 0.30.0. If you cannot upgrade Wasmtime at this time, you can avoid this bug by disabling the reference types proposal by passing `false` to `wasmtime::Config::wasm_reference_types`.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-39218", "Vulnerability Categories": "Memory Corruption", "Affected Products": "\nFedoraproject\u00bbFedora\u00bbVersion:34cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*Matching versions\nFedoraproject\u00bbFedora\u00bbVersion:35cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*Matching versions\nBytecodealliance\u00bbWasmtime\u00bbForRustVersions  from including (>=) 0.26.0andbefore (<) 0.30.0cpe:2.3:a:bytecodealliance:wasmtime:*:*:*:*:*:rust:*:*Matching versions", "EPSS Score": "0.09% Probability of exploitation activity in the next 30 days\n~ 23 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2025-04-14  0.18%  0.09%  -0.09 \n 2  2025-03-30  0.23%  0.18%  -0.04 \n 3  2025-03-29  0.18%  0.23%  +0.04 \n 4  2025-03-17  0.05%  0.18%  +0.14 \n 5  2023-03-07  0.95%  0.05%  -0.91 ", "CVSS Scores": "3.3", "CWE": [{"CWE_ID": "CWE-125 Out-of-bounds Read", "CWE_link": "/cwe-details/125/Out-of-bounds-Read.html"}, {"CWE_ID": "CWE-590 Free of Memory not on the Heap", "CWE_link": "/cwe-details/590/Free-of-Memory-not-on-the-Heap.html"}, {"CWE_ID": "CWE-787 Out-of-bounds Write", "CWE_link": "/cwe-details/787/Out-of-bounds-Write.html"}], "Reference": [{"ref_link": "https://crates.io/crates/wasmtime", "ref_desc": "wasmtime - crates.io: Rust Package RegistryProduct;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/_M19B_Su0oM92pYQsnLOPFVNzgI.html"}, {"ref_link": "https://github.com/bytecodealliance/wasmtime/commit/398a73f0dd862dbe703212ebae8e34036a18c11c", "ref_desc": "Merge pull request from GHSA-4873-36h9-wv49 \u00b7 bytecodealliance/wasmtime@398a73f \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WAVBRYDDUIY2ZR3K3FO4BVYJKIMJ5TP7/", "ref_desc": "[SECURITY] Fedora 34 Update: rust-wasmtime-fiber-0.30.0-1.fc34 - package-announce - Fedora Mailing-ListsMailing List;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/7yGRoWVRdCzC6SgCX_7W8ckN5oc.html"}, {"ref_link": "https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-4873-36h9-wv49", "ref_desc": "Out-of-bounds read/write and invalid free with `externref`s and GC safepoints in Wasmtime \u00b7 Advisory \u00b7 bytecodealliance/wasmtime \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/Z2Z33FTXFQ6EOINVEQIP4DFBG53G5XIY/", "ref_desc": "[SECURITY] Fedora 35 Update: rust-cranelift-frontend-0.77.0-1.fc35 - package-announce - Fedora Mailing-ListsMailing List;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/u0mTmSTW1ujAY8shCuFOZmJw6-U.html"}]}