{"CVE Code": "CVE-2021-32829", "Description": "ZStack is open source IaaS(infrastructure as a service) software aiming to automate datacenters, managing resources of compute, storage, and networking all by APIs. Affected versions of ZStack REST API are vulnerable to post-authentication Remote Code Execution (RCE) via bypass of the Groovy shell sandbox. The REST API exposes the GET zstack/v1/batch-queries?script endpoint which is backed up by the BatchQueryAction class. Messages are represented by the APIBatchQueryMsg, dispatched to the QueryFacadeImpl facade and handled by the BatchQuery class. The HTTP request parameter script is mapped to the APIBatchQueryMsg.script property and evaluated as a Groovy script in BatchQuery.query the evaluation of the user-controlled Groovy script is sandboxed by SandboxTransformer which will apply the restrictions defined in the registered (sandbox.register()) GroovyInterceptor. Even though the sandbox heavily restricts the receiver types to a small set of allowed types, the sandbox is non effective at controlling any code placed in Java annotations and therefore vulnerable to meta-programming escapes. This issue leads to post-authenticated remote code execution. For more details see the referenced GHSL-2021-065. This issue is patched in versions 3.8.21, 3.10.8, and 4.1.0.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-32829", "Vulnerability Categories": "Execute code", "Affected Products": "\nZstack\u00bbRest ApiVersions  from including (>=) 2.2.4andbefore (<) 3.8.21cpe:2.3:a:zstack:rest_api:*:*:*:*:*:*:*:*Matching versions\nZstack\u00bbRest ApiVersions  from including (>=) 3.10.0andbefore (<) 3.10.8cpe:2.3:a:zstack:rest_api:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "1.39% Probability of exploitation activity in the next 30 days\n~ 79 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2025-03-30  2.35%  1.39%  -0.96 \n 2  2025-03-29  1.39%  2.35%  +0.96 \n 3  2025-03-17  2.74%  1.39%  -1.35 \n 4  2024-12-17  1.88%  2.74%  +0.85 \n 5  2024-09-19  1.34%  1.88%  +0.55 \n 6  2024-08-05  1.03%  1.34%  +0.30 \n 7  2024-01-30  1.00%  1.03%  +0.04 \n 8  2023-11-09  0.83%  1.00%  +0.16 \n 9  2023-04-08  0.64%  0.83%  +0.19 \n 10  2023-03-25  0.53%  0.64%  +0.11 \n 11  2023-03-10  0.49%  0.53%  +0.05 \n 12  2023-03-07  4.57%  0.49%  -4.09 ", "CVSS Scores": "6.5", "CWE": [{"CWE_ID": "CWE-94 Improper Control of Generation of Code ('Code Injection')", "CWE_link": "/cwe-details/94/Improper-Control-of-Generation-of-Code-Code-Injection-.html"}, {"CWE_ID": "CWE-863 Incorrect Authorization", "CWE_link": "/cwe-details/863/Incorrect-Authorization.html"}], "Reference": [{"ref_link": "https://blog.orange.tw/2019/02/abusing-meta-programming-for-unauthenticated-rce.html", "ref_desc": "Orange: Hacking Jenkins Part 2 - Abusing Meta Programming for Unauthenticated RCE!Not Applicable", "ref_cve_link": "N/A"}, {"ref_link": "https://securitylab.github.com/advisories/GHSL-2021-065-zstack/", "ref_desc": "GHSL-2021-065: Post-authentication Remote Code Execution (RCE) in ZStack REST API - CVE-2021-32829 | GitHub Security LabExploit;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/zstackio/zstack/security/advisories/GHSA-6xgq-7rqg-x3q5", "ref_desc": "Post-authentication remote code execution in ZStack \u00b7 Advisory \u00b7 zstackio/zstack \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}]}