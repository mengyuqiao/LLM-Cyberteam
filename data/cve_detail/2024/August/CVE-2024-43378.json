{"CVE Code": "CVE-2024-43378", "Description": "calamares-nixos-extensions provides Calamares branding and modules for NixOS, a distribution of GNU/Linux. Users who installed NixOS through the graphical installer who used manual disk partitioning to create a setup where the system was booted via legacy BIOS rather than UEFI; some disk partitions are encrypted; but the partitions containing either `/` or `/boot` are unencrypted; have their LUKS disk encryption key file in plain text either in `/crypto_keyfile.bin`, or in a CPIO archive attached to their NixOS initrd. `nixos-install` is not affected, nor are UEFI installations, nor was the default automatic partitioning configuration on legacy BIOS systems. The problem has been fixed in calamares-nixos-extensions 0.3.17, which was included in NixOS. The current installer images for the NixOS 24.05 and unstable (24.11) channels are unaffected. The fix reached 24.05 at 2024-08-13 20:06:59 UTC, and unstable at 2024-08-15 09:00:20 UTC. Installer images downloaded before those times may be vulnerable. The best solution for affected users is probably to back up their data and do a complete reinstallation. However, the mitigation procedure in GHSA-3rvf-24q2-24ww should work solely for the case where `/` is encrypted but `/boot` is not. If `/` is unencrypted, then the `/crypto_keyfile.bin` file will need to be deleted in addition to the remediation steps in the previous advisory. This issue is a partial regression of CVE-2023-36476 / GHSA-3rvf-24q2-24ww, which was more severe as it applied to the default configuration on BIOS systems.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-43378", "Vulnerability Categories": "N/A", "Affected Products": "N/A", "EPSS Score": "0.05% Probability of exploitation activity in the next 30 days\n~ 16 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "7.8", "CWE": [{"CWE_ID": "CWE-256 Plaintext Storage of a Password", "CWE_link": "/cwe-details/256/Plaintext-Storage-of-a-Password.html"}], "Reference": [{"ref_link": "https://github.com/NixOS/calamares-nixos-extensions/pull/43", "ref_desc": "Fix `crypto_keyfile.bin` creation condition by vlinkz \u00b7 Pull Request #43 \u00b7 NixOS/calamares-nixos-extensions \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/NixOS/nixpkgs/pull/334252", "ref_desc": "[Backport release-24.05] calamares: 3.3.8, calamares-nixos-extensions: 0.3.18 by github-actions[bot] \u00b7 Pull Request #334252 \u00b7 NixOS/nixpkgs \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/NixOS/nixpkgs/pull/331607", "ref_desc": "calamares: 3.3.8, calamares-nixos-extensions: 0.3.18 by ElvishJerricco \u00b7 Pull Request #331607 \u00b7 NixOS/nixpkgs \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/NixOS/calamares-nixos-extensions/security/advisories/GHSA-3rvf-24q2-24ww", "ref_desc": "`calamares-nixos-extensions` LUKS keyfile exposure \u00b7 Advisory \u00b7 NixOS/calamares-nixos-extensions \u00b7 GitHubCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/tgpvcxQCTeucEGgZ2FLxkS40V8I.html"}, {"ref_link": "https://github.com/NixOS/calamares-nixos-extensions/security/advisories/GHSA-vfxf-gpmj-2p25", "ref_desc": "calamares-nixos-extensions LUKS keyfile exposure regression on legacy BIOS systems \u00b7 Advisory \u00b7 NixOS/calamares-nixos-extensions \u00b7 GitHub", "ref_cve_link": "N/A"}]}