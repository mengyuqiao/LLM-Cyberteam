{"CVE Code": "CVE-2024-41658", "Description": "Casdoor is a UI-first Identity and Access Management (IAM) / Single-Sign-On (SSO) platform.  In Casdoor 1.577.0 and earlier, he purchase URL that is created to generate a WechatPay QR code is vulnerable to reflected XSS. When purchasing an item through casdoor, the product page allows you to pay via wechat pay. When using wechat pay, a QR code with the wechat pay link is displayed on the payment page, hosted on the domain of casdoor. This page takes a query parameter from the url successUrl, and redirects the user to that url after a successful purchase. Because the user has no reason to think that the payment page contains sensitive information, they may share it with other or can be social engineered into sending it to others. An attacker can then craft the casdoor link with a special url and send it back to the user, and once payment has gone though an XSS attack occurs.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-41658", "Vulnerability Categories": "Cross site scripting (XSS)", "Affected Products": "\nCasbin\u00bbCasdoorVersions  up to, including, (<=) 1.577.0cpe:2.3:a:casbin:casdoor:*:*:*:*:*:*:*:*Matching versions\nCasbin\u00bbCasdoorcpe:2.3:a:casbin:casdoor:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.05% Probability of exploitation activity in the next 30 days\n~ 18 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-08-29  0.04%  0.05%  +0.00 ", "CVSS Scores": "6.1", "CWE": [{"CWE_ID": "CWE-79 Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "CWE_link": "/cwe-details/79/Improper-Neutralization-of-Input-During-Web-Page-Generation-.html"}], "Reference": [{"ref_link": "https://github.com/casdoor/casdoor/blob/v1.577.0/web/src/QrCodePage.js", "ref_desc": "casdoor/web/src/QrCodePage.js at v1.577.0 \u00b7 casdoor/casdoor \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://securitylab.github.com/advisories/GHSL-2024-035_GHSL-2024-036_casdoor/", "ref_desc": "GHSL-2024-035_GHSL-2024-036: CORS misconfguration and Reflected XSS in Casdoor - CVE-2024-41657, CVE-2024-41658 | GitHub Security LabExploit;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/QZhWmIKmCSx6mrqcOkxLDRRD4Uc.html"}]}