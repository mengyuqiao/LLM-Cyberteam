{"CVE Code": "CVE-2024-53845", "Description": "ESPTouch is a connection protocol for internet of things devices. In the ESPTouchV2 protocol, while there is an option to use a custom AES key, there is no option to set the IV (Initialization Vector) prior to versions 5.3.2, 5.2.4, 5.1.6, and 5.0.8. The IV is set to zero and remains constant throughout the product's lifetime. In AES/CBC mode, if the IV is not properly initialized, the encrypted output becomes deterministic, leading to potential data leakage. To address the aforementioned issues, the application generates a random IV when activating the AES key starting in versions 5.3.2, 5.2.4, 5.1.6, and 5.0.8. This IV is then transmitted along with the provision data to the provision device. The provision device has also been equipped with a parser for the AES IV. The upgrade is applicable for all applications and users of ESPTouch v2 component from ESP-IDF. As it is implemented in the ESP Wi-Fi stack, there is no workaround for the user to fix the application layer without upgrading the underlying firmware.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-53845", "Vulnerability Categories": "N/A", "Affected Products": "N/A", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 15 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "6.6", "CWE": [{"CWE_ID": "CWE-327 Use of a Broken or Risky Cryptographic Algorithm", "CWE_link": "/cwe-details/327/Use-of-a-Broken-or-Risky-Cryptographic-Algorithm.html"}, {"CWE_ID": "CWE-909 Missing Initialization of Resource", "CWE_link": "/cwe-details/909/Missing-Initialization-of-Resource.html"}], "Reference": [{"ref_link": "https://github.com/espressif/esp-idf/tree/master/components/esp_wifi", "ref_desc": "esp-idf/components/esp_wifi at master \u00b7 espressif/esp-idf \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/EspressifApp/EsptouchForAndroid/tree/master/esptouch-v2", "ref_desc": "EsptouchForAndroid/esptouch-v2 at master \u00b7 EspressifApp/EsptouchForAndroid \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/espressif/esp-idf/commit/8fb28dcedcc49916a5206456a3a61022d4302cd8", "ref_desc": "fix(wifi): Support AES IV with random value in esptouch v2 \u00b7 espressif/esp-idf@8fb28dc \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/espressif/esp-idf/commit/d47ed7d6f814e21c5bc8997ab0bc68e2360e5cb2", "ref_desc": "fix(wifi): Support AES IV with random value in esptouch v2 \u00b7 espressif/esp-idf@d47ed7d \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/espressif/esp-idf/commit/fd224e83bbf133833638b277c767be7f7cdd97c7", "ref_desc": "fix(wifi): Support AES IV with random value in esptouch v2 \u00b7 espressif/esp-idf@fd224e8 \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/espressif/esp-idf/commit/de69895f38d563e22228f5ba23fffa02feabc3a9", "ref_desc": "fix(wifi): Support AES IV with random value in esptouch v2 \u00b7 espressif/esp-idf@de69895 \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/espressif/esp-idf/commit/4f85a2726e04b737c8646d865b44ddd837b703db", "ref_desc": "fix(wifi): Support AES IV with random value in esptouch v2 \u00b7 espressif/esp-idf@4f85a27 \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/espressif/esp-idf/security/advisories/GHSA-wm57-466g-mhrr", "ref_desc": "AES/CBC Constant IV Vulnerability in ESPTouch v2 \u00b7 Advisory \u00b7 espressif/esp-idf \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/EspressifApp/EsptouchForIOS/tree/master/EspTouchDemo/ESPTouchV2", "ref_desc": "EsptouchForIOS/EspTouchDemo/ESPTouchV2 at master \u00b7 EspressifApp/EsptouchForIOS \u00b7 GitHub", "ref_cve_link": "N/A"}]}