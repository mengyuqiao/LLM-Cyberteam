{"CVE Code": "CVE-2024-53135", "Description": "In the Linux kernel, the following vulnerability has been resolved:\n\nKVM: VMX: Bury Intel PT virtualization (guest/host mode) behind CONFIG_BROKEN\n\nHide KVM's pt_mode module param behind CONFIG_BROKEN, i.e. disable support\nfor virtualizing Intel PT via guest/host mode unless BROKEN=y.  There are\nmyriad bugs in the implementation, some of which are fatal to the guest,\nand others which put the stability and health of the host at risk.\n\nFor guest fatalities, the most glaring issue is that KVM fails to ensure\ntracing is disabled, and *stays* disabled prior to VM-Enter, which is\nnecessary as hardware disallows loading (the guest's) RTIT_CTL if tracing\nis enabled (enforced via a VMX consistency check).  Per the SDM:\n\n  If the logical processor is operating with Intel PT enabled (if\n  IA32_RTIT_CTL.TraceEn = 1) at the time of VM entry, the \"load\n  IA32_RTIT_CTL\" VM-entry control must be 0.\n\nOn the host side, KVM doesn't validate the guest CPUID configuration\nprovided by userspace, and even worse, uses the guest configuration to\ndecide what MSRs to save/load at VM-Enter and VM-Exit.  E.g. configuring\nguest CPUID to enumerate more address ranges than are supported in hardware\nwill result in KVM trying to passthrough, save, and load non-existent MSRs,\nwhich generates a variety of WARNs, ToPA ERRORs in the host, a potential\ndeadlock, etc.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-53135", "Vulnerability Categories": "N/A", "Affected Products": "\nLinux\u00bbLinux KernelVersions  from including (>=) 6.2andbefore (<) 6.6.63cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*Matching versions\nLinux\u00bbLinux KernelVersions  from including (>=) 5.0andbefore (<) 6.1.119cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*Matching versions\nLinux\u00bbLinux KernelVersions  from including (>=) 6.7andbefore (<) 6.11.10cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*Matching versions\nLinux\u00bbLinux Kernel\u00bbVersion:6.12UpdateRC1cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*Matching versions\nLinux\u00bbLinux Kernel\u00bbVersion:6.12UpdateRC2cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*Matching versions\nLinux\u00bbLinux Kernel\u00bbVersion:6.12UpdateRC3cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*Matching versions\nLinux\u00bbLinux Kernel\u00bbVersion:6.12UpdateRC4cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*Matching versions\nLinux\u00bbLinux Kernel\u00bbVersion:6.12UpdateRC5cpe:2.3:o:linux:linux_kernel:6.12:rc5:*:*:*:*:*:*Matching versions\nLinux\u00bbLinux Kernel\u00bbVersion:6.12UpdateRC6cpe:2.3:o:linux:linux_kernel:6.12:rc6:*:*:*:*:*:*Matching versions\nLinux\u00bbLinux Kernel\u00bbVersion:6.12UpdateRC7cpe:2.3:o:linux:linux_kernel:6.12:rc7:*:*:*:*:*:*Matching versions", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 5 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.04%  0.04%  0.00 ", "CVSS Scores": "6.5", "CWE": [], "Reference": [{"ref_link": "https://git.kernel.org/stable/c/d28b059ee4779b5102c5da6e929762520510e406", "ref_desc": "KVM: VMX: Bury Intel PT virtualization (guest/host mode) behind CONFIG_BROKEN - kernel/git/stable/linux.git - Linux kernel stable treePatch", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/d4b42f926adcce4e5ec193c714afd9d37bba8e5b", "ref_desc": "KVM: VMX: Bury Intel PT virtualization (guest/host mode) behind CONFIG_BROKEN - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/b91bb0ce5cd7005b376eac690ec664c1b56372ec", "ref_desc": "KVM: VMX: Bury Intel PT virtualization (guest/host mode) behind CONFIG_BROKEN - kernel/git/stable/linux.git - Linux kernel stable treePatch", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/c3742319d021f5aa3a0a8c828485fee14753f6de", "ref_desc": "KVM: VMX: Bury Intel PT virtualization (guest/host mode) behind CONFIG_BROKEN - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/e6716f4230a8784957273ddd27326264b27b9313", "ref_desc": "KVM: VMX: Bury Intel PT virtualization (guest/host mode) behind CONFIG_BROKEN - kernel/git/stable/linux.git - Linux kernel stable treePatch", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/aa0d42cacf093a6fcca872edc954f6f812926a17", "ref_desc": "KVM: VMX: Bury Intel PT virtualization (guest/host mode) behind CONFIG_BROKEN - kernel/git/stable/linux.git - Linux kernel stable treePatch", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/b8a1d572478b6f239061ee9578b2451bf2f021c2", "ref_desc": "KVM: VMX: Bury Intel PT virtualization (guest/host mode) behind CONFIG_BROKEN - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}]}