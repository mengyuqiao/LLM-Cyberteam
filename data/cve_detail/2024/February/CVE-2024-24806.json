{"CVE Code": "CVE-2024-24806", "Description": "libuv is a multi-platform support library with a focus on asynchronous I/O. The `uv_getaddrinfo` function in `src/unix/getaddrinfo.c` (and its windows counterpart `src/win/getaddrinfo.c`), truncates hostnames to 256 characters before calling `getaddrinfo`. This behavior can be exploited to create addresses like `0x00007f000001`, which are considered valid by `getaddrinfo` and could allow an attacker to craft payloads that resolve to unintended IP addresses, bypassing developer checks. The vulnerability arises due to how the `hostname_ascii` variable (with a length of 256 bytes) is handled in `uv_getaddrinfo` and subsequently in `uv__idna_toascii`. When the hostname exceeds 256 characters, it gets truncated without a terminating null byte. As a result attackers may be able to access internal APIs or for websites (similar to MySpace) that allows users to have `username.example.com` pages. Internal services that crawl or cache these user pages can be exposed to SSRF attacks if a malicious user chooses a long vulnerable username. This issue has been addressed in release version 1.48.0. Users are advised to upgrade. There are no known workarounds for this vulnerability.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-24806", "Vulnerability Categories": "Server-side request forgery (SSRF)", "Affected Products": "\nLibuv\u00bbLibuvVersions  from including (>=) 1.24.0andbefore (<) 1.48.0cpe:2.3:a:libuv:libuv:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.11% Probability of exploitation activity in the next 30 days\n~ 45 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-10-28  0.09%  0.11%  +0.02 \n 2  2024-08-14  0.09%  0.09%  +0.01 \n 3  2024-06-26  0.11%  0.09%  -0.03 \n 4  2024-06-11  0.11%  0.11%  +0.00 \n 5  2024-03-06  0.10%  0.11%  +0.01 \n 6  2024-02-28  0.10%  0.10%  0.00 \n 7  2024-02-15  0.06%  0.10%  +0.04 ", "CVSS Scores": "9.8", "CWE": [{"CWE_ID": "CWE-918 Server-Side Request Forgery (SSRF)", "CWE_link": "/cwe-details/918/Server-Side-Request-Forgery-SSRF-.html"}], "Reference": [{"ref_link": "https://github.com/libuv/libuv/commit/c858a147643de38a09dd4164758ae5b685f2b488", "ref_desc": "Merge pull request from GHSA-f74f-cvh7-c6q6 \u00b7 libuv/libuv@c858a14 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/libuv/libuv/commit/3530bcc30350d4a6ccf35d2f7b33e23292b9de70", "ref_desc": "fix: reject zero-length idna inputs \u00b7 libuv/libuv@3530bcc \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://gitlab.kitware.com/cmake/cmake/-/issues/26112", "ref_desc": "Report of fixed CVE-2024-24806 in libuv (#26112) \u00b7 Issues \u00b7 CMake / CMake \u00b7 GitLab", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/libuv/libuv/security/advisories/GHSA-f74f-cvh7-c6q6", "ref_desc": "Improper Domain Lookup that potentially leads to SSRF attacks \u00b7 Advisory \u00b7 libuv/libuv \u00b7 GitHubExploit;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.debian.org/debian-lts-announce/2024/03/msg00005.html", "ref_desc": "[SECURITY] [DLA 3752-1] libuv1 security update", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/libuv/libuv/commit/0f2d7e784a256b54b2385043438848047bc2a629", "ref_desc": "fix: always zero-terminate idna output \u00b7 libuv/libuv@0f2d7e7 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://security.netapp.com/advisory/ntap-20240605-0008/", "ref_desc": "CVE-2024-24806 libuv Vulnerability in NetApp Products | NetApp Product Security", "ref_cve_link": "N/A"}, {"ref_link": "http://www.openwall.com/lists/oss-security/2024/02/11/1", "ref_desc": "oss-security - Re: libuv 1.48.0 released, fixes CVE-2024-24806Mailing List;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "http://www.openwall.com/lists/oss-security/2024/03/11/1", "ref_desc": "oss-security - NodeJS v{18.x,20.x,21.x} February Security UpdatesCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/V_YjBD7pkf4KuBkSCo3K6xlAajY.html"}, {"ref_link": "https://github.com/libuv/libuv/commit/e0327e1d508b8207c9150b6e582f0adf26213c39", "ref_desc": "test: empty strings are not valid IDNA \u00b7 libuv/libuv@e0327e1 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "http://www.openwall.com/lists/oss-security/2024/02/08/2", "ref_desc": "oss-security - libuv 1.48.0 released, fixes CVE-2024-24806Mailing List;Third Party Advisory", "ref_cve_link": "N/A"}]}