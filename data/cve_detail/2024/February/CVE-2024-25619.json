{"CVE Code": "CVE-2024-25619", "Description": "Mastodon is a free, open-source social network server based on ActivityPub. When an OAuth Application is destroyed, the streaming server wasn't being informed that the Access Tokens had also been destroyed, this could have posed security risks to users by allowing an application to continue listening to streaming after the application had been destroyed. Essentially this comes down to the fact that when Doorkeeper sets up the relationship between Applications and Access Tokens, it uses a `dependent: delete_all` configuration, which means the `after_commit` callback setup on `AccessTokenExtension` didn't actually fire, since `delete_all` doesn't trigger ActiveRecord callbacks. To mitigate, we need to add a `before_destroy` callback to `ApplicationExtension` which announces to streaming that all the Application's Access Tokens are being \"killed\". Impact should be negligible given the affected application had to be owned by the user. None the less this issue has been addressed in versions 4.2.6, 4.1.14, 4.0.14, and 3.5.18. Users are advised to upgrade. There are no known workaround for this vulnerability.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-25619", "Vulnerability Categories": "N/A", "Affected Products": "N/A", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 9 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "3.1", "CWE": [{"CWE_ID": "CWE-613 Insufficient Session Expiration", "CWE_link": "/cwe-details/613/Insufficient-Session-Expiration.html"}, {"CWE_ID": "CWE-672 Operation on a Resource after Expiration or Release", "CWE_link": "/cwe-details/672/Operation-on-a-Resource-after-Expiration-or-Release.html"}], "Reference": [{"ref_link": "https://github.com/mastodon/mastodon/commit/68eaa804c9bafdc5f798e114e9ba00161425dd71", "ref_desc": "Merge pull request from GHSA-7w3c-p9j8-mq3x \u00b7 mastodon/mastodon@68eaa80 \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/mastodon/mastodon/security/advisories/GHSA-7w3c-p9j8-mq3x", "ref_desc": "Destroying OAuth Applications doesn't notify Streaming of Access Tokens being destroyed \u00b7 Advisory \u00b7 mastodon/mastodon \u00b7 GitHub", "ref_cve_link": "N/A"}]}