{"CVE Code": "CVE-2024-24563", "Description": "Vyper is a Pythonic Smart Contract Language for the Ethereum Virtual Machine. Arrays can be keyed by a signed integer, while they are defined for unsigned integers only. The typechecker doesn't throw when spotting the usage of an `int` as an index for an array. The typechecker allows the usage of signed integers to be used as indexes to arrays. The vulnerability is present in different forms in all versions, including `0.3.10`. For ints, the 2's complement representation is used. Because the array was declared very large, the bounds checking will pass Negative values will simply be represented as very large numbers. As of time of publication, a fixed version does not exist.\n\nThere are three potential vulnerability classes: unpredictable behavior, accessing inaccessible elements and denial of service. Class 1: If it is possible to index an array with a negative integer without reverting, this is most likely not anticipated by the developer and such accesses can cause unpredictable behavior for the contract. Class 2: If a contract has an invariant in the form `assert index < x`, the developer will suppose that no elements on indexes `y | y >= x` are accessible. However, by using negative indexes, this can be bypassed. Class 3: If the index is dependent on the state of the contract, this poses a risk of denial of service. If the state of the contract can be manipulated in such way that the index will be forced to be negative, the array access can always revert (because most likely the array won't be declared extremely large). However, all these the scenarios are highly unlikely. Most likely behavior is a revert on the bounds check.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-24563", "Vulnerability Categories": "Denial of service", "Affected Products": "\nVyperlang\u00bbVyper\u00bbForPythonVersions  up to, including, (<=) 0.3.10cpe:2.3:a:vyperlang:vyper:*:*:*:*:*:python:*:*Matching versions", "EPSS Score": "0.07% Probability of exploitation activity in the next 30 days\n~ 28 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-02-15  0.05%  0.07%  +0.02 ", "CVSS Scores": "9.8", "CWE": [{"CWE_ID": "CWE-129 Improper Validation of Array Index", "CWE_link": "/cwe-details/129/Improper-Validation-of-Array-Index.html"}], "Reference": [{"ref_link": "https://github.com/vyperlang/vyper/blob/a1fd228cb9936c3e4bbca6f3ee3fb4426ef45490/vyper/codegen/core.py#L534-L541", "ref_desc": "vyper/vyper/codegen/core.py at a1fd228cb9936c3e4bbca6f3ee3fb4426ef45490 \u00b7 vyperlang/vyper \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/vyperlang/vyper/security/advisories/GHSA-52xq-j7v9-v4v2", "ref_desc": "negative array indexes \u00b7 Advisory \u00b7 vyperlang/vyper \u00b7 GitHubExploit;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/vyperlang/vyper/blob/c150fc49ee9375a930d177044559b83cb95f7963/vyper/semantics/types/subscriptable.py#L127-L137", "ref_desc": "vyper/vyper/semantics/types/subscriptable.py at c150fc49ee9375a930d177044559b83cb95f7963 \u00b7 vyperlang/vyper \u00b7 GitHubProduct", "ref_cve_link": "N/A"}]}