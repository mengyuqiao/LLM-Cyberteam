{"CVE Code": "CVE-2024-35844", "Description": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: compress: fix reserve_cblocks counting error when out of space\n\nWhen a file only needs one direct_node, performing the following\noperations will cause the file to be unrepairable:\n\nunisoc # ./f2fs_io compress test.apk\nunisoc #df -h | grep dm-48\n/dev/block/dm-48 112G 112G 1.2M 100% /data\n\nunisoc # ./f2fs_io release_cblocks test.apk\n924\nunisoc # df -h | grep dm-48\n/dev/block/dm-48 112G 112G 4.8M 100% /data\n\nunisoc # dd if=/dev/random of=file4 bs=1M count=3\n3145728 bytes (3.0 M) copied, 0.025 s, 120 M/s\nunisoc # df -h | grep dm-48\n/dev/block/dm-48 112G 112G 1.8M 100% /data\n\nunisoc # ./f2fs_io reserve_cblocks test.apk\nF2FS_IOC_RESERVE_COMPRESS_BLOCKS failed: No space left on device\n\nadb reboot\nunisoc # df -h  | grep dm-48\n/dev/block/dm-48             112G 112G   11M 100% /data\nunisoc # ./f2fs_io reserve_cblocks test.apk\n0\n\nThis is because the file has only one direct_node. After returning\nto -ENOSPC, reserved_blocks += ret will not be executed. As a result,\nthe reserved_blocks at this time is still 0, which is not the real\nnumber of reserved blocks. Therefore, fsck cannot be set to repair\nthe file.\n\nAfter this patch, the fsck flag will be set to fix this problem.\n\nunisoc # df -h | grep dm-48\n/dev/block/dm-48             112G 112G  1.8M 100% /data\nunisoc # ./f2fs_io reserve_cblocks test.apk\nF2FS_IOC_RESERVE_COMPRESS_BLOCKS failed: No space left on device\n\nadb reboot then fsck will be executed\nunisoc # df -h  | grep dm-48\n/dev/block/dm-48             112G 112G   11M 100% /data\nunisoc # ./f2fs_io reserve_cblocks test.apk\n924", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-35844", "Vulnerability Categories": "N/A", "Affected Products": "N/A", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 10 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "N/A", "CWE": [], "Reference": [{"ref_link": "https://git.kernel.org/stable/c/fa3ac8b1a227d9b470b87972494293348b5839ee", "ref_desc": "f2fs: compress: fix reserve_cblocks counting error when out of space - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/fc0aed88afbf6f606205129a7466eebdf528e3f3", "ref_desc": "f2fs: compress: fix reserve_cblocks counting error when out of space - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/2f6d721e14b69d6e1251f69fa238b48e8374e25f", "ref_desc": "f2fs: compress: fix reserve_cblocks counting error when out of space - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/889846dfc8ee2cf31148a44bfd2faeb2faadc685", "ref_desc": "f2fs: compress: fix reserve_cblocks counting error when out of space - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/f0bf89e84c3afb79d7a3a9e4bc853ad6a3245c0a", "ref_desc": "f2fs: compress: fix reserve_cblocks counting error when out of space - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/569c198c9e2093fd29cc071856a4e548fda506bc", "ref_desc": "f2fs: compress: fix reserve_cblocks counting error when out of space - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "http://www.openwall.com/lists/oss-security/2024/05/30/1", "ref_desc": "oss-security - Re: List linux CVEs for a given stable release?CVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/ULBVzWcUXjnZ-p2CUb8ojA06Jpw.html"}, {"ref_link": "http://www.openwall.com/lists/oss-security/2024/05/30/2", "ref_desc": "oss-security - Re: List linux CVEs for a given stable release?CVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/xxHhCp92QxCC0trVdlR3I95F_Cc.html"}]}