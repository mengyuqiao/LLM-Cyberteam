{"CVE Code": "CVE-2024-32962", "Description": "xml-crypto is an xml digital signature and encryption library for Node.js. In affected versions the default configuration does not check authorization of the signer, it only checks the validity of the signature per section 3.2.2 of the w3 xmldsig-core-20080610 spec. As such, without additional validation steps, the default configuration allows a malicious actor to re-sign an XML document, place the certificate in a `<KeyInfo />` element, and pass `xml-crypto` default validation checks. As a result `xml-crypto` trusts by default any certificate provided via digitally signed XML document's `<KeyInfo />`. `xml-crypto` prefers to use any certificate provided via digitally signed XML document's `<KeyInfo />` even if library was configured to use specific certificate (`publicCert`) for signature verification purposes.  An attacker can spoof signature verification by modifying XML document and replacing existing signature with signature generated with malicious private key (created by attacker) and by attaching that private key's certificate to `<KeyInfo />` element. This vulnerability is combination of changes introduced to `4.0.0` on pull request 301 / commit `c2b83f98` and has been addressed in version 6.0.0 with pull request 445 / commit `21201723d`. Users are advised to upgrade. Users unable to upgrade may either check the certificate extracted via `getCertFromKeyInfo` against trusted certificates before accepting the results of the validation or set `xml-crypto's getCertFromKeyInfo` to `() => undefined` forcing `xml-crypto` to use an explicitly configured `publicCert` or `privateKey` for signature verification.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-32962", "Vulnerability Categories": "N/A", "Affected Products": "N/A", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 10 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "10.0", "CWE": [{"CWE_ID": "CWE-347 Improper Verification of Cryptographic Signature", "CWE_link": "/cwe-details/347/Improper-Verification-of-Cryptographic-Signature.html"}], "Reference": [{"ref_link": "https://security.netapp.com/advisory/ntap-20240705-0003/", "ref_desc": "CVE-2024-32962 Node.js Vulnerability in NetApp Products | NetApp Product Security", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/node-saml/xml-crypto/security/advisories/GHSA-2xp3-57p7-qf4v", "ref_desc": "XML signature verification bypass due improper verification of signature / signature spoofing \u00b7 Advisory \u00b7 node-saml/xml-crypto \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://www.w3.org/TR/2008/REC-xmldsig-core-20080610/#sec-CoreValidation", "ref_desc": "XML Signature Syntax and Processing (Second Edition)", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/node-saml/xml-crypto/pull/301", "ref_desc": "Add support for <X509Certificate /> in <KeyInfo />; remove `KeyInfoProvider` by cjbarth \u00b7 Pull Request #301 \u00b7 node-saml/xml-crypto \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/node-saml/xml-crypto/pull/445", "ref_desc": "Set `getCertFromKeyInfo` to `noop` by cjbarth \u00b7 Pull Request #445 \u00b7 node-saml/xml-crypto \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/node-saml/xml-crypto/commit/21201723d2ca9bc11288f62cf72552b7d659b000", "ref_desc": "Set `getCertFromKeyInfo` to `noop` (#445) \u00b7 node-saml/xml-crypto@2120172 \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/node-saml/xml-crypto/commit/c2b83f984049edb68ad1d7c6ad0739ec92af11ca", "ref_desc": "Add support for <X509Certificate /> in <KeyInfo />; remove `KeyInfoPr\u2026 \u00b7 node-saml/xml-crypto@c2b83f9 \u00b7 GitHub", "ref_cve_link": "N/A"}]}