{"CVE Code": "CVE-2024-49768", "Description": "Waitress is a Web Server Gateway Interface server for Python 2 and 3. A remote client may send a request that is exactly recv_bytes (defaults to 8192) long, followed by a secondary request using HTTP pipelining. When request lookahead is disabled (default) we won't read any more requests, and when the first request fails due to a parsing error, we simply close the connection. However when request lookahead is enabled, it is possible to process and receive the first request, start sending the error message back to the client while we read the next request and queue it. This will allow the secondary request to be serviced by the worker thread while the connection should be closed. Waitress 3.0.1 fixes the race condition. As a workaround, disable channel_request_lookahead, this is set to 0 by default disabling this feature.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-49768", "Vulnerability Categories": "N/A", "Affected Products": "\nAgendaless\u00bbWaitressVersions  from including (>=) 2.0.0andbefore (<) 3.0.1cpe:2.3:a:agendaless:waitress:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.05% Probability of exploitation activity in the next 30 days\n~ 18 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-11-08  0.04%  0.05%  +0.00 ", "CVSS Scores": "4.8", "CWE": [{"CWE_ID": "CWE-367 Time-of-check Time-of-use (TOCTOU) Race Condition", "CWE_link": "/cwe-details/367/Time-of-check-Time-of-use-TOCTOU-Race-Condition.html"}, {"CWE_ID": "CWE-444 Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')", "CWE_link": "/cwe-details/444/Inconsistent-Interpretation-of-HTTP-Requests-HTTP-Request-.html"}], "Reference": [{"ref_link": "https://github.com/Pylons/waitress/security/advisories/GHSA-9298-4cf8-g4wj", "ref_desc": "Request processing race condition in HTTP pipelining with invalid first request \u00b7 Advisory \u00b7 Pylons/waitress \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/Pylons/waitress/commit/e4359018537af376cf24bd13616d861e2fb76f65", "ref_desc": "Merge commit from fork \u00b7 Pylons/waitress@e435901 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}]}