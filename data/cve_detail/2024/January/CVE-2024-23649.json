{"CVE Code": "CVE-2024-23649", "Description": "Lemmy is a link aggregator and forum for the fediverse. Starting in version 0.17.0 and prior to version 0.19.1, users can report private messages, even when they're neither sender nor recipient of the message. The API response to creating a private message report contains the private message itself, which means any user can just iterate over message ids to (loudly) obtain all private messages of an instance. A user with instance admin privileges can also abuse this if the private message is removed from the response, as they're able to see the resulting reports.\n\nCreating a private message report by POSTing to `/api/v3/private_message/report` does not validate whether the reporter is the recipient of the message. lemmy-ui does not allow the sender to report the message; the API method should likely be restricted to accessible to recipients only. The API response when creating a report contains the `private_message_report_view` with all the details of the report, including the private message that has been reported:\n\nAny authenticated user can obtain arbitrary (untargeted) private message contents. Privileges required depend on the instance configuration; when registrations are enabled without application system, the privileges required are practically none. When registration applications are required, privileges required could be considered low, but this assessment heavily varies by instance.\n\nVersion 0.19.1 contains a patch for this issue. A workaround is available. If an update to a fixed Lemmy version is not immediately possible, the API route can be blocked in the reverse proxy. This will prevent anyone from reporting private messages, but it will also prevent exploitation before the update has been applied.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-23649", "Vulnerability Categories": "Bypass;Gain privilege;Information leak", "Affected Products": "\nJoin-lemmy\u00bbLemmy\u00bbForRustVersions  from including (>=) 0.17.0andbefore (<) 0.19.1cpe:2.3:a:join-lemmy:lemmy:*:*:*:*:*:rust:*:*Matching versions", "EPSS Score": "0.05% Probability of exploitation activity in the next 30 days\n~ 15 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-02-03  0.04%  0.05%  +0.01 ", "CVSS Scores": "6.5", "CWE": [{"CWE_ID": "CWE-200 Exposure of Sensitive Information to an Unauthorized Actor", "CWE_link": "/cwe-details/200/Exposure-of-Sensitive-Information-to-an-Unauthorized-Actor.html"}, {"CWE_ID": "CWE-285 Improper Authorization", "CWE_link": "/cwe-details/285/Improper-Authorization.html"}], "Reference": [{"ref_link": "https://github.com/LemmyNet/lemmy/commit/bc32b408b523b9b64aa57b8e47748f96cce0dae5", "ref_desc": "Fixing private message reports. (#4279) \u00b7 LemmyNet/lemmy@bc32b40 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/LemmyNet/lemmy/security/advisories/GHSA-r64r-5h43-26qv", "ref_desc": "Any authenticated user may obtain private message details from other users on the same instance \u00b7 Advisory \u00b7 LemmyNet/lemmy \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}]}