{"CVE Code": "CVE-2024-22417", "Description": "Whoogle Search is a self-hosted metasearch engine. In versions 0.8.3 and prior, the `element` method in `app/routes.py` does not validate the user-controlled `src_type` and `element_url` variables and passes them to the `send` method which sends a `GET` request on lines 339-343 in `requests.py`. The returned contents of the URL are then passed to and reflected back to the user in the `send_file` function on line 484, together with the user-controlled `src_type`, which allows the attacker to control the HTTP response content type leading to a cross-site scripting vulnerability. An attacker could craft a special URL to point to a malicious website and send the link to a victim. The fact that the link would contain a trusted domain (e.g. from one of public Whoogle instances) could be used to trick the user into clicking the link. The malicious website could, for example, be a copy of a real website, meant to steal a person\u2019s credentials to the website, or trick that person in another way. Version 0.8.4 contains a patch for this issue.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-22417", "Vulnerability Categories": "Cross site scripting (XSS)", "Affected Products": "\nBenbusby\u00bbWhoogle SearchVersions  before (<) 0.8.4cpe:2.3:a:benbusby:whoogle_search:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.08% Probability of exploitation activity in the next 30 days\n~ 33 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "6.1", "CWE": [{"CWE_ID": "CWE-79 Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "CWE_link": "/cwe-details/79/Improper-Neutralization-of-Input-During-Web-Page-Generation-.html"}], "Reference": [{"ref_link": "https://github.com/benbusby/whoogle-search/commit/3a2e0b262e4a076a20416b45e6b6f23fd265aeda", "ref_desc": "Validate urls in `element` and `window` endpoints \u00b7 benbusby/whoogle-search@3a2e0b2 \u00b7 GitHubPatchCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/6qFfjouy0c1PvzlJdBsjcdIVwvw.html"}, {"ref_link": "https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L484C6-L484C7", "ref_desc": "whoogle-search/app/routes.py at 92e8ede24e9277a5440d403f75877209f1269884 \u00b7 benbusby/whoogle-search \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L465-L490", "ref_desc": "whoogle-search/app/routes.py at 92e8ede24e9277a5440d403f75877209f1269884 \u00b7 benbusby/whoogle-search \u00b7 GitHubProductCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/fCz3ywmmVQHiraS2ENdChXwJ5PI.html"}, {"ref_link": "https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L466", "ref_desc": "whoogle-search/app/routes.py at 92e8ede24e9277a5440d403f75877209f1269884 \u00b7 benbusby/whoogle-search \u00b7 GitHubProductCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/JT4kuU_q2XNwwGSThFI0kY9SkPk.html"}, {"ref_link": "https://securitylab.github.com/advisories/GHSL-2023-186_GHSL-2023-189_benbusby_whoogle-search/", "ref_desc": "GHSL-2023-186_GHSL-2023-189: Server-Side Request Forgery (SSRF) and Cross-Site Scripting (XSS) in whoogle-search - CVE-2024-22203, CVE-2024-22204, CVE-2024-22205, CVE-2024-22417 | GitHub Security LabExploit;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/M5EIlDYg_itIER13iIt2ksrB-ns.html"}, {"ref_link": "https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L479", "ref_desc": "whoogle-search/app/routes.py at 92e8ede24e9277a5440d403f75877209f1269884 \u00b7 benbusby/whoogle-search \u00b7 GitHubProductCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/Q6OgRt_Zp0lLkDQv9tW7eGhlXTg.html"}, {"ref_link": "https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/request.py#L339-L343", "ref_desc": "whoogle-search/app/request.py at 92e8ede24e9277a5440d403f75877209f1269884 \u00b7 benbusby/whoogle-search \u00b7 GitHubProductCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/TFFavOur_-RuWrBxsxIXALjfBv4.html"}, {"ref_link": "https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L476", "ref_desc": "whoogle-search/app/routes.py at 92e8ede24e9277a5440d403f75877209f1269884 \u00b7 benbusby/whoogle-search \u00b7 GitHubProductCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/YIR5OZ2dlkXsfgCApRkY1iCmiJA.html"}]}