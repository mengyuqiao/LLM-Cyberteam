{"CVE Code": "CVE-2024-22204", "Description": "Whoogle Search is a self-hosted metasearch engine. Versions 0.8.3 and prior have a limited file write vulnerability when the configuration options in Whoogle are enabled. The `config` function in `app/routes.py` does not validate the user-controlled `name` variable on line 447 and `config_data` variable on line 437. The `name` variable is insecurely concatenated in `os.path.join`, leading to path manipulation. The POST data from the `config_data` variable is saved with `pickle.dump` which leads to a limited file write. However, the data that is saved is earlier transformed into a dictionary and the `url` key value pair is added before the file is saved on the system. All in all, the issue allows us to save and overwrite files on the system that the application has permissions to, with a dictionary containing arbitrary data and the `url` key value, which is a limited file write. Version 0.8.4 contains a patch for this issue.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-22204", "Vulnerability Categories": "Directory traversal", "Affected Products": "\nBenbusby\u00bbWhoogle SearchVersions  before (<) 0.8.4cpe:2.3:a:benbusby:whoogle_search:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.08% Probability of exploitation activity in the next 30 days\n~ 34 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-02-02  0.05%  0.08%  +0.04 ", "CVSS Scores": "5.3", "CWE": [{"CWE_ID": "CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')", "CWE_link": "/cwe-details/22/Improper-Limitation-of-a-Pathname-to-a-Restricted-Directory-.html"}], "Reference": [{"ref_link": "https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L437", "ref_desc": "whoogle-search/app/routes.py at 92e8ede24e9277a5440d403f75877209f1269884 \u00b7 benbusby/whoogle-search \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/benbusby/whoogle-search/commit/3a2e0b262e4a076a20416b45e6b6f23fd265aeda", "ref_desc": "Validate urls in `element` and `window` endpoints \u00b7 benbusby/whoogle-search@3a2e0b2 \u00b7 GitHubPatchCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/6qFfjouy0c1PvzlJdBsjcdIVwvw.html"}, {"ref_link": "https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L447", "ref_desc": "whoogle-search/app/routes.py at 92e8ede24e9277a5440d403f75877209f1269884 \u00b7 benbusby/whoogle-search \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://securitylab.github.com/advisories/GHSL-2023-186_GHSL-2023-189_benbusby_whoogle-search/", "ref_desc": "GHSL-2023-186_GHSL-2023-189: Server-Side Request Forgery (SSRF) and Cross-Site Scripting (XSS) in whoogle-search - CVE-2024-22203, CVE-2024-22204, CVE-2024-22205, CVE-2024-22417 | GitHub Security LabExploit;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/M5EIlDYg_itIER13iIt2ksrB-ns.html"}, {"ref_link": "https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L419-L452", "ref_desc": "whoogle-search/app/routes.py at 92e8ede24e9277a5440d403f75877209f1269884 \u00b7 benbusby/whoogle-search \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L444", "ref_desc": "whoogle-search/app/routes.py at 92e8ede24e9277a5440d403f75877209f1269884 \u00b7 benbusby/whoogle-search \u00b7 GitHubProduct", "ref_cve_link": "N/A"}]}