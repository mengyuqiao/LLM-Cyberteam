{"CVE Code": "CVE-2024-22419", "Description": "Vyper is a Pythonic Smart Contract Language for the Ethereum Virtual Machine. The `concat` built-in can write over the bounds of the memory buffer that was allocated for it and thus overwrite existing valid data. The root cause is that the `build_IR` for `concat` doesn't properly adhere to the API of copy functions (for `>=0.3.2` the `copy_bytes` function). A contract search was performed and no vulnerable contracts were found in production. The buffer overflow can result in the change of semantics of the contract. The overflow is length-dependent and thus it might go unnoticed during contract testing. However, certainly not all usages of concat will result in overwritten valid data as we require it to be in an internal function and close to the return statement where other memory allocations don't occur. This issue has been addressed in 0.4.0.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-22419", "Vulnerability Categories": "Overflow", "Affected Products": "\nVyperlang\u00bbVyper\u00bbForPythonVersions  up to, including, (<=) 0.3.10cpe:2.3:a:vyperlang:vyper:*:*:*:*:*:python:*:*Matching versions", "EPSS Score": "0.10% Probability of exploitation activity in the next 30 days\n~ 41 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-01-27  0.06%  0.10%  +0.04 ", "CVSS Scores": "9.8", "CWE": [{"CWE_ID": "CWE-120 Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')", "CWE_link": "/cwe-details/120/Buffer-Copy-without-Checking-Size-of-Input-Classic-Buffer-.html"}, {"CWE_ID": "CWE-787 Out-of-bounds Write", "CWE_link": "/cwe-details/787/Out-of-bounds-Write.html"}], "Reference": [{"ref_link": "https://github.com/vyperlang/vyper/commit/55e18f6d128b2da8986adbbcccf1cd59a4b9ad6f", "ref_desc": "fix: concat buffer bug (#3738) \u00b7 vyperlang/vyper@55e18f6 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/vyperlang/vyper/issues/3737", "ref_desc": "concat builtin can overrun memory \u00b7 Issue #3737 \u00b7 vyperlang/vyper \u00b7 GitHubExploit;Issue Tracking;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/vyperlang/vyper/security/advisories/GHSA-2q8v-3gqq-4f8p", "ref_desc": "concat built-in can corrupt memory \u00b7 Advisory \u00b7 vyperlang/vyper \u00b7 GitHubExploit;Vendor Advisory", "ref_cve_link": "N/A"}]}