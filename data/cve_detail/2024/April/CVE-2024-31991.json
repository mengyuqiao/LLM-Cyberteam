{"CVE Code": "CVE-2024-31991", "Description": "Mealie is a self hosted recipe manager and meal planner. Prior to 1.4.0, the safe_scrape_html function utilizes a user-controlled URL to issue a request to a remote server. Based on the content of the response, it will either parse the content or disregard it. This function, nor those that call it, add any restrictions on the URL that can be provided, nor is it restricted to being an FQDN (i.e., an IP address can be provided). As this function\u2019s return will be handled differently by its caller depending on the response, it is possible for an attacker to use this functionality to positively identify HTTP(s) servers on the local network with any IP/port combination. This issue can result in any authenticated user being able to map HTTP servers on a local network that the Mealie service has access to. Note that by default any user can create an account on a Mealie server, and that the default changeme@example.com user is available with its hard-coded password. This vulnerability is fixed in 1.4.0.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-31991", "Vulnerability Categories": "Server-side request forgery (SSRF)", "Affected Products": "N/A", "EPSS Score": "0.06% Probability of exploitation activity in the next 30 days\n~ 26 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-04-21  0.05%  0.06%  +0.02 ", "CVSS Scores": "4.1", "CWE": [{"CWE_ID": "CWE-918 Server-Side Request Forgery (SSRF)", "CWE_link": "/cwe-details/918/Server-Side-Request-Forgery-SSRF-.html"}], "Reference": [{"ref_link": "https://github.com/mealie-recipes/mealie/commit/2a3463b7466bc297aede50046da9550d919ec56f", "ref_desc": "security: gh security recs (#3368) \u00b7 mealie-recipes/mealie@2a3463b \u00b7 GitHubCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/-nCIuU9Yu3c9Aww-7UR5Z8X4VQQ.html"}, {"ref_link": "https://github.com/mealie-recipes/mealie/blob/mealie-next/mealie/services/scraper/scraper_strategies.py#L27-L70", "ref_desc": "mealie/mealie/services/scraper/scraper_strategies.py at mealie-next \u00b7 mealie-recipes/mealie \u00b7 GitHubCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/EbG2D_PcfOu82Dm-B52QsdZurN8.html"}, {"ref_link": "https://securitylab.github.com/advisories/GHSL-2023-225_GHSL-2023-226_Mealie/", "ref_desc": "GHSL-2023-225, GHSL-2023-226, GHSL-2023-227, and GHSL-2023-228: Server-Side Request Forgery (SSRF) and Denial of Service (DoS) in Mealie - CVE-2024-31991, CVE-2024-31992, CVE-2024-31993, CVE-2024-3199CVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/mtDJTpXlhNT_YzWNTJq4E3-76Qg.html"}, {"ref_link": "https://github.com/mealie-recipes/mealie/pull/3368", "ref_desc": "security: gh security recs by hay-kot \u00b7 Pull Request #3368 \u00b7 mealie-recipes/mealie \u00b7 GitHubCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/W_ny9aa1k38YbB3p7vkIPQRUTHI.html"}]}