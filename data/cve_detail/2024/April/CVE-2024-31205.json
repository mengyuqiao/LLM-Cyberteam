{"CVE Code": "CVE-2024-31205", "Description": "Saleor is an e-commerce platform. Starting in version 3.10.0 and prior to versions 3.14.64, 3.15.39, 3.16.39, 3.17.35, 3.18.31, and 3.19.19, an attacker may bypass cross-set request forgery (CSRF) validation when calling refresh token mutation with empty string. When a user provides an empty string in `refreshToken` mutation, while the token persists in `JWT_REFRESH_TOKEN_COOKIE_NAME` cookie, application omits validation against CSRF token and returns valid access token. Versions 3.14.64, 3.15.39, 3.16.39, 3.17.35, 3.18.31, and 3.19.19 contain a patch for the issue. As a workaround, one may replace `saleor.graphql.account.mutations.authentication.refresh_token.py.get_refresh_token`. This will fix the issue, but be aware, that it returns `JWT_MISSING_TOKEN` instead of `JWT_INVALID_TOKEN`.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-31205", "Vulnerability Categories": "Cross-site request forgery (CSRF)", "Affected Products": "N/A", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 9 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "4.2", "CWE": [{"CWE_ID": "CWE-352 Cross-Site Request Forgery (CSRF)", "CWE_link": "/cwe-details/352/Cross-Site-Request-Forgery-CSRF-.html"}], "Reference": [{"ref_link": "https://github.com/saleor/saleor/commit/36699c6f5c99590d24f46e3d5c5b1a3c2fd072e7", "ref_desc": "Advisory fix merx-280. \u00b7 saleor/saleor@36699c6 \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/saleor/saleor/security/advisories/GHSA-ff69-fwjf-3c9w", "ref_desc": "CSRF bypass in refreshToken mutation \u00b7 Advisory \u00b7 saleor/saleor \u00b7 GitHub", "ref_cve_link": "N/A"}]}