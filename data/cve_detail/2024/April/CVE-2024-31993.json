{"CVE Code": "CVE-2024-31993", "Description": "Mealie is a self hosted recipe manager and meal planner. Prior to 1.4.0, the scrape_image function will retrieve an image based on a user-provided URL, however the provided URL is not validated to point to an external location and does not have any enforced rate limiting. The response from the Mealie server will also vary depending on whether or not the target file is an image, is not an image, or does not exist. Additionally, when a file is retrieved the file may remain stored on Mealie\u2019s file system as original.jpg under the UUID of the recipe it was requested for. If the attacker has access to an admin account (e.g. the default changeme@example.com), this file can then be retrieved. Note that if Mealie is running in a development setting this could be leveraged by an attacker to retrieve any file that the Mealie server had downloaded in this fashion without the need for administrator access. This vulnerability is fixed in 1.4.0.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-31993", "Vulnerability Categories": "Server-side request forgery (SSRF)", "Affected Products": "N/A", "EPSS Score": "0.06% Probability of exploitation activity in the next 30 days\n~ 26 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-04-21  0.05%  0.06%  +0.02 ", "CVSS Scores": "6.2", "CWE": [{"CWE_ID": "CWE-918 Server-Side Request Forgery (SSRF)", "CWE_link": "/cwe-details/918/Server-Side-Request-Forgery-SSRF-.html"}], "Reference": [{"ref_link": "https://github.com/mealie-recipes/mealie/commit/2a3463b7466bc297aede50046da9550d919ec56f", "ref_desc": "security: gh security recs (#3368) \u00b7 mealie-recipes/mealie@2a3463b \u00b7 GitHubCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/-nCIuU9Yu3c9Aww-7UR5Z8X4VQQ.html"}, {"ref_link": "https://securitylab.github.com/advisories/GHSL-2023-225_GHSL-2023-226_Mealie/", "ref_desc": "GHSL-2023-225, GHSL-2023-226, GHSL-2023-227, and GHSL-2023-228: Server-Side Request Forgery (SSRF) and Denial of Service (DoS) in Mealie - CVE-2024-31991, CVE-2024-31992, CVE-2024-31993, CVE-2024-3199CVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/mtDJTpXlhNT_YzWNTJq4E3-76Qg.html"}, {"ref_link": "https://github.com/mealie-recipes/mealie/blob/ee121a12f8db33ecb4db5f8582f7ea9788d019e4/mealie/services/recipe/recipe_data_service.py#L107", "ref_desc": "mealie/mealie/services/recipe/recipe_data_service.py at ee121a12f8db33ecb4db5f8582f7ea9788d019e4 \u00b7 mealie-recipes/mealie \u00b7 GitHubCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/rbhzAtozSysogsNT8l4bu1pLuXA.html"}, {"ref_link": "https://github.com/mealie-recipes/mealie/pull/3368", "ref_desc": "security: gh security recs by hay-kot \u00b7 Pull Request #3368 \u00b7 mealie-recipes/mealie \u00b7 GitHubCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/W_ny9aa1k38YbB3p7vkIPQRUTHI.html"}]}