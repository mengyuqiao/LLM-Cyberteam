{"CVE Code": "CVE-2024-32462", "Description": "Flatpak is a system for building, distributing, and running sandboxed desktop applications on Linux. in versions before 1.10.9, 1.12.9, 1.14.6, and 1.15.8, a malicious or compromised Flatpak app could execute arbitrary code outside its sandbox. Normally, the `--command` argument of `flatpak run` expects to be given a command to run in the specified Flatpak app, optionally along with some arguments. However it is possible to instead pass `bwrap` arguments to `--command=`, such as `--bind`. It's possible to pass an arbitrary `commandline` to the portal interface `org.freedesktop.portal.Background.RequestBackground` from within a Flatpak app. When this is converted into a `--command` and arguments, it achieves the same effect of passing arguments directly to `bwrap`, and thus can be used for a sandbox escape. The solution is to pass the `--` argument to `bwrap`, which makes it stop processing options. This has been supported since bubblewrap 0.3.0. All supported versions of Flatpak require at least that version of bubblewrap. xdg-desktop-portal version 1.18.4 will mitigate this vulnerability by only allowing Flatpak apps to create .desktop files for commands that do not start with --. The vulnerability is patched in 1.15.8, 1.10.9, 1.12.9, and 1.14.6.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-32462", "Vulnerability Categories": "Execute code", "Affected Products": "N/A", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 13 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "8.4", "CWE": [{"CWE_ID": "CWE-88 Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')", "CWE_link": "/cwe-details/88/Improper-Neutralization-of-Argument-Delimiters-in-a-Command-.html"}], "Reference": [{"ref_link": "https://github.com/flatpak/flatpak/security/advisories/GHSA-phv6-cpc2-2fgj", "ref_desc": "CVE-2024-32462: Sandbox escape via RequestBackground portal and CWE-88 \u00b7 Advisory \u00b7 flatpak/flatpak \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/flatpak/flatpak/commit/bbab7ed1e672356d1a78b422462b210e8e875931", "ref_desc": "When starting non-static command using bwrap use \"--\" \u00b7 flatpak/flatpak@bbab7ed \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZFNSCFJVMAQK5AF55JBN7OSJP3CREDBD/", "ref_desc": "[SECURITY] Fedora 40 Update: flatpak-1.15.8-1.fc40 - package-announce - Fedora Mailing-Lists", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/flatpak/flatpak/commit/b7c1a558e58aaeb1d007d29529bbb270dc4ff11e", "ref_desc": "When starting non-static command using bwrap use \"--\" \u00b7 flatpak/flatpak@b7c1a55 \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/IB6VQAF5S2YOBULDHPUKPOEIKONOP5KO/", "ref_desc": "[SECURITY] Fedora 39 Update: flatpak-1.15.8-1.fc39 - package-announce - Fedora Mailing-Lists", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/flatpak/flatpak/commit/81abe2a37d363f5099c3d0bdcd0caad6efc5bf97", "ref_desc": "When starting non-static command using bwrap use \"--\" \u00b7 flatpak/flatpak@81abe2a \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "http://www.openwall.com/lists/oss-security/2024/04/18/5", "ref_desc": "oss-security - flatpak CVE-2024-32462 : Sandbox escape via RequestBackground portal and CWE-88", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/flatpak/flatpak/commit/72016e3fce8fcbeab707daf4f1a02b931fcc004d", "ref_desc": "When starting non-static command using bwrap use \"--\" \u00b7 flatpak/flatpak@72016e3 \u00b7 GitHub", "ref_cve_link": "N/A"}]}