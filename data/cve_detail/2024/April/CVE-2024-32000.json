{"CVE Code": "CVE-2024-32000", "Description": "matrix-appservice-irc is a Node.js IRC bridge for the Matrix messaging protocol. matrix-appservice-irc before version 2.0.0 can be exploited to leak the truncated body of a message if a malicious user sends a Matrix reply to an event ID they don't have access to. As a precondition to the attack, the malicious user needs to know the event ID of the message they want to leak, as well as to be joined to both the Matrix room and the IRC channel it is bridged to. The message reply containing the leaked message content is visible to IRC channel members when this happens. matrix-appservice-irc 2.0.0 checks whether the user has permission to view an event before constructing a reply. Administrators should upgrade to this version. It's possible to limit the amount of information leaked by setting a reply template that doesn't contain the original message. See these lines `601-604` in the configuration file linked.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-32000", "Vulnerability Categories": "N/A", "Affected Products": "N/A", "EPSS Score": "0.05% Probability of exploitation activity in the next 30 days\n~ 14 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "4.3", "CWE": [{"CWE_ID": "CWE-280 Improper Handling of Insufficient Permissions or Privileges", "CWE_link": "/cwe-details/280/Improper-Handling-of-Insufficient-Permissions-or-Privileges-.html"}, {"CWE_ID": "CWE-755 Improper Handling of Exceptional Conditions", "CWE_link": "/cwe-details/755/Improper-Handling-of-Exceptional-Conditions.html"}], "Reference": [{"ref_link": "https://github.com/matrix-org/matrix-appservice-irc/blob/d5d67d1d3ea3f0f6962a0af2cc57b56af3ad2129/config.sample.yaml#L601-L604", "ref_desc": "matrix-appservice-irc/config.sample.yaml at d5d67d1d3ea3f0f6962a0af2cc57b56af3ad2129 \u00b7 matrix-org/matrix-appservice-irc \u00b7 GitHubCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/CtqaZFVeVvkxz2PLkSRz38GhwGA.html"}, {"ref_link": "https://github.com/matrix-org/matrix-appservice-irc/pull/1799", "ref_desc": "Add tests for various forms of rich replies by tadzik \u00b7 Pull Request #1799 \u00b7 matrix-org/matrix-appservice-irc \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/matrix-org/matrix-appservice-irc/security/advisories/GHSA-wm4w-7h2q-3pf7", "ref_desc": "Leak of truncated content of messages a user shouldn't have access to \u00b7 Advisory \u00b7 matrix-org/matrix-appservice-irc \u00b7 GitHub", "ref_cve_link": "N/A"}]}