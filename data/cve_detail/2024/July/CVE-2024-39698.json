{"CVE Code": "CVE-2024-39698", "Description": "electron-updater allows for automatic updates for Electron apps. The file `packages/electron-updater/src/windowsExecutableCodeSignatureVerifier.ts` implements the signature validation routine for Electron applications on Windows. Because of the surrounding shell, a first pass by `cmd.exe` expands any environment variable found in command-line above. This creates a situation where `verifySignature()` can be tricked into validating the certificate of a different file than the one that was just downloaded. If the step is successful, the malicious update will be executed even if its signature is invalid. This attack assumes a compromised update manifest (server compromise, Man-in-the-Middle attack if fetched over HTTP, Cross-Site Scripting to point the application to a malicious updater server, etc.). The patch is available starting from 6.3.0-alpha.6.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-39698", "Vulnerability Categories": "Cross site scripting (XSS)", "Affected Products": "\nElectron\u00bbElectron-builder\u00bbForNode.jsVersions  before (<) 6.3.0cpe:2.3:a:electron:electron-builder:*:*:*:*:*:node.js:*:*Matching versions\nElectron\u00bbElectron-builder\u00bbVersion:6.3.0UpdateAlpha0ForNode.jscpe:2.3:a:electron:electron-builder:6.3.0:alpha0:*:*:*:node.js:*:*Matching versions\nElectron\u00bbElectron-builder\u00bbVersion:6.3.0UpdateAlpha1ForNode.jscpe:2.3:a:electron:electron-builder:6.3.0:alpha1:*:*:*:node.js:*:*Matching versions\nElectron\u00bbElectron-builder\u00bbVersion:6.3.0UpdateAlpha2ForNode.jscpe:2.3:a:electron:electron-builder:6.3.0:alpha2:*:*:*:node.js:*:*Matching versions\nElectron\u00bbElectron-builder\u00bbVersion:6.3.0UpdateAlpha3ForNode.jscpe:2.3:a:electron:electron-builder:6.3.0:alpha3:*:*:*:node.js:*:*Matching versions\nElectron\u00bbElectron-builder\u00bbVersion:6.3.0UpdateAlpha4ForNode.jscpe:2.3:a:electron:electron-builder:6.3.0:alpha4:*:*:*:node.js:*:*Matching versions\nElectron\u00bbElectron-builder\u00bbVersion:6.3.0UpdateAlpha5ForNode.jscpe:2.3:a:electron:electron-builder:6.3.0:alpha5:*:*:*:node.js:*:*Matching versions\nElectron.build\u00bbElectron-updaterVersions  before (<) 6.3.0-alpha.6cpe:2.3:a:electron.build:electron-updater:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.06% Probability of exploitation activity in the next 30 days\n~ 27 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-07-13  0.05%  0.06%  +0.02 ", "CVSS Scores": "7.5", "CWE": [{"CWE_ID": "CWE-154 Improper Neutralization of Variable Name Delimiters", "CWE_link": "/cwe-details/154/Improper-Neutralization-of-Variable-Name-Delimiters.html"}, {"CWE_ID": "CWE-295 Improper Certificate Validation", "CWE_link": "/cwe-details/295/Improper-Certificate-Validation.html"}], "Reference": [{"ref_link": "https://github.com/electron-userland/electron-builder/commit/ac2e6a25aa491c1ef5167a552c19fc2085cd427f", "ref_desc": "fix: verify LiteralPath of update file during windows signature verif\u2026 \u00b7 electron-userland/electron-builder@ac2e6a2 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/electron-userland/electron-builder/pull/8295", "ref_desc": "fix: verify LiteralPath of update file during windows signature verification by mmaietta \u00b7 Pull Request #8295 \u00b7 electron-userland/electron-builder \u00b7 GitHubIssue Tracking;Patch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/electron-userland/electron-builder/blob/140e2f0eb0df79c2a46e35024e96d0563355fc89/packages/electron-updater/src/windowsExecutableCodeSignatureVerifier.ts#L35-L41", "ref_desc": "electron-builder/packages/electron-updater/src/windowsExecutableCodeSignatureVerifier.ts at 140e2f0eb0df79c2a46e35024e96d0563355fc89 \u00b7 electron-userland/electron-builder \u00b7 GitHubProduct", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/electron-userland/electron-builder/security/advisories/GHSA-9jxc-qjr9-vjxq", "ref_desc": "Code Signing Bypass on Windows in electron-updater < 6.3.0-alpha.6 \u00b7 Advisory \u00b7 electron-userland/electron-builder \u00b7 GitHubExploit;Vendor Advisory", "ref_cve_link": "N/A"}]}