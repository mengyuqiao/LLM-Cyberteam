{"CVE Code": "CVE-2024-40647", "Description": "sentry-sdk is the official Python SDK for Sentry.io. A bug in Sentry's Python SDK < 2.8.0 allows the environment variables to be passed to subprocesses despite the `env={}` setting. In Python's `subprocess` calls, all environment variables are passed to subprocesses by default. However, if you specifically do not want them to be passed to subprocesses, you may use `env` argument in `subprocess` calls. Due to the bug in Sentry SDK, with the Stdlib integration enabled (which is enabled by default), this expectation is not fulfilled, and all environment variables are being passed to subprocesses instead. The issue has been patched in pull request #3251 and is included in sentry-sdk==2.8.0. We strongly recommend upgrading to the latest SDK version. However, if it's not possible, and if passing environment variables to child processes poses a security risk for you, you can disable all default integrations.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-40647", "Vulnerability Categories": "N/A", "Affected Products": "N/A", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 11 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "5.3", "CWE": [{"CWE_ID": "CWE-200 Exposure of Sensitive Information to an Unauthorized Actor", "CWE_link": "/cwe-details/200/Exposure-of-Sensitive-Information-to-an-Unauthorized-Actor.html"}], "Reference": [{"ref_link": "https://docs.sentry.io/platforms/python/integrations/default-integrations/#stdlib", "ref_desc": "Default Integrations | Sentry for Python", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/getsentry/sentry-python/security/advisories/GHSA-g92j-qhmh-64v2", "ref_desc": "Unintentional exposure of environment variables to subprocesses \u00b7 Advisory \u00b7 getsentry/sentry-python \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://docs.sentry.io/platforms/python/integrations/default-integrations", "ref_desc": "Default Integrations | Sentry for Python", "ref_cve_link": "N/A"}, {"ref_link": "https://docs.python.org/3/library/subprocess.html", "ref_desc": "subprocess \u2014 Subprocess management \u2014 Python 3.12.4 documentation", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/getsentry/sentry-python/commit/763e40aa4cb57ecced467f48f78f335c87e9bdff", "ref_desc": "fix(integrations): don't send full env to subprocess (#3251) \u00b7 getsentry/sentry-python@763e40a \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/getsentry/sentry-python/releases/tag/2.8.0", "ref_desc": "Release 2.8.0 \u00b7 getsentry/sentry-python \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/getsentry/sentry-python/pull/3251", "ref_desc": "fix(integrations): don't send full env to subprocess by sentrivana \u00b7 Pull Request #3251 \u00b7 getsentry/sentry-python \u00b7 GitHub", "ref_cve_link": "N/A"}]}