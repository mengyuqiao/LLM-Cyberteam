{"CVE Code": "CVE-2024-39897", "Description": "zot is an OCI image registry. Prior to 2.1.0, the cache driver `GetBlob()` allows read access to any blob without access control check. If a Zot `accessControl` policy allows users read access to some repositories but restricts read access to other repositories and `dedupe` is enabled (it is enabled by default), then an attacker who knows the name of an image and the digest of a blob (that they do not have read access to), they may maliciously read it via a second repository they do have read access to. \n This attack is possible because [`ImageStore.CheckBlob()` calls `checkCacheBlob()`](https://github.com/project-zot/zot/blob/v2.1.0-rc2/pkg/storage/imagestore/imagestore.go#L1158-L1159) to find the blob a global cache by searching for the digest. If it is found, it is copied to the user requested repository with `copyBlob()`. The attack may be mitigated by configuring \"dedupe\": false in the \"storage\" settings. The vulnerability is fixed in 2.1.0.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-39897", "Vulnerability Categories": "N/A", "Affected Products": "N/A", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 9 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "4.3", "CWE": [{"CWE_ID": "CWE-639 Authorization Bypass Through User-Controlled Key", "CWE_link": "/cwe-details/639/Authorization-Bypass-Through-User-Controlled-Key.html"}], "Reference": [{"ref_link": "https://github.com/project-zot/zot/security/advisories/GHSA-55r9-5mx9-qq7r", "ref_desc": "Cache driver GetBlob() allows read access to any blob without access control check \u00b7 Advisory \u00b7 project-zot/zot \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/project-zot/zot/commit/aaee0220e46bdadd12115ac67c19f9d3153eb1df", "ref_desc": "Merge pull request from GHSA-55r9-5mx9-qq7r \u00b7 project-zot/zot@aaee022 \u00b7 GitHub", "ref_cve_link": "N/A"}]}