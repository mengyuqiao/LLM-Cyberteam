{"CVE Code": "CVE-2024-39503", "Description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: ipset: Fix race between namespace cleanup and gc in the list:set type\n\nLion Ackermann reported that there is a race condition between namespace cleanup\nin ipset and the garbage collection of the list:set type. The namespace\ncleanup can destroy the list:set type of sets while the gc of the set type is\nwaiting to run in rcu cleanup. The latter uses data from the destroyed set which\nthus leads use after free. The patch contains the following parts:\n\n- When destroying all sets, first remove the garbage collectors, then wait\n  if needed and then destroy the sets.\n- Fix the badly ordered \"wait then remove gc\" for the destroy a single set\n  case.\n- Fix the missing rcu locking in the list:set type in the userspace test\n  case.\n- Use proper RCU list handlings in the list:set type.\n\nThe patch depends on c1193d9bbbd3 (netfilter: ipset: Add list flush to cancel_gc).", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-39503", "Vulnerability Categories": "Memory Corruption", "Affected Products": "N/A", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 11 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "N/A", "CWE": [], "Reference": [{"ref_link": "https://git.kernel.org/stable/c/c0761d1f1ce1d5b85b5e82bbb714df12de1aa8c3", "ref_desc": "netfilter: ipset: Fix race between namespace cleanup and gc in the list:set type - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/0f1bb77c6d837c9513943bc7c08f04c5cc5c6568", "ref_desc": "netfilter: ipset: Fix race between namespace cleanup and gc in the list:set type - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/2ba35b37f780c6410bb4bba9c3072596d8576702", "ref_desc": "netfilter: ipset: Fix race between namespace cleanup and gc in the list:set type - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/90ae20d47de602198eb69e6cd7a3db3420abfc08", "ref_desc": "netfilter: ipset: Fix race between namespace cleanup and gc in the list:set type - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/4e7aaa6b82d63e8ddcbfb56b4fd3d014ca586f10", "ref_desc": "netfilter: ipset: Fix race between namespace cleanup and gc in the list:set type - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/93b53c202b51a69e42ca57f5a183f7e008e19f83", "ref_desc": "netfilter: ipset: Fix race between namespace cleanup and gc in the list:set type - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/390b353d1a1da3e9c6c0fd14fe650d69063c95d6", "ref_desc": "netfilter: ipset: Fix race between namespace cleanup and gc in the list:set type - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}]}