{"CVE Code": "CVE-2024-41078", "Description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbtrfs: qgroup: fix quota root leak after quota disable failure\n\nIf during the quota disable we fail when cleaning the quota tree or when\ndeleting the root from the root tree, we jump to the 'out' label without\never dropping the reference on the quota root, resulting in a leak of the\nroot since fs_info->quota_root is no longer pointing to the root (we have\nset it to NULL just before those steps).\n\nFix this by always doing a btrfs_put_root() call under the 'out' label.\nThis is a problem that exists since qgroups were first added in 2012 by\ncommit bed92eae26cc (\"Btrfs: qgroup implementation and prototypes\"), but\nback then we missed a kfree on the quota root and free_extent_buffer()\ncalls on its root and commit root nodes, since back then roots were not\nyet reference counted.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-41078", "Vulnerability Categories": "N/A", "Affected Products": "N/A", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 11 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "N/A", "CWE": [], "Reference": [{"ref_link": "https://git.kernel.org/stable/c/7dd6a5b96157a21245566b21fd58276a214357ff", "ref_desc": "btrfs: qgroup: fix quota root leak after quota disable failure - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/94818bdb00ef34a996a06aa63d11f591074cb757", "ref_desc": "btrfs: qgroup: fix quota root leak after quota disable failure - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/f88aeff5a173e8ba3133314eb4b964236ef3589d", "ref_desc": "btrfs: qgroup: fix quota root leak after quota disable failure - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/5ef3961682e5310f2221bae99bcf9f5d0f4b0d51", "ref_desc": "btrfs: qgroup: fix quota root leak after quota disable failure - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/a7e4c6a3031c74078dba7fa36239d0f4fe476c53", "ref_desc": "btrfs: qgroup: fix quota root leak after quota disable failure - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/stable/c/8a69529f22590b67bb018de9acbcf94abc8603cf", "ref_desc": "btrfs: qgroup: fix quota root leak after quota disable failure - kernel/git/stable/linux.git - Linux kernel stable tree", "ref_cve_link": "N/A"}]}