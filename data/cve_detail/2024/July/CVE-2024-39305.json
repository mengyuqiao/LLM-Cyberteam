{"CVE Code": "CVE-2024-39305", "Description": "Envoy is a cloud-native, open source edge and service proxy. Prior to versions 1.30.4, 1.29.7, 1.28.5, and 1.27.7. Envoy references already freed memory when route hash policy is configured with cookie attributes. Note that this vulnerability has been fixed in the open as the effect would be immediately apparent if it was configured. Memory allocated for holding attribute values is freed after configuration was parsed. During request processing Envoy will attempt to copy content of de-allocated memory into request cookie header. This can lead to arbitrary content of Envoy's memory to be sent to the upstream service or abnormal process termination. This vulnerability is fixed in Envoy versions v1.30.4, v1.29.7, v1.28.5, and v1.27.7. As a workaround, do not use cookie attributes in route action hash policy.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-39305", "Vulnerability Categories": "N/A", "Affected Products": "N/A", "EPSS Score": "0.05% Probability of exploitation activity in the next 30 days\n~ 16 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "6.5", "CWE": [{"CWE_ID": "CWE-416 Use After Free", "CWE_link": "/cwe-details/416/Use-After-Free.html"}], "Reference": [{"ref_link": "https://github.com/envoyproxy/envoy/commit/02a06681fbe0e039b1c7a9215257a7537eddb518", "ref_desc": "http: fix cookie attributes (#34885) \u00b7 envoyproxy/envoy@02a0668 \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/envoyproxy/envoy/commit/50b384cb203a1f2894324cbae64b6d9bc44cce45", "ref_desc": "http: fix cookie attributes (#34885) \u00b7 envoyproxy/envoy@50b384c \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-fp35-g349-h66f", "ref_desc": "Use after free when route hash policy is configured with cookie attributes \u00b7 Advisory \u00b7 envoyproxy/envoy \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/envoyproxy/envoy/commit/99b6e525fb9f6f6f19a0425f779bc776f121c7e5", "ref_desc": "http: fix cookie attributes (#34885) \u00b7 envoyproxy/envoy@99b6e52 \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/envoyproxy/envoy/commit/b7f509607ad860fd6a63cde4f7d6f0197f9f63bb", "ref_desc": "http: fix cookie attributes (#34885) \u00b7 envoyproxy/envoy@b7f5096 \u00b7 GitHub", "ref_cve_link": "N/A"}]}