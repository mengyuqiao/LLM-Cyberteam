{"CVE Code": "CVE-2024-40627", "Description": "Fastapi OPA is an opensource fastapi middleware which includes auth flow. HTTP `OPTIONS` requests are always allowed by `OpaMiddleware`, even when they lack authentication, and are passed through directly to the application. `OpaMiddleware` allows all HTTP `OPTIONS` requests without evaluating it against any policy. If an application provides different responses to HTTP `OPTIONS` requests based on an entity existing (such as to indicate whether an entity is writable on a system level), an unauthenticated attacker could discover which entities exist within an application. This issue has been addressed in release version 2.0.1. All users are advised to upgrade. There are no known workarounds for this vulnerability.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-40627", "Vulnerability Categories": "N/A", "Affected Products": "N/A", "EPSS Score": "0.05% Probability of exploitation activity in the next 30 days\n~ 16 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "5.8", "CWE": [{"CWE_ID": "CWE-204 Observable Response Discrepancy", "CWE_link": "/cwe-details/204/Observable-Response-Discrepancy.html"}], "Reference": [{"ref_link": "https://github.com/busykoala/fastapi-opa/security/advisories/GHSA-5f5c-8rvc-j8wf", "ref_desc": "OpaMiddleware does not filter HTTP OPTIONS requests \u00b7 Advisory \u00b7 busykoala/fastapi-opa \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/busykoala/fastapi-opa/commit/9588109ff651f7ffc92687129c4956126443fb8c", "ref_desc": "Merge pull request #73 from busykoala/options_auth \u00b7 busykoala/fastapi-opa@9588109 \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/busykoala/fastapi-opa/blob/6dd6f8c87e908fe080784a74707f016f1422b58a/fastapi_opa/opa/opa_middleware.py#L79-L80", "ref_desc": "fastapi-opa/fastapi_opa/opa/opa_middleware.py at 6dd6f8c87e908fe080784a74707f016f1422b58a \u00b7 busykoala/fastapi-opa \u00b7 GitHub", "ref_cve_link": "N/A"}]}