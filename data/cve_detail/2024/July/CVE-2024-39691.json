{"CVE Code": "CVE-2024-39691", "Description": "matrix-appservice-irc is a Node.js IRC bridge for the Matrix messaging protocol. The fix for GHSA-wm4w-7h2q-3pf7 / CVE-2024-32000 included in matrix-appservice-irc 2.0.0 relied on the Matrix homeserver-provided timestamp to determine whether a user has access to the event they're replying to when determining whether or not to include a truncated version of the original event in the IRC message. Since this value is controlled by external entities, a malicious Matrix homeserver joined to a room in which a matrix-appservice-irc bridge instance (before version 2.0.1) is present can fabricate the timestamp with the intent of tricking the bridge into leaking room messages the homeserver should not have access to. matrix-appservice-irc 2.0.1 drops the reliance on `origin_server_ts` when determining whether or not an event should be visible to a user, instead tracking the event timestamps internally. As a workaround, it's possible to limit the amount of information leaked by setting a reply template that doesn't contain the original message.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-39691", "Vulnerability Categories": "N/A", "Affected Products": "N/A", "EPSS Score": "0.05% Probability of exploitation activity in the next 30 days\n~ 16 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "4.3", "CWE": [{"CWE_ID": "CWE-280 Improper Handling of Insufficient Permissions or Privileges", "CWE_link": "/cwe-details/280/Improper-Handling-of-Insufficient-Permissions-or-Privileges-.html"}, {"CWE_ID": "CWE-755 Improper Handling of Exceptional Conditions", "CWE_link": "/cwe-details/755/Improper-Handling-of-Exceptional-Conditions.html"}], "Reference": [{"ref_link": "https://github.com/matrix-org/matrix-appservice-irc/blob/d5d67d1d3ea3f0f6962a0af2cc57b56af3ad2129/config.sample.yaml#L601-L604", "ref_desc": "matrix-appservice-irc/config.sample.yaml at d5d67d1d3ea3f0f6962a0af2cc57b56af3ad2129 \u00b7 matrix-org/matrix-appservice-irc \u00b7 GitHubCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/CtqaZFVeVvkxz2PLkSRz38GhwGA.html"}, {"ref_link": "https://github.com/matrix-org/matrix-appservice-irc/pull/1804", "ref_desc": "Don't use origin_server_ts when tracking joins, use bridge-time instead by tadzik \u00b7 Pull Request #1804 \u00b7 matrix-org/matrix-appservice-irc \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/matrix-org/matrix-appservice-irc/security/advisories/GHSA-w9mh-5x8j-9754", "ref_desc": "Malicious Matrix homeserver can leak truncated message content of messages it shouldn't have access to \u00b7 Advisory \u00b7 matrix-org/matrix-appservice-irc \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/matrix-org/matrix-appservice-irc/commit/1835e047f269001054be4c68867797aa12372a0f", "ref_desc": "Don't use origin_server_ts when tracking joins, use bridge-time inste\u2026 \u00b7 matrix-org/matrix-appservice-irc@1835e04 \u00b7 GitHub", "ref_cve_link": "N/A"}]}