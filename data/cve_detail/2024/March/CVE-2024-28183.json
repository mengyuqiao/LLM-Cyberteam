{"CVE Code": "CVE-2024-28183", "Description": "ESP-IDF is the development framework for Espressif SoCs supported on Windows, Linux and macOS. A Time-of-Check to Time-of-Use (TOCTOU) vulnerability was discovered in the implementation of the ESP-IDF bootloader which could allow an attacker with physical access to flash of the device to bypass anti-rollback protection. Anti-rollback prevents rollback to application with security version lower than one programmed in eFuse of chip. This attack can allow to boot past (passive) application partition having lower security version of the same device even in the presence of the flash encryption scheme. The attack requires carefully modifying the flash contents after the anti-rollback checks have been performed by the bootloader (before loading the application). The vulnerability is fixed in 4.4.7 and 5.2.1.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-28183", "Vulnerability Categories": "N/A", "Affected Products": "N/A", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 13 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "6.1", "CWE": [{"CWE_ID": "CWE-367 Time-of-check Time-of-use (TOCTOU) Race Condition", "CWE_link": "/cwe-details/367/Time-of-check-Time-of-use-TOCTOU-Race-Condition.html"}], "Reference": [{"ref_link": "https://github.com/espressif/esp-idf/commit/3305cb4d235182067936f8e940e6db174e25b4b2", "ref_desc": "fix(ota): additional checks for secure version in anti-rollback case \u00b7 espressif/esp-idf@3305cb4 \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/espressif/esp-idf/security/advisories/GHSA-22x6-3756-pfp8", "ref_desc": "Bootloader TOCTOU Vulnerability in Anti-rollback Scheme \u00b7 Advisory \u00b7 espressif/esp-idf \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/espressif/esp-idf/commit/f327ddf6adab0c28d395975785727b2feef57803", "ref_desc": "Merge branch 'bugfix/ota_anti_rollback_checks_2_v4.4' into 'release/v\u2026 \u00b7 espressif/esp-idf@f327ddf \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/espressif/esp-idf/commit/4c95aa445d4e84f01f86b6f3a552aa299276abf3", "ref_desc": "fix(ota): additional checks for secure version in anti-rollback case \u00b7 espressif/esp-idf@4c95aa4 \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/espressif/esp-idf/commit/7003f1ef0dffc73c34eb153d1b0710babb078149", "ref_desc": "Merge branch 'bugfix/ota_anti_rollback_checks_2_v5.1' into 'release/v\u2026 \u00b7 espressif/esp-idf@7003f1e \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/espressif/esp-idf/commit/534e3ad1fa68526a5f989fb2163856d6b7cd2c87", "ref_desc": "Merge branch 'bugfix/ota_anti_rollback_checks_2_v5.0' into 'release/v\u2026 \u00b7 espressif/esp-idf@534e3ad \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/espressif/esp-idf/commit/c33b9e1426121ce8cccf1a94241740be9cff68de", "ref_desc": "fix(bootloader_support): check the secure version only for app image \u00b7 espressif/esp-idf@c33b9e1 \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/espressif/esp-idf/commit/b2cdc0678965790f49afeb6e6b0737cd24433a05", "ref_desc": "fix(bootloader_support): check the secure version only for app image \u00b7 espressif/esp-idf@b2cdc06 \u00b7 GitHub", "ref_cve_link": "N/A"}]}