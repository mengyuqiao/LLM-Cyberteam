{"CVE Code": "CVE-2024-27933", "Description": "Deno is a JavaScript, TypeScript, and WebAssembly runtime. In version 1.39.0, use of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors, allowing standard input to be re-opened as a different resource resulting in permission prompt bypass. Node child_process IPC relies on the JS side to pass the raw IPC file descriptor to `op_node_ipc_pipe()`, which returns a `IpcJsonStreamResource` ID associated with the file descriptor. On closing the resource, the raw file descriptor is closed together.\n\nUse of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors. This allow standard input (fd 0) to be closed and re-opened for a different resource, which allows a silent permission prompt bypass. This is exploitable by an attacker controlling the code executed inside a Deno runtime to obtain arbitrary code execution on the host machine regardless of permissions.\n\nThis bug is known to be exploitable. There is a working exploit that achieves arbitrary code execution by bypassing prompts from zero permissions, additionally abusing the fact that Cache API lacks filesystem permission checks. The attack can be conducted silently as stderr can also be closed, suppressing all prompt outputs.\n\nVersion 1.39.1 fixes the bug.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-27933", "Vulnerability Categories": "N/A", "Affected Products": "N/A", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 11 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "8.2", "CWE": [{"CWE_ID": "CWE-863 Incorrect Authorization", "CWE_link": "/cwe-details/863/Incorrect-Authorization.html"}], "Reference": [{"ref_link": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L265", "ref_desc": "deno/runtime/permissions/prompter.rs at v1.39.0 \u00b7 denoland/deno \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L241", "ref_desc": "deno/runtime/permissions/prompter.rs at v1.39.0 \u00b7 denoland/deno \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/denoland/deno/commit/5a91a065b882215dde209baf626247e54c21a392", "ref_desc": "fix: implement child_process IPC (#21490) \u00b7 denoland/deno@5a91a06 \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L256", "ref_desc": "deno/runtime/permissions/prompter.rs at v1.39.0 \u00b7 denoland/deno \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L220", "ref_desc": "deno/runtime/permissions/prompter.rs at v1.39.0 \u00b7 denoland/deno \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/denoland/deno/commit/55fac9f5ead6d30996400e8597c969b675c5a22b", "ref_desc": "fix(node): child_process IPC on Windows (#21597) \u00b7 denoland/deno@55fac9f \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/denoland/deno/security/advisories/GHSA-6q4w-9x56-rmwq", "ref_desc": "Arbitrary file descriptor close via `op_node_ipc_pipe()` leading to permission prompt bypass \u00b7 Advisory \u00b7 denoland/deno \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L99", "ref_desc": "deno/runtime/permissions/prompter.rs at v1.39.0 \u00b7 denoland/deno \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L214", "ref_desc": "deno/runtime/permissions/prompter.rs at v1.39.0 \u00b7 denoland/deno \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L225", "ref_desc": "deno/runtime/permissions/prompter.rs at v1.39.0 \u00b7 denoland/deno \u00b7 GitHub", "ref_cve_link": "N/A"}]}