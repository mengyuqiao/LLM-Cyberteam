{"CVE Code": "CVE-2024-27287", "Description": "ESPHome is a system to control your ESP8266/ESP32 for Home Automation systems. Starting in version 2023.12.9 and prior to version 2024.2.2, editing the configuration file API in dashboard component of ESPHome version 2023.12.9 (command line installation and Home Assistant add-on) serves unsanitized data with `Content-Type: text/html; charset=UTF-8`, allowing a remote authenticated user to inject arbitrary web script and exfiltrate session cookies via Cross-Site scripting. It is possible for a malicious authenticated user to inject arbitrary Javascript in configuration files using a POST request to the /edit endpoint, the configuration parameter allows to specify the file to write. To trigger the XSS vulnerability, the victim must visit the page` /edit?configuration=[xss file]`. Abusing this vulnerability a malicious actor could perform operations on the dashboard on the behalf of a logged user, access sensitive information, create, edit and delete configuration files and flash firmware on managed boards.\nIn addition to this, cookies are not correctly secured, allowing the exfiltration of session cookie values. Version 2024.2.2 contains a patch for this issue.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-27287", "Vulnerability Categories": "Cross site scripting (XSS)", "Affected Products": "N/A", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 7 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "6.5", "CWE": [{"CWE_ID": "CWE-79 Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "CWE_link": "/cwe-details/79/Improper-Neutralization-of-Input-During-Web-Page-Generation-.html"}], "Reference": [{"ref_link": "https://github.com/esphome/esphome/security/advisories/GHSA-9p43-hj5j-96h5", "ref_desc": "Stored XSS in edit configuration file API \u00b7 Advisory \u00b7 esphome/esphome \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/esphome/esphome/commit/37d2b3c7977a4ccbec59726ca7549cb776661455", "ref_desc": "Merge pull request from GHSA-9p43-hj5j-96h5 \u00b7 esphome/esphome@37d2b3c \u00b7 GitHub", "ref_cve_link": "N/A"}]}