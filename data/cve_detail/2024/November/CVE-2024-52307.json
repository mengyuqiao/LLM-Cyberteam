{"CVE Code": "CVE-2024-52307", "Description": "authentik is an open-source identity provider. Due to the usage of a non-constant time comparison for the /-/metrics/ endpoint it was possible to brute-force the SECRET_KEY, which is used to authenticate the endpoint. The /-/metrics/ endpoint returns Prometheus metrics and is not intended to be accessed directly, as the Go proxy running in the authentik server container fetches data from this endpoint and serves it on a separate port (9300 by default), which can be scraped by Prometheus without being exposed publicly. authentik 2024.8.5 and 2024.10.3 fix this issue. Since the /-/metrics/ endpoint is not intended to be accessed publicly, requests to the endpoint can be blocked by the reverse proxy/load balancer used in conjunction with authentik.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-52307", "Vulnerability Categories": "N/A", "Affected Products": "N/A", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 10 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "6.3", "CWE": [{"CWE_ID": "CWE-208 Observable Timing Discrepancy", "CWE_link": "/cwe-details/208/Observable-Timing-Discrepancy.html"}], "Reference": [{"ref_link": "https://github.com/goauthentik/authentik/commit/5ea4580884f99369f0ccfe484c04cb03a66e65b8", "ref_desc": "security: fix CVE 2024 52307 (#12115) \u00b7 goauthentik/authentik@5ea4580 \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/goauthentik/authentik/security/advisories/GHSA-2xrw-5f2x-m56j", "ref_desc": "Timing attack due to a lack of constant time comparison for metrics view \u00b7 Advisory \u00b7 goauthentik/authentik \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "http://www.openwall.com/lists/oss-security/2024/11/27/1", "ref_desc": "oss-security - authentik: remote timing attack in MetricsView HTTP Basic Auth (CVE-2024-52307)", "ref_cve_link": "N/A"}]}