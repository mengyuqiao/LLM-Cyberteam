{"CVE Code": "CVE-2024-52595", "Description": "lxml_html_clean is a project for HTML cleaning functionalities copied from `lxml.html.clean`. Prior to version 0.4.0, the HTML Parser in lxml does not properly handle context-switching for special HTML tags such as `<svg>`, `<math>` and `<noscript>`. This behavior deviates from how web browsers parse and interpret such tags. Specifically, content in CSS comments is ignored by lxml_html_clean but may be interpreted differently by web browsers, enabling malicious scripts to bypass the cleaning process. This vulnerability could lead to Cross-Site Scripting (XSS) attacks, compromising the security of users relying on lxml_html_clean in default configuration for sanitizing untrusted HTML content. Users employing the HTML cleaner in a security-sensitive context should upgrade to lxml 0.4.0, which addresses this issue. As a temporary mitigation, users can configure lxml_html_clean with the following settings to prevent the exploitation of this vulnerability. Via `remove_tags`, one may specify tags to remove - their content is moved to their parents' tags. Via `kill_tags`, one may specify tags to be removed completely. Via `allow_tags`, one may restrict the set of permissible tags, excluding context-switching tags like `<svg>`, `<math>` and `<noscript>`.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-52595", "Vulnerability Categories": "Cross site scripting (XSS)", "Affected Products": "\nFedoralovespython\u00bbLxml Html Clean\u00bbForPythonVersions  before (<) 0.4.0cpe:2.3:a:fedoralovespython:lxml_html_clean:*:*:*:*:*:python:*:*Matching versions", "EPSS Score": "0.06% Probability of exploitation activity in the next 30 days\n~ 29 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.05%  0.06%  +0.02 ", "CVSS Scores": "7.7", "CWE": [{"CWE_ID": "CWE-79 Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "CWE_link": "/cwe-details/79/Improper-Neutralization-of-Input-During-Web-Page-Generation-.html"}, {"CWE_ID": "CWE-83 Improper Neutralization of Script in Attributes in a Web Page", "CWE_link": "/cwe-details/83/Improper-Neutralization-of-Script-in-Attributes-in-a-Web-Pag.html"}, {"CWE_ID": "CWE-184 Incomplete List of Disallowed Inputs", "CWE_link": "/cwe-details/184/Incomplete-List-of-Disallowed-Inputs.html"}], "Reference": [{"ref_link": "https://github.com/fedora-python/lxml_html_clean/security/advisories/GHSA-5jfw-gq64-q45f", "ref_desc": "HTML Cleaner allows crafted scripts in special contexts like svg or math to pass through \u00b7 Advisory \u00b7 fedora-python/lxml_html_clean \u00b7 GitHubMitigation;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/fedora-python/lxml_html_clean/commit/c5d816f86eb3707d72a8ecf5f3823e0daa1b3808", "ref_desc": "Scan for JS code also in CSS comments \u00b7 fedora-python/lxml_html_clean@c5d816f \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/fedora-python/lxml_html_clean/pull/19", "ref_desc": "Scan for JS code also in CSS comments by frenzymadness \u00b7 Pull Request #19 \u00b7 fedora-python/lxml_html_clean \u00b7 GitHubPatch", "ref_cve_link": "N/A"}]}