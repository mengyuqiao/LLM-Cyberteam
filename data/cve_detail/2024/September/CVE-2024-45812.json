{"CVE Code": "CVE-2024-45812", "Description": "Vite a frontend build tooling framework for javascript. Affected versions of vite were discovered to contain a DOM Clobbering vulnerability when building scripts to `cjs`/`iife`/`umd` output format. The DOM Clobbering gadget in the module can lead to cross-site scripting (XSS) in web pages where scriptless attacker-controlled HTML elements (e.g., an img tag with an unsanitized name attribute) are present. DOM Clobbering is a type of code-reuse attack where the attacker first embeds a piece of non-script, seemingly benign HTML markups in the webpage (e.g. through a post or comment) and leverages the gadgets (pieces of js code) living in the existing javascript code to transform it into executable code. We have identified a DOM Clobbering vulnerability in Vite bundled scripts, particularly when the scripts dynamically import other scripts from the assets folder and the developer sets the build output format to `cjs`, `iife`, or `umd`. In such cases, Vite replaces relative paths starting with `__VITE_ASSET__` using the URL retrieved from `document.currentScript`. However, this implementation is vulnerable to a DOM Clobbering attack. The `document.currentScript` lookup can be shadowed by an attacker via the browser's named DOM tree element access mechanism. This manipulation allows an attacker to replace the intended script element with a malicious HTML element. When this happens, the src attribute of the attacker-controlled element is used as the URL for importing scripts, potentially leading to the dynamic loading of scripts from an attacker-controlled server. This vulnerability can result in cross-site scripting (XSS) attacks on websites that include Vite-bundled files (configured with an output format of `cjs`, `iife`, or `umd`) and allow users to inject certain scriptless HTML tags without properly sanitizing the name or id attributes. This issue has been patched in versions 5.4.6, 5.3.6, 5.2.14, 4.5.5, and 3.2.11. Users are advised to upgrade. There are no known workarounds for this vulnerability.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-45812", "Vulnerability Categories": "Cross site scripting (XSS)", "Affected Products": "N/A", "EPSS Score": "0.05% Probability of exploitation activity in the next 30 days\n~ 16 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "6.4", "CWE": [{"CWE_ID": "CWE-79 Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "CWE_link": "/cwe-details/79/Improper-Neutralization-of-Input-During-Web-Page-Generation-.html"}], "Reference": [{"ref_link": "https://research.securitum.com/xss-in-amp4email-dom-clobbering", "ref_desc": "XSS in GMail's AMP4Email via DOM Clobbering - research.securitum.comCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/97sCmY0gL2cfOpS34VmRgCD8MrQ.html"}, {"ref_link": "https://scnps.co/papers/sp23_domclob.pdf", "ref_desc": "CVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/CqIPCEBRRpflGCM9b14K6Cw5lqg.html"}, {"ref_link": "https://github.com/webpack/webpack/security/advisories/GHSA-4vvj-4cpr-p986", "ref_desc": "DOM Clobbering Gadget found in Webpack's AutoPublicPathRuntimeModule that leads to XSS \u00b7 Advisory \u00b7 webpack/webpack \u00b7 GitHubCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/eE_cf-di24Cqz-cLXIIQ4qjCkds.html"}, {"ref_link": "https://github.com/vitejs/vite/security/advisories/GHSA-64vr-g452-qvp3", "ref_desc": "DOM Clobbering gadget found in vite bundled scripts that leads to XSS \u00b7 Advisory \u00b7 vitejs/vite \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/vitejs/vite/commit/ade1d89660e17eedfd35652165b0c26905259fad", "ref_desc": "fix: avoid DOM Clobbering gadget in `getRelativeUrlFromDocument` (#18\u2026 \u00b7 vitejs/vite@ade1d89 \u00b7 GitHub", "ref_cve_link": "N/A"}]}