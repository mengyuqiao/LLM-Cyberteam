{"CVE Code": "CVE-2024-45809", "Description": "Envoy is a cloud-native high-performance edge/middle/service proxy. Jwt filter will lead to an Envoy crash when clear route cache with remote JWKs. In the following case: 1. remote JWKs are used, which requires async header processing; 2. clear_route_cache is enabled on the provider; 3. header operations are enabled in JWT filter, e.g. header to claims feature; 4. the routing table is configured in a way that the JWT header operations modify requests to not match any route. When these conditions are met, a crash is triggered in the upstream code due to nullptr reference conversion from route(). The root cause is the ordering of continueDecoding and clearRouteCache. This issue has been addressed in versions 1.31.2, 1.30.6, and 1.29.9. Users are advised to upgrade. There are no known workarounds for this vulnerability.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-45809", "Vulnerability Categories": "N/A", "Affected Products": "\nEnvoyproxy\u00bbEnvoyVersions  from including (>=) 1.31.0andbefore (<) 1.31.2cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*Matching versions\nEnvoyproxy\u00bbEnvoyVersions  from including (>=) 1.30.0andbefore (<) 1.30.6cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*Matching versions\nEnvoyproxy\u00bbEnvoyVersions  from including (>=) 1.29.0andbefore (<) 1.29.9cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.05% Probability of exploitation activity in the next 30 days\n~ 18 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-09-25  0.04%  0.05%  +0.00 ", "CVSS Scores": "7.5", "CWE": [{"CWE_ID": "CWE-119 Improper Restriction of Operations within the Bounds of a Memory Buffer", "CWE_link": "/cwe-details/119/Improper-Restriction-of-Operations-within-the-Bounds-of-a-Me.html"}, {"CWE_ID": "CWE-476 NULL Pointer Dereference", "CWE_link": "/cwe-details/476/NULL-Pointer-Dereference.html"}], "Reference": [{"ref_link": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-wqr5-qmq7-3qw3", "ref_desc": "JWT filter crash in the clear route cache with remote JWKs \u00b7 Advisory \u00b7 envoyproxy/envoy \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}]}