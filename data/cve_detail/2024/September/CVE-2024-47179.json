{"CVE Code": "CVE-2024-47179", "Description": "RSSHub is an RSS network. Prior to commit 64e00e7, RSSHub's `docker-test-cont.yml` workflow is vulnerable to Artifact Poisoning, which could have lead to a full repository takeover. Downstream users of RSSHub are not vulnerable to this issue, and commit 64e00e7 fixed the underlying issue and made the repository no longer vulnerable. The `docker-test-cont.yml` workflow gets triggered when the `PR - Docker build test` workflow completes successfully. It then collects some information about the Pull Request that triggered the triggering workflow and set some labels depending on the PR body and sender. If the PR also contains a `routes` markdown block, it will set the `TEST_CONTINUE` environment variable to `true`. The workflow then downloads and extracts an artifact uploaded by the triggering workflow which is expected to contain a single `rsshub.tar.zst` file. However, prior to commit 64e00e7, it did not validate and the contents were extracted in the root of the workspace overriding any existing files. Since the contents of the artifact were not validated, it is possible for a malicious actor to send a Pull Request which uploads, not just the `rsshub.tar.zst` compressed docker image, but also a malicious `package.json` file with a script to run arbitrary code in the context of the privileged workflow. As of commit 64e00e7, this scenario has been addressed and the RSSHub repository is no longer vulnerable.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-47179", "Vulnerability Categories": "N/A", "Affected Products": "N/A", "EPSS Score": "0.04% Probability of exploitation activity in the next 30 days\n~ 11 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n Could not find any EPSS score change records for this CVE ", "CVSS Scores": "8.8", "CWE": [{"CWE_ID": "CWE-20 Improper Input Validation", "CWE_link": "/cwe-details/20/Improper-Input-Validation.html"}], "Reference": [{"ref_link": "https://github.com/DIYgod/RSSHub/security/advisories/GHSA-9mqc-fm24-h8cw", "ref_desc": "RSSHub's `docker-test-cont.yml` workflow is vulnerable to Artifact Poisoning which may lead to a full repository takeover. \u00b7 Advisory \u00b7 DIYgod/RSSHub \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://securitylab.github.com/advisories/GHSL-2024-178_RSSHub", "ref_desc": "GHSL-2024-178: Possible full repository takeover for RSSHub through Artifact Poisoning - CVE-2024-47179 | GitHub Security Lab", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/DIYgod/RSSHub/commit/64e00e743aba2a239508fea97825994e3d687ecc", "ref_desc": "chore: checkout artifacts in another directory \u00b7 DIYgod/RSSHub@64e00e7 \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/DIYgod/RSSHub/actions/runs/10141104413/job/28037643579#step:1:17", "ref_desc": "PR - route test \u00b7 DIYgod/RSSHub@e08733f \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://codeql.github.com/codeql-query-help/javascript/js-actions-command-injection", "ref_desc": "Expression injection in Actions \u2014 CodeQL query help documentationCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/oRw_imAObiUfNyF1oHiav1F0J20.html"}, {"ref_link": "https://github.com/DIYgod/RSSHub/blob/e08733f94c81440d19ee6a5fd5e915e9a65395f5/.github/workflows/docker-test-cont.yml", "ref_desc": "RSSHub/.github/workflows/docker-test-cont.yml at e08733f94c81440d19ee6a5fd5e915e9a65395f5 \u00b7 DIYgod/RSSHub \u00b7 GitHub", "ref_cve_link": "N/A"}, {"ref_link": "https://securitylab.github.com/research/github-actions-preventing-pwn-requests", "ref_desc": "Keeping your GitHub Actions and workflows secure Part 1: Preventing pwn requests | GitHub Security LabCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/TBUBpzxWTKFHctId9wOW6vkYDIM.html"}, {"ref_link": "https://securitylab.github.com/research/github-actions-untrusted-input", "ref_desc": "Keeping your GitHub Actions and workflows secure Part 2: Untrusted input | GitHub Security LabCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/UrXVZFA-32qi7WCmoBNC4OciF08.html"}]}