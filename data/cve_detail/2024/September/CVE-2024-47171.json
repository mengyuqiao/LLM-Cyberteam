{"CVE Code": "CVE-2024-47171", "Description": "Agnai is an artificial-intelligence-agnostic multi-user, mult-bot roleplaying chat system. A vulnerability in versions prior to 1.0.330 permits attackers to upload image files at attacker-chosen location on the server. This issue can lead to image file uploads to unauthorized or unintended directories, including overwriting of existing images which may be used for defacement. This does not affect `agnai.chat`, installations using S3-compatible storage, or self-hosting that is not publicly exposed. Version 1.0.330 fixes this vulnerability.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2024-47171", "Vulnerability Categories": "N/A", "Affected Products": "\nAgnai\u00bbAgnaiVersions  before (<) 1.0.330cpe:2.3:a:agnai:agnai:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.05% Probability of exploitation activity in the next 30 days\n~ 22 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-10-31  0.05%  0.05%  +0.01 ", "CVSS Scores": "4.3", "CWE": [{"CWE_ID": "CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')", "CWE_link": "/cwe-details/22/Improper-Limitation-of-a-Pathname-to-a-Restricted-Directory-.html"}, {"CWE_ID": "CWE-35 Path Traversal: '.../...//'", "CWE_link": "/cwe-details/35/Path-Traversal-...-...-.html"}], "Reference": [{"ref_link": "https://github.com/agnaistic/agnai/security/advisories/GHSA-g54f-66mw-hv66", "ref_desc": "Relative Path Traversal in Image Upload \u00b7 Advisory \u00b7 agnaistic/agnai \u00b7 GitHubVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/agnaistic/agnai/blob/75abbd5b0f5e48ddecc805365cf1574d05ee1ce5/srv/api/upload.ts#L55", "ref_desc": "agnai/srv/api/upload.ts at 75abbd5b0f5e48ddecc805365cf1574d05ee1ce5 \u00b7 agnaistic/agnai \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/agnaistic/agnai/blob/75abbd5b0f5e48ddecc805365cf1574d05ee1ce5/srv/api/character.ts#L140:", "ref_desc": "agnai/srv/api/character.ts at 75abbd5b0f5e48ddecc805365cf1574d05ee1ce5 \u00b7 agnaistic/agnai \u00b7 GitHubPatch", "ref_cve_link": "N/A"}]}