{"CVE Code": "CVE-2021-32779", "Description": "Envoy is an open source L7 proxy and communication bus designed for large modern service oriented architectures. In affected versions envoy incorrectly handled a URI '#fragment' element as part of the path element. Envoy is configured with an RBAC filter for authorization or similar mechanism with an explicit case of a final \"/admin\" path element, or is using a negative assertion with final path element of \"/admin\". The client sends request to \"/app1/admin#foo\". In Envoy prior to 1.18.0, or 1.18.0+ configured with path_normalization=false. Envoy treats fragment as a suffix of the query string when present, or as a suffix of the path when query string is absent, so it evaluates the final path element as \"/admin#foo\" and mismatches with the configured \"/admin\" path element. In Envoy 1.18.0+ configured with path_normalization=true. Envoy transforms this to /app1/admin%23foo and mismatches with the configured /admin prefix. The resulting URI is sent to the next server-agent with the offending \"#foo\" fragment which violates RFC3986 or with the nonsensical \"%23foo\" text appended. A specifically constructed request with URI containing '#fragment' element delivered by an untrusted client in the presence of path based request authorization resulting in escalation of Privileges when path based request authorization extensions. Envoy versions 1.19.1, 1.18.4, 1.17.4, 1.16.5 contain fixes that removes fragment from URI path in incoming requests.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-32779", "Vulnerability Categories": "N/A", "Affected Products": "\nEnvoyproxy\u00bbEnvoyVersions  from including (>=) 1.17.0andbefore (<) 1.17.4cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*Matching versions\nEnvoyproxy\u00bbEnvoyVersions  from including (>=) 1.16.0andbefore (<) 1.16.5cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*Matching versions\nEnvoyproxy\u00bbEnvoyVersions  from including (>=) 1.18.0andbefore (<) 1.18.4cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*Matching versions\nEnvoyproxy\u00bbEnvoy\u00bbVersion:1.19.0cpe:2.3:a:envoyproxy:envoy:1.19.0:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.11% Probability of exploitation activity in the next 30 days\n~ 44 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.10%  0.11%  +0.00 \n 2  2024-05-09  0.09%  0.10%  +0.01 \n 3  2024-03-30  0.09%  0.09%  +0.00 \n 4  2023-03-17  0.09%  0.09%  +0.00 \n 5  2023-03-07  0.89%  0.09%  -0.80 ", "CVSS Scores": "7.5", "CWE": [{"CWE_ID": "CWE-551 Incorrect Behavior Order: Authorization Before Parsing and Canonicalization", "CWE_link": "/cwe-details/551/Incorrect-Behavior-Order-Authorization-Before-Parsing-and-C.html"}, {"CWE_ID": "CWE-697 Incorrect Comparison", "CWE_link": "/cwe-details/697/Incorrect-Comparison.html"}, {"CWE_ID": "CWE-863 Incorrect Authorization", "CWE_link": "/cwe-details/863/Incorrect-Authorization.html"}], "Reference": [{"ref_link": "https://www.envoyproxy.io/docs/envoy/v1.19.0/version_history/version_history", "ref_desc": "Version history \u2014 envoy tag-v1.19.0 documentationVendor AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/6ElgLISX3BA0RkKLLl01YJu8KPE.html"}, {"ref_link": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-r222-74fw-jqr9", "ref_desc": "Incorrectly handling of URI '#fragment' element as part of the path element \u00b7 Advisory \u00b7 envoyproxy/envoy \u00b7 GitHubThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/Tzb4mACuK6DfTQCmesE08MLc5zU.html"}]}