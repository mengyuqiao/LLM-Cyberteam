{"CVE Code": "CVE-2021-32804", "Description": "The npm package \"tar\" (aka node-tar) before versions 6.1.1, 5.0.6, 4.4.14, and 3.3.2 has a arbitrary File Creation/Overwrite vulnerability due to insufficient absolute path sanitization. node-tar aims to prevent extraction of absolute file paths by turning absolute paths into relative paths when the `preservePaths` flag is not set to `true`. This is achieved by stripping the absolute path root from any absolute file paths contained in a tar file. For example `/home/user/.bashrc` would turn into `home/user/.bashrc`. This logic was insufficient when file paths contained repeated path roots such as `////home/user/.bashrc`. `node-tar` would only strip a single path root from such paths. When given an absolute file path with repeating path roots, the resulting path (e.g. `///home/user/.bashrc`) would still resolve to an absolute path, thus allowing arbitrary file creation and overwrite. This issue was addressed in releases 3.2.2, 4.4.14, 5.0.6 and 6.1.1. Users may work around this vulnerability without upgrading by creating a custom `onentry` method which sanitizes the `entry.path` or a `filter` method which removes entries with absolute paths. See referenced GitHub Advisory for details. Be aware of CVE-2021-32803 which fixes a similar bug in later versions of tar.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-32804", "Vulnerability Categories": "Directory traversal", "Affected Products": "\nOracle\u00bbGraalvm\u00bbVersion:20.3.3    EnterpriseEditioncpe:2.3:a:oracle:graalvm:20.3.3:*:*:*:enterprise:*:*:*Matching versions\nOracle\u00bbGraalvm\u00bbVersion:21.2.0    EnterpriseEditioncpe:2.3:a:oracle:graalvm:21.2.0:*:*:*:enterprise:*:*:*Matching versions\nSiemens\u00bbSinec Infrastructure Network ServicesVersions  before (<) 1.0.1.1cpe:2.3:a:siemens:sinec_infrastructure_network_services:*:*:*:*:*:*:*:*Matching versions\nTar Project\u00bbTAR\u00bbForNode.jsVersions  from including (>=) 6.0.0andbefore (<) 6.1.1cpe:2.3:a:tar_project:tar:*:*:*:*:*:node.js:*:*Matching versions\nTar Project\u00bbTAR\u00bbForNode.jsVersions  before (<) 3.2.2cpe:2.3:a:tar_project:tar:*:*:*:*:*:node.js:*:*Matching versions\nTar Project\u00bbTAR\u00bbForNode.jsVersions  from including (>=) 4.0.0andbefore (<) 4.4.14cpe:2.3:a:tar_project:tar:*:*:*:*:*:node.js:*:*Matching versions\nTar Project\u00bbTAR\u00bbForNode.jsVersions  from including (>=) 5.0.0andbefore (<) 5.0.6cpe:2.3:a:tar_project:tar:*:*:*:*:*:node.js:*:*Matching versions", "EPSS Score": "0.69% Probability of exploitation activity in the next 30 days\n~ 80 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-04-18  0.86%  0.69%  -0.17 \n 2  2024-03-09  1.17%  0.86%  -0.32 \n 3  2024-02-12  1.66%  1.17%  -0.48 \n 4  2023-03-25  1.70%  1.66%  -0.04 \n 5  2023-03-11  1.72%  1.70%  -0.02 \n 6  2023-03-07  1.11%  1.72%  +0.61 ", "CVSS Scores": "5.8", "CWE": [{"CWE_ID": "CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')", "CWE_link": "/cwe-details/22/Improper-Limitation-of-a-Pathname-to-a-Restricted-Directory-.html"}], "Reference": [{"ref_link": "https://www.npmjs.com/package/tar", "ref_desc": "tar - npmProduct;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/C0J2CxjZJf8ph9ZCcfZgnA2tFsg.html"}, {"ref_link": "https://www.npmjs.com/advisories/1770", "ref_desc": "npmMitigation;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/npm/node-tar/commit/1f036ca23f64a547bdd6c79c1a44bc62e8115da4", "ref_desc": "fix: strip absolute paths more comprehensively \u00b7 npm/node-tar@1f036ca \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://www.oracle.com/security-alerts/cpuoct2021.html", "ref_desc": "Oracle Critical Patch Update Advisory - October 2021Patch;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/RWUpGy9G_gyGrISbxe-OvGRBVAM.html"}, {"ref_link": "https://github.com/npm/node-tar/security/advisories/GHSA-3jfq-g458-7qm9", "ref_desc": "Arbitrary File Creation/Overwrite due to insufficient absolute path sanitization \u00b7 Advisory \u00b7 npm/node-tar \u00b7 GitHubMitigation;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://cert-portal.siemens.com/productcert/pdf/ssa-389290.pdf", "ref_desc": "Patch;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/WZWxfkA5Nfx_T-RjFs6OqiqIM9U.html"}]}