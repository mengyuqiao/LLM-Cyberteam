{"CVE Code": "CVE-2021-32803", "Description": "The npm package \"tar\" (aka node-tar) before versions 6.1.2, 5.0.7, 4.4.15, and 3.2.3 has an arbitrary File Creation/Overwrite vulnerability via insufficient symlink protection. `node-tar` aims to guarantee that any file whose location would be modified by a symbolic link is not extracted. This is, in part, achieved by ensuring that extracted directories are not symlinks. Additionally, in order to prevent unnecessary `stat` calls to determine whether a given path is a directory, paths are cached when directories are created. This logic was insufficient when extracting tar files that contained both a directory and a symlink with the same name as the directory. This order of operations resulted in the directory being created and added to the `node-tar` directory cache. When a directory is present in the directory cache, subsequent calls to mkdir for that directory are skipped. However, this is also where `node-tar` checks for symlinks occur. By first creating a directory, and then replacing that directory with a symlink, it was thus possible to bypass `node-tar` symlink checks on directories, essentially allowing an untrusted tar file to symlink into an arbitrary location and subsequently extracting arbitrary files into that location, thus allowing arbitrary file creation and overwrite. This issue was addressed in releases 3.2.3, 4.4.15, 5.0.7 and 6.1.2.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-32803", "Vulnerability Categories": "Directory traversal", "Affected Products": "\nOracle\u00bbGraalvm\u00bbVersion:20.3.3    EnterpriseEditioncpe:2.3:a:oracle:graalvm:20.3.3:*:*:*:enterprise:*:*:*Matching versions\nOracle\u00bbGraalvm\u00bbVersion:21.2.0    EnterpriseEditioncpe:2.3:a:oracle:graalvm:21.2.0:*:*:*:enterprise:*:*:*Matching versions\nSiemens\u00bbSinec Infrastructure Network ServicesVersions  before (<) 1.0.1.1cpe:2.3:a:siemens:sinec_infrastructure_network_services:*:*:*:*:*:*:*:*Matching versions\nTar Project\u00bbTAR\u00bbForNode.jsVersions  before (<) 3.2.3cpe:2.3:a:tar_project:tar:*:*:*:*:*:node.js:*:*Matching versions\nTar Project\u00bbTAR\u00bbForNode.jsVersions  from including (>=) 5.0.0andbefore (<) 5.0.7cpe:2.3:a:tar_project:tar:*:*:*:*:*:node.js:*:*Matching versions\nTar Project\u00bbTAR\u00bbForNode.jsVersions  from including (>=) 4.0.0andbefore (<) 4.4.15cpe:2.3:a:tar_project:tar:*:*:*:*:*:node.js:*:*Matching versions\nTar Project\u00bbTAR\u00bbForNode.jsVersions  from including (>=) 6.0.0andbefore (<) 6.1.2cpe:2.3:a:tar_project:tar:*:*:*:*:*:node.js:*:*Matching versions", "EPSS Score": "0.69% Probability of exploitation activity in the next 30 days\n~ 80 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-04-18  0.62%  0.69%  +0.07 \n 2  2024-03-09  0.63%  0.62%  -0.01 \n 3  2024-02-12  0.89%  0.63%  -0.26 \n 4  2023-03-25  0.91%  0.89%  -0.02 \n 5  2023-03-11  0.92%  0.91%  -0.01 \n 6  2023-03-07  1.11%  0.92%  -0.19 ", "CVSS Scores": "5.8", "CWE": [{"CWE_ID": "CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')", "CWE_link": "/cwe-details/22/Improper-Limitation-of-a-Pathname-to-a-Restricted-Directory-.html"}, {"CWE_ID": "CWE-59 Improper Link Resolution Before File Access ('Link Following')", "CWE_link": "/cwe-details/59/Improper-Link-Resolution-Before-File-Access-Link-Following.html"}], "Reference": [{"ref_link": "https://github.com/npm/node-tar/security/advisories/GHSA-r628-mhmh-qjhw", "ref_desc": "Arbitrary File Creation/Overwrite via insufficient symlink protection due to directory cache poisoning \u00b7 Advisory \u00b7 npm/node-tar \u00b7 GitHubMitigation;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://www.npmjs.com/package/tar", "ref_desc": "tar - npmProduct;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/C0J2CxjZJf8ph9ZCcfZgnA2tFsg.html"}, {"ref_link": "https://github.com/npm/node-tar/commit/9dbdeb6df8e9dbd96fa9e84341b9d74734be6c20", "ref_desc": "Remove paths from dirCache when no longer dirs \u00b7 npm/node-tar@9dbdeb6 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://www.oracle.com/security-alerts/cpuoct2021.html", "ref_desc": "Oracle Critical Patch Update Advisory - October 2021Patch;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/RWUpGy9G_gyGrISbxe-OvGRBVAM.html"}, {"ref_link": "https://www.npmjs.com/advisories/1771", "ref_desc": "npmMitigation;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://cert-portal.siemens.com/productcert/pdf/ssa-389290.pdf", "ref_desc": "Patch;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/WZWxfkA5Nfx_T-RjFs6OqiqIM9U.html"}]}