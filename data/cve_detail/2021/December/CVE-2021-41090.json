{"CVE Code": "CVE-2021-41090", "Description": "Grafana Agent is a telemetry collector for sending metrics, logs, and trace data to the opinionated Grafana observability stack. Prior to versions 0.20.1 and 0.21.2, inline secrets defined within a metrics instance config are exposed in plaintext over two endpoints: metrics instance configs defined in the base YAML file are exposed at `/-/config` and metrics instance configs defined for the scraping service are exposed at `/agent/api/v1/configs/:key`. Inline secrets will be exposed to anyone being able to reach these endpoints. If HTTPS with client authentication is not configured, these endpoints are accessible to unauthenticated users. Secrets found in these sections are used for delivering metrics to a Prometheus Remote Write system, authenticating against a system for discovering Prometheus targets, and authenticating against a system for collecting metrics. This does not apply for non-inlined secrets, such as `*_file` based secrets. This issue is patched in Grafana Agent versions 0.20.1 and 0.21.2. A few workarounds are available. Users who cannot upgrade should use non-inline secrets where possible. Users may also desire to restrict API access to Grafana Agent with some combination of restricting the network interfaces Grafana Agent listens on through `http_listen_address` in the `server` block, configuring Grafana Agent to use HTTPS with client authentication, and/or using firewall rules to restrict external access to Grafana Agent's API.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-41090", "Vulnerability Categories": "Information leak", "Affected Products": "\nGrafana\u00bbAgentVersions  from including (>=) 0.14.0andbefore (<) 0.20.1cpe:2.3:a:grafana:agent:*:*:*:*:*:*:*:*Matching versions\nGrafana\u00bbAgentVersions  from including (>=) 0.21.0andbefore (<) 0.21.2cpe:2.3:a:grafana:agent:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.32% Probability of exploitation activity in the next 30 days\n~ 70 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.28%  0.32%  +0.04 \n 2  2024-08-23  0.26%  0.28%  +0.03 \n 3  2024-07-14  0.27%  0.26%  -0.01 \n 4  2024-06-18  0.19%  0.27%  +0.08 \n 5  2023-05-21  0.19%  0.19%  0.00 \n 6  2023-03-15  0.17%  0.19%  +0.02 \n 7  2023-03-07  1.11%  0.17%  -0.94 ", "CVSS Scores": "4.3", "CWE": [{"CWE_ID": "CWE-200 Exposure of Sensitive Information to an Unauthorized Actor", "CWE_link": "/cwe-details/200/Exposure-of-Sensitive-Information-to-an-Unauthorized-Actor.html"}, {"CWE_ID": "CWE-312 Cleartext Storage of Sensitive Information", "CWE_link": "/cwe-details/312/Cleartext-Storage-of-Sensitive-Information.html"}], "Reference": [{"ref_link": "https://github.com/grafana/agent/pull/1152", "ref_desc": "announce patch releases by rfratto \u00b7 Pull Request #1152 \u00b7 grafana/agent \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/grafana/agent/releases/tag/v0.21.2", "ref_desc": "Release v0.21.2 \u00b7 grafana/agent \u00b7 GitHubRelease Notes;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/grafana/agent/releases/tag/v0.20.1", "ref_desc": "Release v0.20.1 \u00b7 grafana/agent \u00b7 GitHubRelease Notes;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/grafana/agent/security/advisories/GHSA-9c4x-5hgq-q3wh", "ref_desc": "Inline secrets exposure \u00b7 Advisory \u00b7 grafana/agent \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://security.netapp.com/advisory/ntap-20211229-0004/", "ref_desc": "December 2021 Grafana Vulnerabilities in NetApp Products | NetApp Product SecurityThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/VVoaVWJubMO-K1LPDRcBaVPVXN0.html"}, {"ref_link": "https://github.com/grafana/agent/commit/af7fb01e31fe2d389e5f1c36b399ddc46b412b21", "ref_desc": "announce patch releases for cve-2021-41090 (#1152) \u00b7 grafana/agent@af7fb01 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}]}