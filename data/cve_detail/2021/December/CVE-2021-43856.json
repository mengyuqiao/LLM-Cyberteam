{"CVE Code": "CVE-2021-43856", "Description": "Wiki.js is a wiki app built on Node.js. Wiki.js 2.5.263 and earlier is vulnerable to stored cross-site scripting through non-image file uploads for file types that can be viewed directly inline in the browser. By creating a malicious file which can execute inline JS when viewed in the browser (e.g. XML files), a malicious Wiki.js user may stage a stored cross-site scripting attack. This allows the attacker to execute malicious JavaScript when the file is viewed directly by other users. The file must be opened directly by the user and will not trigger directly in a normal Wiki.js page. A patch in version 2.5.264 fixes this vulnerability by adding an optional (enabled by default) force download flag to all non-image file types, preventing the file from being viewed inline in the browser. As a workaround, disable file upload for all non-trusted users. --- Thanks to @Haxatron for reporting this vulnerability. Initially reported via https://huntr.dev/bounties/266bff09-00d9-43ca-a4bb-bb540642811f/", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-43856", "Vulnerability Categories": "Cross site scripting (XSS)", "Affected Products": "\nRequarks\u00bbWiki.jsVersions  before (<) 2.5.264cpe:2.3:a:requarks:wiki.js:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.06% Probability of exploitation activity in the next 30 days\n~ 29 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.06%  0.06%  +0.00 \n 2  2023-07-20  0.06%  0.06%  +0.00 \n 3  2023-03-07  0.89%  0.06%  -0.83 ", "CVSS Scores": "3.5", "CWE": [{"CWE_ID": "CWE-79 Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "CWE_link": "/cwe-details/79/Improper-Neutralization-of-Input-During-Web-Page-Generation-.html"}], "Reference": [{"ref_link": "https://github.com/Requarks/wiki/commit/79bdd4409316adf649806de3e22352297f85cee0", "ref_desc": "fix: force download of unsafe extensions \u00b7 Requarks/wiki@79bdd44 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/Requarks/wiki/releases/tag/2.5.264", "ref_desc": "Release 2.5.264 \u00b7 Requarks/wiki \u00b7 GitHubRelease Notes;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/Hs9usHZkqIU8TUjC-2cTiyHNRXo.html"}, {"ref_link": "https://github.com/Requarks/wiki/security/advisories/GHSA-rhpf-929m-7fm2", "ref_desc": "Stored XSS in non-image uploads when viewed inline in browser \u00b7 Advisory \u00b7 Requarks/wiki \u00b7 GitHubExploit;Patch;Third Party Advisory", "ref_cve_link": "N/A"}]}