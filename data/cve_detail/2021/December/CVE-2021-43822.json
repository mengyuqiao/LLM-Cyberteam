{"CVE Code": "CVE-2021-43822", "Description": "Jackalope Doctrine-DBAL is an implementation of the PHP Content Repository API (PHPCR) using a relational database to persist data. In affected versions users can provoke SQL injections if they can specify a node name or query. Upgrade to version 1.7.4 to resolve this issue. If that is not possible, you can escape all places where `$property` is used to filter `sv:name` in the class `Jackalope\\Transport\\DoctrineDBAL\\Query\\QOMWalker`: `XPath::escape($property)`. Node names and xpaths can contain `\"` or `;` according to the JCR specification. The jackalope component that translates the query object model into doctrine dbal queries does not properly escape the names and paths, so that a accordingly crafted node name can lead to an SQL injection. If queries are never done from user input, or if you validate the user input to not contain `;`, you are not affected.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-43822", "Vulnerability Categories": "Sql Injection", "Affected Products": "\nJackalope Doctrine-dbal Project\u00bbJackalope Doctrine-dbalVersions  before (<) 1.7.4cpe:2.3:a:jackalope_doctrine-dbal_project:jackalope_doctrine-dbal:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.10% Probability of exploitation activity in the next 30 days\n~ 43 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.10%  0.10%  0.00 \n 2  2023-07-06  0.09%  0.10%  +0.01 \n 3  2023-05-26  0.09%  0.09%  +0.00 \n 4  2023-03-07  0.89%  0.09%  -0.80 ", "CVSS Scores": "6.8", "CWE": [{"CWE_ID": "CWE-89 Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')", "CWE_link": "/cwe-details/89/Improper-Neutralization-of-Special-Elements-used-in-an-SQL-C.html"}], "Reference": [{"ref_link": "https://github.com/jackalope/jackalope-doctrine-dbal/commit/9d179a36d320330ddb303ea3a7c98d3a33d231db", "ref_desc": "Merge pull request from GHSA-ph98-v78f-jqrm \u00b7 jackalope/jackalope-doctrine-dbal@9d179a3 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/jackalope/jackalope-doctrine-dbal/security/advisories/GHSA-ph98-v78f-jqrm", "ref_desc": "SQL injection \u00b7 Advisory \u00b7 jackalope/jackalope-doctrine-dbal \u00b7 GitHubMitigation;Third Party Advisory", "ref_cve_link": "N/A"}]}