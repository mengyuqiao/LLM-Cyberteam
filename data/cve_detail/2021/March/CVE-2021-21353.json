{"CVE Code": "CVE-2021-21353", "Description": "Pug is an npm package which is a high-performance template engine. In pug before version 3.0.1, if a remote attacker was able to control the `pretty` option of the pug compiler, e.g. if you spread a user provided object such as the query parameters of a request into the pug template inputs, it was possible for them to achieve remote code execution on the node.js backend. This is fixed in version 3.0.1. This advisory applies to multiple pug packages including \"pug\", \"pug-code-gen\". pug-code-gen has a backported fix at version 2.0.3. This advisory is not exploitable if there is no way for un-trusted input to be passed to pug as the `pretty` option, e.g. if you compile templates in advance before applying user input to them, you do not need to upgrade.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-21353", "Vulnerability Categories": "Execute code", "Affected Products": "\nPugjs\u00bbPUG\u00bbForNode.jsVersions  before (<) 3.0.1cpe:2.3:a:pugjs:pug:*:*:*:*:*:node.js:*:*Matching versions\nPugjs\u00bbPug-code-gen\u00bbForNode.jsVersions  from including (>=) 3.0.0andbefore (<) 3.0.2cpe:2.3:a:pugjs:pug-code-gen:*:*:*:*:*:node.js:*:*Matching versions\nPugjs\u00bbPug-code-gen\u00bbForNode.jsVersions  before (<) 2.0.3cpe:2.3:a:pugjs:pug-code-gen:*:*:*:*:*:node.js:*:*Matching versions", "EPSS Score": "6.79% Probability of exploitation activity in the next 30 days\n~ 94 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  4.07%  6.79%  +2.72 \n 2  2024-03-06  2.91%  4.07%  +1.16 \n 3  2024-02-06  2.37%  2.91%  +0.55 \n 4  2023-11-16  1.88%  2.37%  +0.49 \n 5  2023-10-07  1.60%  1.88%  +0.28 \n 6  2023-05-25  1.24%  1.60%  +0.36 \n 7  2023-03-29  1.26%  1.24%  -0.02 \n 8  2023-03-07  6.73%  1.26%  -5.47 ", "CVSS Scores": "6.8", "CWE": [{"CWE_ID": "CWE-74 Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')", "CWE_link": "/cwe-details/74/Improper-Neutralization-of-Special-Elements-in-Output-Used-b.html"}], "Reference": [{"ref_link": "https://github.com/pugjs/pug/issues/3312", "ref_desc": "Code injection vulnerability in visitMixin and visitMixinBlock through \"pretty\" option \u00b7 Issue #3312 \u00b7 pugjs/pug \u00b7 GitHubExploit;Patch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://www.npmjs.com/package/pug", "ref_desc": "pug - npmProduct;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/pugjs/pug/pull/3314", "ref_desc": "fix: sanitise and escape the `pretty` option by ForbesLindesay \u00b7 Pull Request #3314 \u00b7 pugjs/pug \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/pugjs/pug/security/advisories/GHSA-p493-635q-r6gr", "ref_desc": "Remote code execution via the `pretty` option. \u00b7 Advisory \u00b7 pugjs/pug \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://www.npmjs.com/package/pug-code-gen", "ref_desc": "pug-code-gen - npmProduct;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/pugjs/pug/commit/991e78f7c4220b2f8da042877c6f0ef5a4683be0", "ref_desc": "fix: sanitise and escape the `pretty` option (#3314) \u00b7 pugjs/pug@991e78f \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/pugjs/pug/releases/tag/pug%403.0.1", "ref_desc": "Release pug@3.0.1 \u00b7 pugjs/pug \u00b7 GitHubRelease Notes;Third Party Advisory", "ref_cve_link": "N/A"}]}