{"CVE Code": "CVE-2021-21251", "Description": "OneDev is an all-in-one devops platform. In OneDev before version 4.0.3 there is a critical \"zip slip\" vulnerability. This issue may lead to arbitrary file write. The KubernetesResource REST endpoint untars user controlled data from the request body using TarUtils. TarUtils is a custom library method leveraging Apache Commons Compress. During the untar process, there are no checks in place to prevent an untarred file from traversing the file system and overriding an existing file. For a successful exploitation, the attacker requires a valid __JobToken__ which may not be possible to get without using any of the other reported vulnerabilities. But this should be considered a vulnerability in `io.onedev.commons.utils.TarUtils` since it lives in a different artifact and can affect other projects using it. This issue was addressed in 4.0.3 by validating paths in tar archive to only allow them to be in specified folder when extracted.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-21251", "Vulnerability Categories": "Directory traversal", "Affected Products": "\nOnedev Project\u00bbOnedevVersions  before (<) 4.0.3cpe:2.3:a:onedev_project:onedev:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.10% Probability of exploitation activity in the next 30 days\n~ 43 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.13%  0.10%  -0.03 \n 2  2023-07-14  0.09%  0.13%  +0.04 \n 3  2023-03-07  0.89%  0.09%  -0.80 ", "CVSS Scores": "6.5", "CWE": [{"CWE_ID": "CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')", "CWE_link": "/cwe-details/22/Improper-Limitation-of-a-Pathname-to-a-Restricted-Directory-.html"}], "Reference": [{"ref_link": "https://github.com/theonedev/onedev/security/advisories/GHSA-2w6j-wc8c-9mq2", "ref_desc": "ZipSlip Arbitrary File Upload \u00b7 Advisory \u00b7 theonedev/onedev \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}]}