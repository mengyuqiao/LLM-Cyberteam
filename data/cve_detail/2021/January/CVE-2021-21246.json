{"CVE Code": "CVE-2021-21246", "Description": "OneDev is an all-in-one devops platform. In OneDev before version 4.0.3, the REST UserResource endpoint performs a security check to make sure that only administrators can list user details. However for the `/users/{id}` endpoint there are no security checks enforced so it is possible to retrieve arbitrary user details including their Access Tokens! These access tokens can be used to access the API or clone code in the build spec via the HTTP(S) protocol. It has permissions to all projects accessible by the user account. This issue may lead to `Sensitive data leak` and leak the Access Token which can be used to impersonate the administrator or any other users. This issue was addressed in 4.0.3 by removing user info from restful api.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-21246", "Vulnerability Categories": "N/A", "Affected Products": "\nOnedev Project\u00bbOnedevVersions  before (<) 4.0.3cpe:2.3:a:onedev_project:onedev:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.28% Probability of exploitation activity in the next 30 days\n~ 68 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.30%  0.28%  -0.02 \n 2  2023-10-01  0.27%  0.30%  +0.03 \n 3  2023-08-22  0.27%  0.27%  +0.00 \n 4  2023-03-07  0.89%  0.27%  -0.62 ", "CVSS Scores": "5.0", "CWE": [{"CWE_ID": "CWE-862 Missing Authorization", "CWE_link": "/cwe-details/862/Missing-Authorization.html"}], "Reference": [{"ref_link": "https://github.com/theonedev/onedev/security/advisories/GHSA-66v7-gg85-f4gx", "ref_desc": "Pre-Auth Access token leak \u00b7 Advisory \u00b7 theonedev/onedev \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/theonedev/onedev/commit/a4491e5f79dc6cc96eac20972eedc8905ddf6089", "ref_desc": "Fix the issue that user access token can be leaked via restful api \u00b7 theonedev/onedev@a4491e5 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}]}