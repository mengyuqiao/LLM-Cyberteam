{"CVE Code": "CVE-2021-29504", "Description": "WP-CLI is the command-line interface for WordPress. An improper error handling in HTTPS requests management in WP-CLI version 0.12.0 and later allows remote attackers able to intercept the communication to remotely disable the certificate verification on WP-CLI side, gaining full control over the communication content, including the ability to impersonate update servers and push malicious updates towards WordPress instances controlled by the vulnerable WP-CLI agent, or push malicious updates toward WP-CLI itself. The vulnerability stems from the fact that the default behavior of `WP_CLI\\Utils\\http_request()` when encountering a TLS handshake error is to disable certificate validation and retry the same request. The default behavior has been changed with version 2.5.0 of WP-CLI and the `wp-cli/wp-cli` framework (via https://github.com/wp-cli/wp-cli/pull/5523) so that the `WP_CLI\\Utils\\http_request()` method accepts an `$insecure` option that is `false` by default and consequently that a TLS handshake failure is a hard error by default. This new default is a breaking change and ripples through to all consumers of `WP_CLI\\Utils\\http_request()`, including those in separate WP-CLI bundled or third-party packages. https://github.com/wp-cli/wp-cli/pull/5523 has also added an `--insecure` flag to the `cli update` command to counter this breaking change. There is no direct workaround for the default insecure behavior of `wp-cli/wp-cli` versions before 2.5.0. The workaround for dealing with the breaking change in the commands directly affected by the new secure default behavior is to add the `--insecure` flag to manually opt-in to the previous insecure behavior.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-29504", "Vulnerability Categories": "N/A", "Affected Products": "\nWp-cli\u00bbWp-cliVersions  from including (>=) 0.12.0andbefore (<) 2.5.0cpe:2.3:a:wp-cli:wp-cli:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.26% Probability of exploitation activity in the next 30 days\n~ 65 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.33%  0.26%  -0.07 \n 2  2024-09-08  0.23%  0.33%  +0.10 \n 3  2024-02-21  0.17%  0.23%  +0.06 \n 4  2024-01-12  0.15%  0.17%  +0.02 \n 5  2023-03-07  1.32%  0.15%  -1.17 ", "CVSS Scores": "7.5", "CWE": [{"CWE_ID": "CWE-295 Improper Certificate Validation", "CWE_link": "/cwe-details/295/Improper-Certificate-Validation.html"}], "Reference": [{"ref_link": "https://github.com/wp-cli/extension-command/pull/287", "ref_desc": "Add `--insecure` flag to `plugin|theme install` & `plugin\\theme update` commands by schlessera \u00b7 Pull Request #287 \u00b7 wp-cli/extension-command \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/wp-cli/checksum-command/pull/86", "ref_desc": "Add `--insecure` flag to `core|plugin verify-checksums` commands by schlessera \u00b7 Pull Request #86 \u00b7 wp-cli/checksum-command \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/wp-cli/package-command/pull/138", "ref_desc": "Add `--insecure` flag to `package install` command by schlessera \u00b7 Pull Request #138 \u00b7 wp-cli/package-command \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/wp-cli/wp-cli/security/advisories/GHSA-rwgm-f83r-v3qj", "ref_desc": "Improper Certificate Validation in WP-CLI framework \u00b7 Advisory \u00b7 wp-cli/wp-cli \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/wp-cli/wp-cli/pull/5523", "ref_desc": "Disable automatic retry by default on certificate validation error by schlessera \u00b7 Pull Request #5523 \u00b7 wp-cli/wp-cli \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/wp-cli/config-command/pull/128", "ref_desc": "Add `--insecure` flag to `config create` & `config shuffle-salts` commands by schlessera \u00b7 Pull Request #128 \u00b7 wp-cli/config-command \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/wp-cli/core-command/pull/186", "ref_desc": "Add `--insecure` flag to `core download` & `core update` commands by schlessera \u00b7 Pull Request #186 \u00b7 wp-cli/core-command \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}]}