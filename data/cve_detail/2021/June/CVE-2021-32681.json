{"CVE Code": "CVE-2021-32681", "Description": "Wagtail is an open source content management system built on Django. A cross-site scripting vulnerability exists in versions 2.13-2.13.1, versions 2.12-2.12.4, and versions prior to 2.11.8. When the `{% include_block %}` template tag is used to output the value of a plain-text StreamField block (`CharBlock`, `TextBlock` or a similar user-defined block derived from `FieldBlock`), and that block does not specify a template for rendering, the tag output is not properly escaped as HTML. This could allow users to insert arbitrary HTML or scripting. This vulnerability is only exploitable by users with the ability to author StreamField content (i.e. users with 'editor' access to the Wagtail admin). Patched versions have been released as Wagtail 2.11.8 (for the LTS 2.11 branch), Wagtail 2.12.5, and Wagtail 2.13.2 (for the current 2.13 branch). As a workaround, site implementors who are unable to upgrade to a current supported version should audit their use of `{% include_block %}` to ensure it is not used to output `CharBlock` / `TextBlock` values with no associated template. Note that this only applies where `{% include_block %}` is used directly on that block (uses of `include_block` on a block _containing_ a CharBlock / TextBlock, such as a StructBlock, are unaffected). In these cases, the tag can be replaced with Django's `{{ ... }}` syntax - e.g. `{% include_block my_title_block %}` becomes `{{ my_title_block }}`.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-32681", "Vulnerability Categories": "Cross site scripting (XSS)", "Affected Products": "\nTorchbox\u00bbWagtailVersions  from including (>=) 2.12andup to, including, (<=) 2.12.4cpe:2.3:a:torchbox:wagtail:*:*:*:*:*:*:*:*Matching versions\nTorchbox\u00bbWagtailVersions  from including (>=) 2.13andup to, including, (<=) 2.13.1cpe:2.3:a:torchbox:wagtail:*:*:*:*:*:*:*:*Matching versions\nTorchbox\u00bbWagtailVersions  before (<) 2.11.8cpe:2.3:a:torchbox:wagtail:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.20% Probability of exploitation activity in the next 30 days\n~ 58 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.15%  0.20%  +0.05 \n 2  2023-03-07  0.95%  0.15%  -0.80 ", "CVSS Scores": "3.5", "CWE": [{"CWE_ID": "CWE-79 Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "CWE_link": "/cwe-details/79/Improper-Neutralization-of-Input-During-Web-Page-Generation-.html"}], "Reference": [{"ref_link": "https://github.com/wagtail/wagtail/security/advisories/GHSA-xfrw-hxr5-ghqf", "ref_desc": "Improper escaping of HTML ('Cross-site Scripting') in Wagtail StreamField blocks \u00b7 Advisory \u00b7 wagtail/wagtail \u00b7 GitHubMitigation;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/wagtail/wagtail/releases/tag/v2.11.8", "ref_desc": "Release 2.11.8 \u00b7 wagtail/wagtail \u00b7 GitHubExploit;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/wagtail/wagtail/releases/tag/v2.13.2", "ref_desc": "Release 2.13.2 \u00b7 wagtail/wagtail \u00b7 GitHubExploit;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/wagtail/wagtail/releases/tag/v2.12.5", "ref_desc": "Release 2.12.5 \u00b7 wagtail/wagtail \u00b7 GitHubExploit;Third Party Advisory", "ref_cve_link": "N/A"}]}