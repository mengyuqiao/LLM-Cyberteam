{"CVE Code": "CVE-2021-32677", "Description": "FastAPI is a web framework for building APIs with Python 3.6+ based on standard Python type hints. FastAPI versions lower than 0.65.2 that used cookies for authentication in path operations that received JSON payloads sent by browsers were vulnerable to a Cross-Site Request Forgery (CSRF) attack. In versions lower than 0.65.2, FastAPI would try to read the request payload as JSON even if the content-type header sent was not set to application/json or a compatible JSON media type (e.g. application/geo+json). A request with a content type of text/plain containing JSON data would be accepted and the JSON data would be extracted. Requests with content type text/plain are exempt from CORS preflights, for being considered Simple requests. The browser will execute them right away including cookies, and the text content could be a JSON string that would be parsed and accepted by the FastAPI application. This is fixed in FastAPI 0.65.2. The request data is now parsed as JSON only if the content-type header is application/json or another JSON compatible media type like application/geo+json. It's best to upgrade to the latest FastAPI, but if updating is not possible then a middleware or a dependency that checks the content-type header and aborts the request if it is not application/json or another JSON compatible content type can act as a mitigating workaround.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-32677", "Vulnerability Categories": "Cross-site request forgery (CSRF)", "Affected Products": "\nFedoraproject\u00bbFedora\u00bbVersion:34cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*Matching versions\nTiangolo\u00bbFastapiVersions  before (<) 0.65.2cpe:2.3:a:tiangolo:fastapi:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.09% Probability of exploitation activity in the next 30 days\n~ 36 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-02-23  0.09%  0.09%  0.00 \n 2  2024-01-14  0.09%  0.09%  +0.00 \n 3  2023-12-19  0.09%  0.09%  +0.00 \n 4  2023-03-07  0.95%  0.09%  -0.87 ", "CVSS Scores": "5.8", "CWE": [{"CWE_ID": "CWE-352 Cross-Site Request Forgery (CSRF)", "CWE_link": "/cwe-details/352/Cross-Site-Request-Forgery-CSRF-.html"}], "Reference": [{"ref_link": "https://github.com/tiangolo/fastapi/commit/fa7e3c996edf2d5482fff8f9d890ac2390dede4d", "ref_desc": "\ud83d\udc1b Check Content-Type request header before assuming JSON (#2118) \u00b7 tiangolo/fastapi@fa7e3c9 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MATAWX25TYKNEKLDMKWNLYDB34UWTROA/", "ref_desc": "[SECURITY] Fedora 34 Update: python-fastapi-0.65.2-1.fc34 - package-announce - Fedora Mailing-ListsMailing List;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MATAWX25TYKNEKLDMKWNLYDB34UWTROA/", "ref_desc": "[SECURITY] Fedora 34 Update: python-fastapi-0.65.2-1.fc34 - package-announce - Fedora Mailing-Lists", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/tiangolo/fastapi/security/advisories/GHSA-8h2j-cgx8-6xv7", "ref_desc": "Cross-Site Request Forgery (CSRF) in FastAPI \u00b7 Advisory \u00b7 tiangolo/fastapi \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}]}