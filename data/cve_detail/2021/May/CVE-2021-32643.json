{"CVE Code": "CVE-2021-32643", "Description": "Http4s is a Scala interface for HTTP services. `StaticFile.fromUrl` can leak the presence of a directory on a server when the `URL` scheme is not `file://`, and the URL points to a fetchable resource under its scheme and authority. The function returns `F[None]`, indicating no resource, if `url.getFile` is a directory, without first checking the scheme or authority of the URL. If a URL connection to the scheme and URL would return a stream, and the path in the URL exists as a directory on the server, the presence of the directory on the server could be inferred from the 404 response. The contents and other metadata about the directory are not exposed. This affects http4s versions: 0.21.7 through 0.21.23, 0.22.0-M1 through 0.22.0-M8, 0.23.0-M1, and 1.0.0-M1 through 1.0.0-M22. The [patch](https://github.com/http4s/http4s/commit/52e1890665410b4385e37b96bc49c5e3c708e4e9) is available in the following versions: v0.21.24, v0.22.0-M9, v0.23.0-M2, v1.0.0-M23. As a workaround users can avoid calling `StaticFile.fromUrl` with non-file URLs.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-32643", "Vulnerability Categories": "Directory traversal", "Affected Products": "\nTypelevel\u00bbHttp4sVersions  from including (>=) 0.21.7andbefore (<) 0.21.24cpe:2.3:a:typelevel:http4s:*:*:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:0.22.0UpdateMilestone1cpe:2.3:a:typelevel:http4s:0.22.0:milestone1:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:0.22.0UpdateMilestone2cpe:2.3:a:typelevel:http4s:0.22.0:milestone2:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:0.22.0UpdateMilestone3cpe:2.3:a:typelevel:http4s:0.22.0:milestone3:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:0.22.0UpdateMilestone4cpe:2.3:a:typelevel:http4s:0.22.0:milestone4:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:0.22.0UpdateMilestone5cpe:2.3:a:typelevel:http4s:0.22.0:milestone5:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:0.22.0UpdateMilestone6cpe:2.3:a:typelevel:http4s:0.22.0:milestone6:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:0.22.0UpdateMilestone7cpe:2.3:a:typelevel:http4s:0.22.0:milestone7:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:0.22.0UpdateMilestone8cpe:2.3:a:typelevel:http4s:0.22.0:milestone8:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:0.23.0UpdateMilestone1cpe:2.3:a:typelevel:http4s:0.23.0:milestone1:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone1cpe:2.3:a:typelevel:http4s:1.0.0:milestone1:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone10cpe:2.3:a:typelevel:http4s:1.0.0:milestone10:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone17cpe:2.3:a:typelevel:http4s:1.0.0:milestone17:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone18cpe:2.3:a:typelevel:http4s:1.0.0:milestone18:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone19cpe:2.3:a:typelevel:http4s:1.0.0:milestone19:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone20cpe:2.3:a:typelevel:http4s:1.0.0:milestone20:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone21cpe:2.3:a:typelevel:http4s:1.0.0:milestone21:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone22cpe:2.3:a:typelevel:http4s:1.0.0:milestone22:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone11cpe:2.3:a:typelevel:http4s:1.0.0:milestone11:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone12cpe:2.3:a:typelevel:http4s:1.0.0:milestone12:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone13cpe:2.3:a:typelevel:http4s:1.0.0:milestone13:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone14cpe:2.3:a:typelevel:http4s:1.0.0:milestone14:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone15cpe:2.3:a:typelevel:http4s:1.0.0:milestone15:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone16cpe:2.3:a:typelevel:http4s:1.0.0:milestone16:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone2cpe:2.3:a:typelevel:http4s:1.0.0:milestone2:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone3cpe:2.3:a:typelevel:http4s:1.0.0:milestone3:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone4cpe:2.3:a:typelevel:http4s:1.0.0:milestone4:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone5cpe:2.3:a:typelevel:http4s:1.0.0:milestone5:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone6cpe:2.3:a:typelevel:http4s:1.0.0:milestone6:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone7cpe:2.3:a:typelevel:http4s:1.0.0:milestone7:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone8cpe:2.3:a:typelevel:http4s:1.0.0:milestone8:*:*:*:*:*:*Matching versions\nTypelevel\u00bbHttp4s\u00bbVersion:1.0.0UpdateMilestone9cpe:2.3:a:typelevel:http4s:1.0.0:milestone9:*:*:*:*:*:*Matching versions", "EPSS Score": "0.13% Probability of exploitation activity in the next 30 days\n~ 49 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.10%  0.13%  +0.04 \n 2  2024-02-10  0.08%  0.10%  +0.01 \n 3  2024-01-01  0.08%  0.08%  +0.00 \n 4  2023-12-06  0.08%  0.08%  +0.00 \n 5  2023-03-07  0.95%  0.08%  -0.88 ", "CVSS Scores": "5.0", "CWE": [{"CWE_ID": "CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')", "CWE_link": "/cwe-details/22/Improper-Limitation-of-a-Pathname-to-a-Restricted-Directory-.html"}], "Reference": [{"ref_link": "https://mvnrepository.com/artifact/org.http4s/http4s-core", "ref_desc": "Maven Repository: org.http4s \u00bb http4s-coreThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/http4s/http4s/commit/52e1890665410b4385e37b96bc49c5e3c708e4e9", "ref_desc": "Fix directory leak in StaticFile.fromUrl \u00b7 http4s/http4s@52e1890 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/http4s/http4s/security/advisories/GHSA-6h7w-fc84-x7p6", "ref_desc": "StaticFile.fromUrl can leak presence of a directory \u00b7 Advisory \u00b7 http4s/http4s \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}]}