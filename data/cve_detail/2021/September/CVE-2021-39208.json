{"CVE Code": "CVE-2021-39208", "Description": "SharpCompress is a fully managed C# library to deal with many compression types and formats. Versions prior to 0.29.0 are vulnerable to partial path traversal. SharpCompress recreates a hierarchy of directories under destinationDirectory if ExtractFullPath is set to true in options. In order to prevent extraction outside the destination directory the destinationFileName path is verified to begin with fullDestinationDirectoryPath. However, prior to version 0.29.0, it is not enforced that fullDestinationDirectoryPath ends with slash. If the destinationDirectory is not slash terminated like `/home/user/dir` it is possible to create a file with a name thats begins as the destination directory one level up from the directory, i.e. `/home/user/dir.sh`. Because of the file name and destination directory constraints the arbitrary file creation impact is limited and depends on the use case. This issue is fixed in SharpCompress version 0.29.0.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-39208", "Vulnerability Categories": "Directory traversal", "Affected Products": "\nSharpcompress Project\u00bbSharpcompressVersions  before (<) 0.29.0cpe:2.3:a:sharpcompress_project:sharpcompress:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.08% Probability of exploitation activity in the next 30 days\n~ 33 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2023-12-09  0.06%  0.08%  +0.02 \n 2  2023-04-09  0.06%  0.06%  +0.00 \n 3  2023-03-07  0.89%  0.06%  -0.83 ", "CVSS Scores": "4.0", "CWE": [{"CWE_ID": "CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')", "CWE_link": "/cwe-details/22/Improper-Limitation-of-a-Pathname-to-a-Restricted-Directory-.html"}], "Reference": [{"ref_link": "https://github.com/adamhathcock/sharpcompress/releases/tag/0.29.0", "ref_desc": "Release 0.29.0 - minor behavior change and fixes \u00b7 adamhathcock/sharpcompress \u00b7 GitHubRelease Notes;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/adamhathcock/sharpcompress/pull/614", "ref_desc": "Ensure destination directory exists. by adamhathcock \u00b7 Pull Request #614 \u00b7 adamhathcock/sharpcompress \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/adamhathcock/sharpcompress/security/advisories/GHSA-jp7f-grcv-6mjf", "ref_desc": "WriteEntryToDirectory used for an archive extraction is vulnerable to partial path traversal. \u00b7 Advisory \u00b7 adamhathcock/sharpcompress \u00b7 GitHubExploit;Third Party Advisory", "ref_cve_link": "N/A"}]}