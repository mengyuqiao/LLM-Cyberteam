{"CVE Code": "CVE-2021-39197", "Description": "better_errors is an open source replacement for the standard Rails error page with more information rich error pages. It is also usable outside of Rails in any Rack app as Rack middleware. better_errors prior to 2.8.0 did not implement CSRF protection for its internal requests. It also did not enforce the correct \"Content-Type\" header for these requests, which allowed a cross-origin \"simple request\" to be made without CORS protection. These together left an application with better_errors enabled open to cross-origin attacks. As a developer tool, better_errors documentation strongly recommends addition only to the `development` bundle group, so this vulnerability should only affect development environments. Please ensure that your project limits better_errors to the `development` group (or the non-Rails equivalent). Starting with release 2.8.x, CSRF protection is enforced. It is recommended that you upgrade to the latest release, or minimally to \"~> 2.8.3\". There are no known workarounds to mitigate the risk of using older releases of better_errors.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-39197", "Vulnerability Categories": "Cross-site request forgery (CSRF)", "Affected Products": "\nBetter Errors Project\u00bbBetter Errors\u00bbForRubyVersions  before (<) 2.8.0cpe:2.3:a:better_errors_project:better_errors:*:*:*:*:*:ruby:*:*Matching versions", "EPSS Score": "0.17% Probability of exploitation activity in the next 30 days\n~ 54 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.13%  0.17%  +0.05 \n 2  2024-05-23  0.13%  0.13%  0.00 \n 3  2024-03-18  0.12%  0.13%  +0.01 \n 4  2023-04-29  0.12%  0.12%  +0.00 \n 5  2023-04-15  0.10%  0.12%  +0.02 \n 6  2023-03-31  0.11%  0.10%  0.00 \n 7  2023-03-07  1.02%  0.11%  -0.91 ", "CVSS Scores": "6.8", "CWE": [{"CWE_ID": "CWE-352 Cross-Site Request Forgery (CSRF)", "CWE_link": "/cwe-details/352/Cross-Site-Request-Forgery-CSRF-.html"}], "Reference": [{"ref_link": "https://github.com/BetterErrors/better_errors/commit/8e8e796bfbde4aa088741823c8a3fc6df2089bb0", "ref_desc": "Merge pull request #474 from BetterErrors/feature/add-csrf-to-requests \u00b7 BetterErrors/better_errors@8e8e796 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/BetterErrors/better_errors/discussions/507", "ref_desc": "Cross-Site Request Forgery vulnerability \u00b7 Discussion #507 \u00b7 BetterErrors/better_errors \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/BetterErrors/better_errors/security/advisories/GHSA-w3j4-76qw-wwjm", "ref_desc": "Vulnerable to Cross-Site Request Forgery in development \u00b7 Advisory \u00b7 BetterErrors/better_errors \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/BetterErrors/better_errors/pull/474", "ref_desc": "Add CSRF protection to internal requests by RobinDaugherty \u00b7 Pull Request #474 \u00b7 BetterErrors/better_errors \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}]}