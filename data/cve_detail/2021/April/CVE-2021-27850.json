{"CVE Code": "CVE-2021-27850", "Description": "A critical unauthenticated remote code execution vulnerability was found all recent versions of Apache Tapestry. The affected versions include 5.4.5, 5.5.0, 5.6.2 and 5.7.0. The vulnerability I have found is a bypass of the fix for CVE-2019-0195. Recap: Before the fix of CVE-2019-0195 it was possible to download arbitrary class files from the classpath by providing a crafted asset file URL. An attacker was able to download the file `AppModule.class` by requesting the URL `http://localhost:8080/assets/something/services/AppModule.class` which contains a HMAC secret key. The fix for that bug was a blacklist filter that checks if the URL ends with `.class`, `.properties` or `.xml`. Bypass: Unfortunately, the blacklist solution can simply be bypassed by appending a `/` at the end of the URL: `http://localhost:8080/assets/something/services/AppModule.class/` The slash is stripped after the blacklist check and the file `AppModule.class` is loaded into the response. This class usually contains the HMAC secret key which is used to sign serialized Java objects. With the knowledge of that key an attacker can sign a Java gadget chain that leads to RCE (e.g. CommonsBeanUtils1 from ysoserial). Solution for this vulnerability: * For Apache Tapestry 5.4.0 to 5.6.1, upgrade to 5.6.2 or later. * For Apache Tapestry 5.7.0, upgrade to 5.7.1 or later.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-27850", "Vulnerability Categories": "Execute code;Information leak", "Affected Products": "\nApache\u00bbTapestryVersions  from including (>=) 5.7.0andbefore (<) 5.7.1cpe:2.3:a:apache:tapestry:*:*:*:*:*:*:*:*Matching versions\nApache\u00bbTapestryVersions  from including (>=) 5.4.0andbefore (<) 5.6.2cpe:2.3:a:apache:tapestry:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "97.21% Probability of exploitation activity in the next 30 days\n~ 100 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  97.41%  97.21%  -0.20 \n 2  2024-12-13  97.40%  97.41%  +0.02 \n 3  2024-10-23  97.38%  97.40%  +0.01 \n 4  2024-09-18  97.27%  97.38%  +0.12 \n 5  2024-09-02  97.34%  97.27%  -0.08 \n 6  2024-08-18  97.31%  97.34%  +0.03 \n 7  2024-08-01  97.27%  97.31%  +0.04 \n 8  2024-07-17  97.34%  97.27%  -0.06 \n 9  2024-06-16  97.37%  97.34%  -0.03 \n 10  2024-05-18  97.39%  97.37%  -0.02 \n 11  2024-04-18  97.40%  97.39%  -0.01 \n 12  2024-04-03  97.39%  97.40%  +0.02 \n 13  2024-03-21  97.37%  97.39%  +0.02 \n 14  2024-01-25  97.39%  97.37%  -0.02 \n 15  2023-12-30  97.39%  97.39%  0.00 \n 16  2023-11-20  97.41%  97.39%  -0.02 \n 17  2023-10-25  97.38%  97.41%  +0.04 \n 18  2023-10-12  97.40%  97.38%  -0.02 \n 19  2023-08-05  97.41%  97.40%  -0.01 \n 20  2023-07-08  97.41%  97.41%  +0.00 \n 21  2023-03-31  97.37%  97.41%  +0.04 \n 22  2023-03-15  97.40%  97.37%  -0.03 \n 23  2023-03-07  92.91%  97.40%  +4.49 ", "CVSS Scores": "10.0", "CWE": [{"CWE_ID": "CWE-200 Exposure of Sensitive Information to an Unauthorized Actor", "CWE_link": "/cwe-details/200/Exposure-of-Sensitive-Information-to-an-Unauthorized-Actor.html"}, {"CWE_ID": "CWE-502 Deserialization of Untrusted Data", "CWE_link": "/cwe-details/502/Deserialization-of-Untrusted-Data.html"}], "Reference": [{"ref_link": "http://www.openwall.com/lists/oss-security/2021/04/15/1", "ref_desc": "oss-security - CVE-2021-27850: Apache Tapestry: Bypass of the fix for CVE-2019-0195Exploit;Mailing List;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/22k7IMXFOzYjU3SEFlyRpcSjcoM.html"}, {"ref_link": "https://security.netapp.com/advisory/ntap-20210528-0002/", "ref_desc": "CVE-2021-27850 Apache Tapestry Vulnerability in NetApp Products | NetApp Product SecurityThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.apache.org/thread.html/r237ff7f286bda31682c254550c1ebf92b0ec61329b32fbeb2d1c8751%40%3Cusers.tapestry.apache.org%3E", "ref_desc": "[SECURITY VULNERABILITY DISCLOSURE] CVE-2021-27850: Apache Tapestry: Bypass of the fix for CVE-2019-0195 - Pony MailMailing List;Vendor Advisory", "ref_cve_link": "N/A"}]}