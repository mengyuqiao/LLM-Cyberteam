{"CVE Code": "CVE-2021-29475", "Description": "HedgeDoc (formerly known as CodiMD) is an open-source collaborative markdown editor. An attacker is able to receive arbitrary files from the file system when exporting a note to PDF. Since the code injection has to take place as note content, there fore this exploit requires the attackers ability to modify a note. This will affect all instances, which have pdf export enabled. This issue has been fixed by https://github.com/hedgedoc/hedgedoc/commit/c1789474020a6d668d616464cb2da5e90e123f65 and is available in version 1.5.0. Starting the CodiMD/HedgeDoc instance with `CMD_ALLOW_PDF_EXPORT=false` or set `\"allowPDFExport\": false` in config.json can mitigate this issue for those who cannot upgrade. This exploit works because while PhantomJS doesn't actually render the `file:///` references to the PDF file itself, it still uses them internally, and exfiltration is possible, and easy through JavaScript rendering. The impact is pretty bad, as the attacker is able to read the CodiMD/HedgeDoc `config.json` file as well any other files on the filesystem. Even though the suggested Docker deploy option doesn't have many interesting files itself, the `config.json` still often contains sensitive information, database credentials, and maybe OAuth secrets among other things.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-29475", "Vulnerability Categories": "Server-side request forgery (SSRF)", "Affected Products": "\nHedgedoc\u00bbHedgedocVersions  before (<) 1.5.0cpe:2.3:a:hedgedoc:hedgedoc:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.13% Probability of exploitation activity in the next 30 days\n~ 48 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.20%  0.13%  -0.07 \n 2  2024-01-10  0.14%  0.20%  +0.06 \n 3  2023-12-01  0.14%  0.14%  +0.00 \n 4  2023-11-05  0.14%  0.14%  0.00 \n 5  2023-03-07  0.89%  0.14%  -0.75 ", "CVSS Scores": "5.8", "CWE": [{"CWE_ID": "CWE-94 Improper Control of Generation of Code ('Code Injection')", "CWE_link": "/cwe-details/94/Improper-Control-of-Generation-of-Code-Code-Injection-.html"}, {"CWE_ID": "CWE-918 Server-Side Request Forgery (SSRF)", "CWE_link": "/cwe-details/918/Server-Side-Request-Forgery-SSRF-.html"}], "Reference": [{"ref_link": "https://github.com/hedgedoc/hedgedoc/security/advisories/GHSA-pxxg-px9v-6qf3", "ref_desc": "PDF export allows arbitrary file reads \u00b7 Advisory \u00b7 hedgedoc/hedgedoc \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/hedgedoc/hedgedoc/commit/c1789474020a6d668d616464cb2da5e90e123f65", "ref_desc": "Disable PDF export due to security issue \u00b7 hedgedoc/hedgedoc@c178947 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}]}