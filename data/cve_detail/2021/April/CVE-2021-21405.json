{"CVE Code": "CVE-2021-21405", "Description": "Lotus is an Implementation of the Filecoin protocol written in Go. BLS signature validation in lotus uses blst library method VerifyCompressed. This method accepts signatures in 2 forms: \"serialized\", and \"compressed\", meaning that BLS signatures can be provided as either of 2 unique byte arrays. Lotus block validation functions perform a uniqueness check on provided blocks. Two blocks are considered distinct if the CIDs of their blockheader do not match. The CID method for blockheader includes the BlockSig of the block. The result of these issues is that it would be possible to punish miners for valid blocks, as there are two different valid block CIDs available for each block, even though this must be unique. By switching from the go based `blst` bindings over to the bindings in `filecoin-ffi`, the code paths now ensure that all signatures are compressed by size and the way they are deserialized. This happened in https://github.com/filecoin-project/lotus/pull/5393.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-21405", "Vulnerability Categories": "N/A", "Affected Products": "\nFilecoin\u00bbLotusVersions  before (<) 1.5.0cpe:2.3:a:filecoin:lotus:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.14% Probability of exploitation activity in the next 30 days\n~ 50 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.14%  0.14%  +0.00 \n 2  2023-12-30  0.12%  0.14%  +0.02 \n 3  2023-11-20  0.10%  0.12%  +0.02 \n 4  2023-07-08  0.08%  0.10%  +0.02 \n 5  2023-03-07  0.95%  0.08%  -0.87 ", "CVSS Scores": "5.0", "CWE": [{"CWE_ID": "CWE-347 Improper Verification of Cryptographic Signature", "CWE_link": "/cwe-details/347/Improper-Verification-of-Cryptographic-Signature.html"}], "Reference": [{"ref_link": "https://github.com/filecoin-project/lotus/security/advisories/GHSA-4g52-pqcj-phvh", "ref_desc": "BLS Signature \"Malleability\" \u00b7 Advisory \u00b7 filecoin-project/lotus \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://gist.github.com/wadeAlexC/2490d522e81a796af9efcad1686e6754", "ref_desc": "A_DESCRIPTION.md \u00b7 GitHubExploit;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/filecoin-project/lotus/pull/5393", "ref_desc": "refactor: switch to filecoin-ffi bls api for bls signatures by dignifiedquire \u00b7 Pull Request #5393 \u00b7 filecoin-project/lotus \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}]}