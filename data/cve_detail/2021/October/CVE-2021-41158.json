{"CVE Code": "CVE-2021-41158", "Description": "FreeSWITCH is a Software Defined Telecom Stack enabling the digital transformation from proprietary telecom switches to a software implementation that runs on any commodity hardware. Prior to version 1.10.7, an attacker can perform a SIP digest leak attack against FreeSWITCH and receive the challenge response of a gateway configured on the FreeSWITCH server. This is done by challenging FreeSWITCH's SIP requests with the realm set to that of the gateway, thus forcing FreeSWITCH to respond with the challenge response which is based on the password of that targeted gateway. Abuse of this vulnerability allows attackers to potentially recover gateway passwords by performing a fast offline password cracking attack on the challenge response. The attacker does not require special network privileges, such as the ability to sniff the FreeSWITCH's network traffic, to exploit this issue. Instead, what is required for this attack to work is the ability to cause the victim server to send SIP request messages to the malicious party. Additionally, to exploit this issue, the attacker needs to specify the correct realm which might in some cases be considered secret. However, because many gateways are actually public, this information can easily be retrieved. The vulnerability appears to be due to the code which handles challenges in `sofia_reg.c`, `sofia_reg_handle_sip_r_challenge()` which does not check if the challenge is originating from the actual gateway. The lack of these checks allows arbitrary UACs (and gateways) to challenge any request sent by FreeSWITCH with the realm of the gateway being targeted. This issue is patched in version 10.10.7. Maintainers recommend that one should create an association between a SIP session for each gateway and its realm to make a check be put into place for this association when responding to challenges.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-41158", "Vulnerability Categories": "Information leak", "Affected Products": "\nFreeswitch\u00bbFreeswitchVersions  before (<) 1.10.7cpe:2.3:a:freeswitch:freeswitch:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.19% Probability of exploitation activity in the next 30 days\n~ 57 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.20%  0.19%  -0.01 \n 2  2024-09-17  0.21%  0.20%  0.00 \n 3  2024-07-11  0.19%  0.21%  +0.02 \n 4  2024-06-01  0.15%  0.19%  +0.04 \n 5  2024-01-18  0.12%  0.15%  +0.03 \n 6  2023-05-19  0.12%  0.12%  0.00 \n 7  2023-04-08  0.11%  0.12%  +0.01 \n 8  2023-03-07  0.95%  0.11%  -0.85 ", "CVSS Scores": "5.0", "CWE": [{"CWE_ID": "CWE-200 Exposure of Sensitive Information to an Unauthorized Actor", "CWE_link": "/cwe-details/200/Exposure-of-Sensitive-Information-to-an-Unauthorized-Actor.html"}, {"CWE_ID": "CWE-346 Origin Validation Error", "CWE_link": "/cwe-details/346/Origin-Validation-Error.html"}], "Reference": [{"ref_link": "http://seclists.org/fulldisclosure/2021/Oct/40", "ref_desc": "Full Disclosure: [ES2021-05] FreeSWITCH vulnerable to SIP digest leak for configured gatewaysMailing List;Patch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/signalwire/freeswitch/releases/tag/v1.10.7", "ref_desc": "Release FreeSWITCH v1.10.7 Release \u00b7 signalwire/freeswitch \u00b7 GitHubRelease Notes;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/j9o6ZOP0BVrpPgEnYvubEqIrTa0.html"}, {"ref_link": "https://github.com/signalwire/freeswitch/security/advisories/GHSA-3v3f-99mv-qvj4", "ref_desc": "FreeSWITCH vulnerable to SIP digest leak for configured gateways \u00b7 Advisory \u00b7 signalwire/freeswitch \u00b7 GitHubExploit;Third Party Advisory", "ref_cve_link": "N/A"}]}