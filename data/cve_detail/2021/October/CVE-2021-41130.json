{"CVE Code": "CVE-2021-41130", "Description": "Extensible Service Proxy, a.k.a. ESP is a proxy which enables API management capabilities for JSON/REST or gRPC API services. ESPv1 can be configured to authenticate a JWT token. Its verified JWT claim is passed to the application by HTTP header \"X-Endpoint-API-UserInfo\", the application can use it to do authorization. But if there are two \"X-Endpoint-API-UserInfo\" headers from the client, ESPv1 only replaces the first one, the 2nd one will be passed to the application. An attacker can send two \"X-Endpoint-API-UserInfo\" headers, the second one with a fake JWT claim. Application may use the fake JWT claim to do the authorization. This impacts following ESPv1 usages: 1) Users have configured ESPv1 to do JWT authentication with Google ID Token as described in the referenced google endpoint document. 2) Users backend application is using the info in the \"X-Endpoint-API-UserInfo\" header to do the authorization. It has been fixed by v1.58.0. You need to patch it in the following ways: * If your docker image is using tag \":1\", needs to re-start the container to pick up the new version. The tag \":1\" will automatically point to the latest version. * If your docker image tag pings to a specific minor version, e.g. \":1.57\". You need to update it to \":1.58\" and re-start the container. There are no workaround for this issue.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-41130", "Vulnerability Categories": "N/A", "Affected Products": "\nGoogle\u00bbExtensible Service ProxyVersions  before (<) 1.58.0cpe:2.3:a:google:extensible_service_proxy:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.08% Probability of exploitation activity in the next 30 days\n~ 35 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.11%  0.08%  -0.03 \n 2  2023-04-30  0.08%  0.11%  +0.03 \n 3  2023-03-07  0.95%  0.08%  -0.87 ", "CVSS Scores": "4.9", "CWE": [{"CWE_ID": "CWE-290 Authentication Bypass by Spoofing", "CWE_link": "/cwe-details/290/Authentication-Bypass-by-Spoofing.html"}], "Reference": [{"ref_link": "https://cloud.google.com/endpoints/docs/openapi/authenticating-users-google-id", "ref_desc": "Using Google ID tokens to authenticate usersVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/cloudendpoints/esp/security/advisories/GHSA-43wx-8qmj-9r9q", "ref_desc": "X-Endpoint-API-UserInfo can be spoofed. \u00b7 Advisory \u00b7 cloudendpoints/esp \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/cloudendpoints/esp/commit/e310c4f91d229a072507f80c73811489b4cdff27", "ref_desc": "Remove X-Endpoint-API-UserInfo for all header occurrences. (#845) \u00b7 cloudendpoints/esp@e310c4f \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/cloudendpoints/esp/releases/tag/v1.58.0", "ref_desc": "Release Endpoints Runtime Release 1.58.0 \u00b7 cloudendpoints/esp \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}]}