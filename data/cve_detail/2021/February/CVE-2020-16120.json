{"CVE Code": "CVE-2020-16120", "Description": "Overlayfs did not properly perform permission checking when copying up files in an overlayfs and could be exploited from within a user namespace, if, for example, unprivileged user namespaces were allowed. It was possible to have a file not readable by an unprivileged user to be copied to a mountpoint controlled by the user, like a removable device. This was introduced in kernel version 4.19 by commit d1d04ef (\"ovl: stack file ops\"). This was fixed in kernel version 5.8 by commits 56230d9 (\"ovl: verify permissions in ovl_path_open()\"), 48bd024 (\"ovl: switch to mounter creds in readdir\") and 05acefb (\"ovl: check permission to open real file\"). Additionally, commits 130fdbc (\"ovl: pass correct flags for opening real directory\") and 292f902 (\"ovl: call secutiry hook in ovl_real_ioctl()\") in kernel 5.8 might also be desired or necessary. These additional commits introduced a regression in overlay mounts within user namespaces which prevented access to files with ownership outside of the user namespace. This regression was mitigated by subsequent commit b6650da (\"ovl: do not fail because of O_NOATIMEi\") in kernel 5.11.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2020-16120", "Vulnerability Categories": "N/A", "Affected Products": "\nLinux\u00bbLinux KernelVersions  before (<) 5.11cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*Matching versions\nCanonical\u00bbUbuntu Linux\u00bbVersion:14.04    ESMEditioncpe:2.3:o:canonical:ubuntu_linux:14.04:*:*:*:esm:*:*:*Matching versions\nCanonical\u00bbUbuntu Linux\u00bbVersion:16.04    LTSEditioncpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*Matching versions\nCanonical\u00bbUbuntu Linux\u00bbVersion:18.04    LTSEditioncpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*Matching versions\nCanonical\u00bbUbuntu Linux\u00bbVersion:20.04    LTSEditioncpe:2.3:o:canonical:ubuntu_linux:20.04:*:*:*:lts:*:*:*Matching versions", "EPSS Score": "0.05% Probability of exploitation activity in the next 30 days\n~ 14 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2023-03-07  1.28%  0.05%  -1.24 ", "CVSS Scores": "2.1", "CWE": [{"CWE_ID": "CWE-266 Incorrect Privilege Assignment", "CWE_link": "/cwe-details/266/Incorrect-Privilege-Assignment.html"}], "Reference": [{"ref_link": "https://ubuntu.com/USN-4578-1", "ref_desc": "USN-4578-1: Linux kernel vulnerabilities | Ubuntu security notices | UbuntuThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/-LTllk1mT_E8lVrg-81-gJNp3e0.html"}, {"ref_link": "https://launchpad.net/bugs/1900141", "ref_desc": "Bug #1900141 \u201coverlay: permission regression in 5.4.0-51.56 due ...\u201d : Bugs : linux package : UbuntuIssue Tracking;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://ubuntu.com/USN-4576-1", "ref_desc": "USN-4576-1: Linux kernel vulnerabilities | Ubuntu security notices | UbuntuThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/3rVX_VnNffQTsV4NrmwKPWghtjI.html"}, {"ref_link": "https://git.kernel.org/linus/b6650dab404c701d7fe08a108b746542a934da84", "ref_desc": "kernel/git/torvalds/linux.git - Linux kernel source treePatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/linus/05acefb4872dae89e772729efb194af754c877e8", "ref_desc": "kernel/git/torvalds/linux.git - Linux kernel source treePatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://launchpad.net/bugs/1894980", "ref_desc": "Bug #1894980 \u201cCVE-2020-16120: unprivileged overlayfs permission ...\u201d : Bugs : linux package : UbuntuIssue Tracking;Patch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://www.openwall.com/lists/oss-security/2020/10/14/2", "ref_desc": "oss-security - Re: CVE-2020-16120 - incorrect unprivileged overlayfs permission checkingMailing List;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/linus/48bd024b8a40d73ad6b086de2615738da0c7004f", "ref_desc": "kernel/git/torvalds/linux.git - Linux kernel source treePatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://ubuntu.com/USN-4577-1", "ref_desc": "USN-4577-1: Linux kernel vulnerabilities | Ubuntu security notices | UbuntuThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/Sn7_f7UNXG4ctqLr2f4oLudUok0.html"}, {"ref_link": "https://git.kernel.org/linus/d1d04ef8572bc8c22265057bd3d5a79f223f8f52", "ref_desc": "kernel/git/torvalds/linux.git - Linux kernel source treePatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://git.kernel.org/linus/56230d956739b9cb1cbde439d76227d77979a04d", "ref_desc": "kernel/git/torvalds/linux.git - Linux kernel source treePatch;Third Party Advisory", "ref_cve_link": "N/A"}]}