{"CVE Code": "CVE-2021-21328", "Description": "Vapor is a web framework for Swift. In Vapor before version 4.40.1, there is a DoS attack against anyone who Bootstraps a metrics backend for their Vapor app. The following is the attack vector: 1. send unlimited requests against a vapor instance with different paths. this will create unlimited counters and timers, which will eventually drain the system. 2. downstream services might suffer from this attack as well by being spammed with error paths. This has been patched in 4.40.1. The `DefaultResponder` will rewrite any undefined route paths for to `vapor_route_undefined` to avoid unlimited counters.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2021-21328", "Vulnerability Categories": "Denial of service", "Affected Products": "\nVapor Project\u00bbVapor\u00bbForSwiftVersions  before (<) 4.40.1cpe:2.3:a:vapor_project:vapor:*:*:*:*:*:swift:*:*Matching versions", "EPSS Score": "0.21% Probability of exploitation activity in the next 30 days\n~ 59 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.18%  0.21%  +0.03 \n 2  2024-12-16  0.15%  0.18%  +0.03 \n 3  2023-11-11  0.14%  0.15%  +0.02 \n 4  2023-10-02  0.13%  0.14%  +0.00 \n 5  2023-09-06  0.13%  0.13%  +0.00 \n 6  2023-03-07  1.02%  0.13%  -0.89 ", "CVSS Scores": "5.0", "CWE": [{"CWE_ID": "CWE-400 Uncontrolled Resource Consumption", "CWE_link": "/cwe-details/400/Uncontrolled-Resource-Consumption.html"}], "Reference": [{"ref_link": "https://github.com/vapor/vapor/commit/e3aa712508db2854ac0ab905696c65fd88fa7e23", "ref_desc": "Merge pull request from GHSA-gcj9-jj38-hwmc \u00b7 vapor/vapor@e3aa712 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/vapor/vapor/security/advisories/GHSA-gcj9-jj38-hwmc", "ref_desc": "Vapor's Metrics integration could cause a system drain \u00b7 Advisory \u00b7 vapor/vapor \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://vapor.codes/", "ref_desc": "Product", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/vapor/vapor/releases/tag/4.40.1", "ref_desc": "Release Rewrite metrics path and method to undefined for unknown routes \u00b7 vapor/vapor \u00b7 GitHubRelease Notes;Third Party Advisory", "ref_cve_link": "N/A"}]}