{"CVE Code": "CVE-2022-32209", "Description": "# Possible XSS Vulnerability in Rails::Html::SanitizerThere is a possible XSS vulnerability with certain configurations of Rails::Html::Sanitizer.This vulnerability has been assigned the CVE identifier CVE-2022-32209.Versions Affected: ALLNot affected: NONEFixed Versions: v1.4.3## ImpactA possible XSS vulnerability with certain configurations of Rails::Html::Sanitizer may allow an attacker to inject content if the application developer has overridden the sanitizer's allowed tags to allow both `select` and `style` elements.Code is only impacted if allowed tags are being overridden. This may be done via application configuration:```ruby# In config/application.rbconfig.action_view.sanitized_allowed_tags = [\"select\", \"style\"]```see https://guides.rubyonrails.org/configuring.html#configuring-action-viewOr it may be done with a `:tags` option to the Action View helper `sanitize`:```<%= sanitize @comment.body, tags: [\"select\", \"style\"] %>```see https://api.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html#method-i-sanitizeOr it may be done with Rails::Html::SafeListSanitizer directly:```ruby# class-level optionRails::Html::SafeListSanitizer.allowed_tags = [\"select\", \"style\"]```or```ruby# instance-level optionRails::Html::SafeListSanitizer.new.sanitize(@article.body, tags: [\"select\", \"style\"])```All users overriding the allowed tags by any of the above mechanisms to include both \"select\" and \"style\" should either upgrade or use one of the workarounds immediately.## ReleasesThe FIXED releases are available at the normal locations.## WorkaroundsRemove either `select` or `style` from the overridden allowed tags.## CreditsThis vulnerability was responsibly reported by [windshock](https://hackerone.com/windshock?type=user).", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-32209", "Vulnerability Categories": "Cross site scripting (XSS)", "Affected Products": "\nDebian\u00bbDebian Linux\u00bbVersion:10.0cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*Matching versions\nFedoraproject\u00bbFedora\u00bbVersion:35cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*Matching versions\nFedoraproject\u00bbFedora\u00bbVersion:36cpe:2.3:o:fedoraproject:fedora:36:*:*:*:*:*:*:*Matching versions\nRubyonrails\u00bbRails Html Sanitizers\u00bbForRailsVersions  before (<) 1.4.3cpe:2.3:a:rubyonrails:rails_html_sanitizers:*:*:*:*:*:rails:*:*Matching versions", "EPSS Score": "0.24% Probability of exploitation activity in the next 30 days\n~ 61 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.13%  0.24%  +0.11 \n 2  2024-02-02  0.12%  0.13%  +0.01 \n 3  2024-01-15  0.10%  0.12%  +0.01 \n 4  2023-12-05  0.09%  0.10%  +0.01 \n 5  2023-11-08  0.10%  0.09%  0.00 \n 6  2023-07-27  0.09%  0.10%  +0.01 \n 7  2023-07-01  0.05%  0.09%  +0.04 \n 8  2023-03-07  1.02%  0.05%  -0.97 ", "CVSS Scores": "4.3", "CWE": [{"CWE_ID": "CWE-79 Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "CWE_link": "/cwe-details/79/Improper-Neutralization-of-Input-During-Web-Page-Generation-.html"}], "Reference": [{"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/NHDACMCLWE32BZZTSNWQPIFUAD5I6Q47/", "ref_desc": "[SECURITY] Fedora 36 Update: rubygem-rails-html-sanitizer-1.4.3-1.fc36 - package-announce - Fedora Mailing-ListsMailing List;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://hackerone.com/reports/1530898", "ref_desc": "#1530898 Rails::Html::SafeListSanitizer vulnerable to xss attack in an environment that allows the style tagExploit;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/NHDACMCLWE32BZZTSNWQPIFUAD5I6Q47/", "ref_desc": "[SECURITY] Fedora 36 Update: rubygem-rails-html-sanitizer-1.4.3-1.fc36 - package-announce - Fedora Mailing-ListsMailing List;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.debian.org/debian-lts-announce/2022/12/msg00012.html", "ref_desc": "[SECURITY] [DLA 3227-1] ruby-rails-html-sanitizer security updateMailing List;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/AGRLWBEB3S5AU3D4TTROIS7O6QPHDTRH/", "ref_desc": "[SECURITY] Fedora 35 Update: rubygem-rails-html-sanitizer-1.4.3-1.fc35 - package-announce - Fedora Mailing-ListsMailing List;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/AGRLWBEB3S5AU3D4TTROIS7O6QPHDTRH/", "ref_desc": "[SECURITY] Fedora 35 Update: rubygem-rails-html-sanitizer-1.4.3-1.fc35 - package-announce - Fedora Mailing-ListsMailing List;Third Party Advisory", "ref_cve_link": "N/A"}]}