{"CVE Code": "CVE-2022-31093", "Description": "NextAuth.js is a complete open source authentication solution for Next.js applications. In affected versions an attacker can send a request to an app using NextAuth.js with an invalid `callbackUrl` query parameter, which internally is converted to a `URL` object. The URL instantiation would fail due to a malformed URL being passed into the constructor, causing it to throw an unhandled error which led to the **API route handler timing out and logging in to fail**. This has been remedied in versions 3.29.5 and 4.5.0. If for some reason you cannot upgrade, the workaround requires you to rely on Advanced Initialization. Please see the documentation for more.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-31093", "Vulnerability Categories": "N/A", "Affected Products": "\nNextauth.js\u00bbNext-auth\u00bbForNode.jsVersions  from including (>=) 4.0.0andbefore (<) 4.5.0cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*Matching versions\nNextauth.js\u00bbNext-auth\u00bbForNode.jsVersions  from including (>=) 3.0.0andbefore (<) 3.29.5cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*Matching versions", "EPSS Score": "0.17% Probability of exploitation activity in the next 30 days\n~ 52 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-02-16  0.14%  0.17%  +0.03 \n 2  2024-02-02  0.12%  0.14%  +0.02 \n 3  2024-01-18  0.13%  0.12%  0.00 \n 4  2023-12-08  0.11%  0.13%  +0.01 \n 5  2023-07-30  0.10%  0.11%  +0.02 \n 6  2023-07-04  0.07%  0.10%  +0.03 \n 7  2023-05-28  0.06%  0.07%  +0.01 \n 8  2023-03-07  1.02%  0.06%  -0.96 ", "CVSS Scores": "5.0", "CWE": [{"CWE_ID": "CWE-754 Improper Check for Unusual or Exceptional Conditions", "CWE_link": "/cwe-details/754/Improper-Check-for-Unusual-or-Exceptional-Conditions.html"}], "Reference": [{"ref_link": "https://next-auth.js.org/configuration/initialization#advanced-initialization", "ref_desc": "Initialization | NextAuth.jsVendor AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/7sj56KZ6sNRCDWaPqss-m-HzKDA.html"}, {"ref_link": "https://github.com/nextauthjs/next-auth/security/advisories/GHSA-g5fm-jp9v-2432", "ref_desc": "Improper Handling of `callbackUrl` parameter in next-auth \u00b7 Advisory \u00b7 nextauthjs/next-auth \u00b7 GitHubMitigation;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/nextauthjs/next-auth/commit/e498483b23273d1bfc81be68339607f88d411bd6", "ref_desc": "test: add test for invalid `callbackUrl` handling \u00b7 nextauthjs/next-auth@e498483 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/nextauthjs/next-auth/commit/25517b73153332d948114bacdff3b5908de91d85", "ref_desc": "fix: handle invalid `callbackUrl` \u00b7 nextauthjs/next-auth@25517b7 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}]}