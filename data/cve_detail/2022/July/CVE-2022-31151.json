{"CVE Code": "CVE-2022-31151", "Description": "Authorization headers are cleared on cross-origin redirect. However, cookie headers which are sensitive headers and are official headers found in the spec, remain uncleared. There are active users using cookie headers in undici. This may lead to accidental leakage of cookie to a 3rd-party site or a malicious attacker who can control the redirection target (ie. an open redirector) to leak the cookie to the 3rd party site. This was patched in v5.7.1. By default, this vulnerability is not exploitable. Do not enable redirections, i.e. `maxRedirections: 0` (the default).", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-31151", "Vulnerability Categories": "Open redirect", "Affected Products": "\nNodejs\u00bbUndici\u00bbForNode.jsVersions  before (<) 5.7.1cpe:2.3:a:nodejs:undici:*:*:*:*:*:node.js:*:*Matching versions", "EPSS Score": "0.15% Probability of exploitation activity in the next 30 days\n~ 52 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.13%  0.15%  +0.03 \n 2  2024-10-11  0.10%  0.13%  +0.03 \n 3  2024-02-10  0.09%  0.10%  +0.01 \n 4  2023-12-31  0.08%  0.09%  +0.01 \n 5  2023-08-22  0.07%  0.08%  +0.01 \n 6  2023-07-27  0.06%  0.07%  +0.01 \n 7  2023-06-20  0.05%  0.06%  +0.01 \n 8  2023-03-07  1.02%  0.05%  -0.97 \n 9  2023-02-22  7.18%  1.02%  -6.16 ", "CVSS Scores": "6.5", "CWE": [{"CWE_ID": "CWE-346 Origin Validation Error", "CWE_link": "/cwe-details/346/Origin-Validation-Error.html"}, {"CWE_ID": "CWE-601 URL Redirection to Untrusted Site ('Open Redirect')", "CWE_link": "/cwe-details/601/URL-Redirection-to-Untrusted-Site-Open-Redirect-.html"}], "Reference": [{"ref_link": "https://security.netapp.com/advisory/ntap-20220909-0006/", "ref_desc": "CVE-2022-31151 Node.js Vulnerability in NetApp Products | NetApp Product SecurityThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/nodejs/undici/issues/872", "ref_desc": "`authorization` header is not deleted on redirects to third party origins \u00b7 Issue #872 \u00b7 nodejs/undici \u00b7 GitHubExploit;Issue Tracking;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://hackerone.com/reports/1635514", "ref_desc": "HackerOnePermissions Required;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/nodejs/undici/security/advisories/GHSA-q768-x9m6-m9qp", "ref_desc": "Cookies uncleared on cross-host / cross-origin redirect \u00b7 Advisory \u00b7 nodejs/undici \u00b7 GitHubThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/yZZFAK6aK-1AlvSuVx7orqIMgFQ.html"}]}