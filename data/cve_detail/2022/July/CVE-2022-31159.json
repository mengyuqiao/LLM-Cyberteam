{"CVE Code": "CVE-2022-31159", "Description": "The AWS SDK for Java enables Java developers to work with Amazon Web Services. A partial-path traversal issue exists within the `downloadDirectory` method in the AWS S3 TransferManager component of the AWS SDK for Java v1 prior to version 1.12.261. Applications using the SDK control the `destinationDirectory` argument, but S3 object keys are determined by the application that uploaded the objects. The `downloadDirectory` method allows the caller to pass a filesystem object in the object key but contained an issue in the validation logic for the key name. A knowledgeable actor could bypass the validation logic by including a UNIX double-dot in the bucket key. Under certain conditions, this could permit them to retrieve a directory from their S3 bucket that is one level up in the filesystem from their working directory. This issue\u2019s scope is limited to directories whose name prefix matches the destinationDirectory. E.g. for destination directory`/tmp/foo`, the actor can cause a download to `/tmp/foo-bar`, but not `/tmp/bar`. If `com.amazonaws.services.s3.transfer.TransferManager::downloadDirectory` is used to download an untrusted buckets contents, the contents of that bucket can be written outside of the intended destination directory. Version 1.12.261 contains a patch for this issue. As a workaround, when calling `com.amazonaws.services.s3.transfer.TransferManager::downloadDirectory`, pass a `KeyFilter` that forbids `S3ObjectSummary` objects that `getKey` method return a string containing the substring `..` .", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-31159", "Vulnerability Categories": "Directory traversal", "Affected Products": "\nAmazon\u00bbAws-sdk-javaVersions  up to, including, (<=) 1.12.260cpe:2.3:a:amazon:aws-sdk-java:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.07% Probability of exploitation activity in the next 30 days\n~ 32 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.05%  0.07%  +0.02 \n 2  2024-02-05  0.05%  0.05%  0.00 \n 3  2023-07-22  0.05%  0.05%  0.00 \n 4  2023-06-15  0.05%  0.05%  +0.01 \n 5  2023-03-07  0.89%  0.05%  -0.84 ", "CVSS Scores": "6.5", "CWE": [{"CWE_ID": "CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')", "CWE_link": "/cwe-details/22/Improper-Limitation-of-a-Pathname-to-a-Restricted-Directory-.html"}], "Reference": [{"ref_link": "https://github.com/aws/aws-sdk-java/security/advisories/GHSA-c28r-hw5m-5gv3", "ref_desc": "Partial Path Traversal in com.amazonaws:aws-java-sdk-s3 \u00b7 Advisory \u00b7 aws/aws-sdk-java \u00b7 GitHubExploit;Third Party Advisory", "ref_cve_link": "N/A"}]}