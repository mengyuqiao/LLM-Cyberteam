{"CVE Code": "CVE-2022-33891", "Description": "The Apache Spark UI offers the possibility to enable ACLs via the configuration option spark.acls.enable. With an authentication filter, this checks whether a user has access permissions to view or modify the application. If ACLs are enabled, a code path in HttpSecurityFilter can allow someone to perform impersonation by providing an arbitrary user name. A malicious user might then be able to reach a permission check function that will ultimately build a Unix shell command based on their input, and execute it. This will result in arbitrary shell command execution as the user Spark is currently running as. This affects Apache Spark versions 3.0.3 and earlier, versions 3.1.1 to 3.1.2, and versions 3.2.0 to 3.2.1.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-33891", "Vulnerability Categories": "N/A", "Affected Products": "\nApache\u00bbSparkVersions  from including (>=) 3.2.0andup to, including, (<=) 3.2.1cpe:2.3:a:apache:spark:*:*:*:*:*:*:*:*Matching versions\nApache\u00bbSparkVersions  up to, including, (<=) 3.0.3cpe:2.3:a:apache:spark:*:*:*:*:*:*:*:*Matching versions\nApache\u00bbSparkVersions  from including (>=) 3.1.1andup to, including, (<=) 3.1.2cpe:2.3:a:apache:spark:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "97.14% Probability of exploitation activity in the next 30 days\n~ 100 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  97.15%  97.14%  -0.02 \n 2  2024-12-03  97.26%  97.15%  -0.10 \n 3  2024-11-18  97.31%  97.26%  -0.05 \n 4  2024-11-06  97.29%  97.31%  +0.02 \n 5  2024-09-24  97.10%  97.29%  +0.19 \n 6  2024-09-10  97.17%  97.10%  -0.07 \n 7  2024-08-27  97.21%  97.17%  -0.05 \n 8  2024-08-13  97.25%  97.21%  -0.04 \n 9  2024-07-31  97.12%  97.25%  +0.14 \n 10  2024-07-14  97.26%  97.12%  -0.14 \n 11  2024-07-02  97.17%  97.26%  +0.09 \n 12  2024-06-16  97.05%  97.17%  +0.13 \n 13  2024-06-03  97.21%  97.05%  -0.16 \n 14  2024-05-20  97.28%  97.21%  -0.07 \n 15  2024-05-06  97.29%  97.28%  -0.01 \n 16  2024-04-21  97.27%  97.29%  +0.02 \n 17  2024-04-06  97.29%  97.27%  -0.02 \n 18  2024-03-22  97.31%  97.29%  -0.02 \n 19  2024-03-08  97.23%  97.31%  +0.09 \n 20  2024-02-23  97.24%  97.23%  -0.01 \n 21  2024-02-08  97.22%  97.24%  +0.02 \n 22  2024-02-07  97.07%  97.22%  +0.15 \n 23  2024-01-26  96.96%  97.07%  +0.11 \n 24  2024-01-11  96.97%  96.96%  -0.02 \n 25  2023-12-29  96.95%  96.97%  +0.02 \n 26  2023-12-16  96.49%  96.95%  +0.46 \n 27  2023-12-02  96.54%  96.49%  -0.04 \n 28  2023-11-05  96.55%  96.54%  -0.02 \n 29  2023-10-23  96.79%  96.55%  -0.24 ", "CVSS Scores": "8.8", "CWE": [{"CWE_ID": "CWE-77 Improper Neutralization of Special Elements used in a Command ('Command Injection')", "CWE_link": "/cwe-details/77/Improper-Neutralization-of-Special-Elements-used-in-a-Comman.html"}, {"CWE_ID": "CWE-78 Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')", "CWE_link": "/cwe-details/78/Improper-Neutralization-of-Special-Elements-used-in-an-OS-Co.html"}], "Reference": [{"ref_link": "http://www.openwall.com/lists/oss-security/2023/05/02/1", "ref_desc": "oss-security - CVE-2023-32007: Apache Spark: Shell command injection via Spark UIMailing List;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/biDybpYVqQMCd8Ds0-POXQuFni4.html"}, {"ref_link": "http://packetstormsecurity.com/files/168309/Apache-Spark-Unauthenticated-Command-Injection.html", "ref_desc": "Apache Spark Unauthenticated Command Injection \u2248 Packet StormExploit;Third Party Advisory;VDB Entry", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.apache.org/thread/p847l3kopoo5bjtmxrcwk21xp6tjxqlc", "ref_desc": "CVE-2022-33891: Apache Spark shell command injection vulnerability via Spark UI-Apache Mail ArchivesMailing List;Third Party Advisory", "ref_cve_link": "N/A"}]}