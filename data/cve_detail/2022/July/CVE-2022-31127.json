{"CVE Code": "CVE-2022-31127", "Description": "NextAuth.js is a complete open source authentication solution for Next.js applications. An attacker can pass a compromised input to the e-mail [signin endpoint](https://next-auth.js.org/getting-started/rest-api#post-apiauthsigninprovider) that contains some malicious HTML, tricking the e-mail server to send it to the user, so they can perform a phishing attack. Eg.: `balazs@email.com, <a href=\"http://attacker.com\">Before signing in, claim your money!</a>`. This was previously sent to `balazs@email.com`, and the content of the email containing a link to the attacker's site was rendered in the HTML. This has been remedied in the following releases, by simply not rendering that e-mail in the HTML, since it should be obvious to the receiver what e-mail they used: next-auth v3 users before version 3.29.8 are impacted. (We recommend upgrading to v4, as v3 is considered unmaintained. next-auth v4 users before version 4.9.0 are impacted. If for some reason you cannot upgrade, the workaround requires you to sanitize the `email` parameter that is passed to `sendVerificationRequest` and rendered in the HTML. If you haven't created a custom `sendVerificationRequest`, you only need to upgrade. Otherwise, make sure to either exclude `email` from the HTML body or efficiently sanitize it.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-31127", "Vulnerability Categories": "Cross site scripting (XSS)", "Affected Products": "\nNextauth.js\u00bbNext-auth\u00bbForNode.jsVersions  before (<) 3.29.8cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*Matching versions\nNextauth.js\u00bbNext-auth\u00bbForNode.jsVersions  from including (>=) 4.0.0andbefore (<) 4.9.0cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*Matching versions", "EPSS Score": "0.14% Probability of exploitation activity in the next 30 days\n~ 50 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.11%  0.14%  +0.03 \n 2  2024-01-27  0.12%  0.11%  0.00 \n 3  2023-12-17  0.10%  0.12%  +0.02 \n 4  2023-10-11  0.09%  0.10%  +0.00 \n 5  2023-08-08  0.08%  0.09%  +0.02 \n 6  2023-07-13  0.06%  0.08%  +0.02 \n 7  2023-06-06  0.05%  0.06%  +0.01 \n 8  2023-03-07  1.02%  0.05%  -0.97 ", "CVSS Scores": "4.3", "CWE": [{"CWE_ID": "CWE-79 Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "CWE_link": "/cwe-details/79/Improper-Neutralization-of-Input-During-Web-Page-Generation-.html"}], "Reference": [{"ref_link": "https://github.com/nextauthjs/next-auth/commit/ae834f1e08a4a9915665eecb9479c74c6b039c9c", "ref_desc": "feat(providers): allow styling e-mail through `theme` option (#4841) \u00b7 nextauthjs/next-auth@ae834f1 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://next-auth.js.org/providers/email#customizing-emails", "ref_desc": "Email | NextAuth.jsVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/nextauthjs/next-auth/releases/tag/next-auth%40v4.9.0", "ref_desc": "Release next-auth@v4.9.0 \u00b7 nextauthjs/next-auth \u00b7 GitHubRelease Notes;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://next-auth.js.org/getting-started/upgrade-v4", "ref_desc": "Upgrade Guide (v4) | NextAuth.jsVendor AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/tsG6p_vYvvzw7iuygwnn6d5OYCg.html"}, {"ref_link": "https://github.com/nextauthjs/next-auth/security/advisories/GHSA-pgjx-7f9g-9463", "ref_desc": "Improper handling of email input \u00b7 Advisory \u00b7 nextauthjs/next-auth \u00b7 GitHubExploit;Third Party Advisory", "ref_cve_link": "N/A"}]}