{"CVE Code": "CVE-2022-24730", "Description": "Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes. Argo CD starting with version 1.3.0 but before versions 2.1.11, 2.2.6, and 2.3.0 is vulnerable to a path traversal bug, compounded by an improper access control bug, allowing a malicious user with read-only repository access to leak sensitive files from Argo CD's repo-server. A malicious Argo CD user who has been granted `get` access for a repository containing a Helm chart can craft an API request to the `/api/v1/repositories/{repo_url}/appdetails` endpoint to leak the contents of out-of-bounds files from the repo-server. The malicious payload would reference an out-of-bounds file, and the contents of that file would be returned as part of the response. Contents from a non-YAML file may be returned as part of an error message. The attacker would have to know or guess the location of the target file. Sensitive files which could be leaked include files from other Applications' source repositories or any secrets which have been mounted as files on the repo-server. This vulnerability is patched in Argo CD versions 2.1.11, 2.2.6, and 2.3.0. The patches prevent path traversal and limit access to users who either A) have been granted Application `create` privileges or B) have been granted Application `get` privileges and are requesting details for a `repo_url` that has already been used for the given Application. There are currently no known workarounds.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-24730", "Vulnerability Categories": "Directory traversal", "Affected Products": "\nArgoproj\u00bbArgo CdVersions  from including (>=) 2.2.0andbefore (<) 2.2.6cpe:2.3:a:argoproj:argo_cd:*:*:*:*:*:*:*:*Matching versions\nArgoproj\u00bbArgo CdVersions  from including (>=) 1.3.0andbefore (<) 2.1.11cpe:2.3:a:argoproj:argo_cd:*:*:*:*:*:*:*:*Matching versions\nArgoproj\u00bbArgo Cd\u00bbVersion:2.3.0UpdateRC1cpe:2.3:a:argoproj:argo_cd:2.3.0:rc1:*:*:*:*:*:*Matching versions\nArgoproj\u00bbArgo Cd\u00bbVersion:2.3.0UpdateRC2cpe:2.3:a:argoproj:argo_cd:2.3.0:rc2:*:*:*:*:*:*Matching versions\nArgoproj\u00bbArgo Cd\u00bbVersion:2.3.0UpdateRC4cpe:2.3:a:argoproj:argo_cd:2.3.0:rc4:*:*:*:*:*:*Matching versions\nArgoproj\u00bbArgo Cd\u00bbVersion:2.3.0UpdateRC5cpe:2.3:a:argoproj:argo_cd:2.3.0:rc5:*:*:*:*:*:*Matching versions", "EPSS Score": "0.07% Probability of exploitation activity in the next 30 days\n~ 33 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.09%  0.07%  -0.02 \n 2  2024-09-18  0.07%  0.09%  +0.03 \n 3  2023-10-15  0.07%  0.07%  0.00 \n 4  2023-09-03  0.07%  0.07%  0.00 \n 5  2023-03-30  0.06%  0.07%  +0.01 \n 6  2023-03-07  0.89%  0.06%  -0.82 ", "CVSS Scores": "4.0", "CWE": [{"CWE_ID": "CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')", "CWE_link": "/cwe-details/22/Improper-Limitation-of-a-Pathname-to-a-Restricted-Directory-.html"}, {"CWE_ID": "CWE-209 Generation of Error Message Containing Sensitive Information", "CWE_link": "/cwe-details/209/Generation-of-Error-Message-Containing-Sensitive-Information.html"}, {"CWE_ID": "CWE-284 Improper Access Control", "CWE_link": "/cwe-details/284/Improper-Access-Control.html"}, {"CWE_ID": "CWE-863 Incorrect Authorization", "CWE_link": "/cwe-details/863/Incorrect-Authorization.html"}], "Reference": [{"ref_link": "https://github.com/argoproj/argo-cd/security/advisories/GHSA-r9cr-hvjj-496v", "ref_desc": "Path traversal and improper access control allows leaking out-of-bound files from Argo CD repo-server \u00b7 Advisory \u00b7 argoproj/argo-cd \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}]}