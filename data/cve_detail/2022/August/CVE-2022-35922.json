{"CVE Code": "CVE-2022-35922", "Description": "Rust-WebSocket is a WebSocket (RFC6455) library written in Rust. In versions prior to 0.26.5 untrusted websocket connections can cause an out-of-memory (OOM) process abort in a client or a server. The root cause of the issue is during dataframe parsing. Affected versions would allocate a buffer based on the declared dataframe size, which may come from an untrusted source. When `Vec::with_capacity` fails to allocate, the default Rust allocator will abort the current process, killing all threads. This affects only sync (non-Tokio) implementation. Async version also does not limit memory, but does not use `with_capacity`, so DoS can happen only when bytes for oversized dataframe or message actually got delivered by the attacker. The crashes are fixed in version 0.26.5 by imposing default dataframe size limits. Affected users are advised to update to this version. Users unable to upgrade are advised to filter websocket traffic externally or to only accept trusted traffic.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-35922", "Vulnerability Categories": "Denial of service", "Affected Products": "\nFedoraproject\u00bbFedora\u00bbVersion:35cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*Matching versions\nFedoraproject\u00bbFedora\u00bbVersion:36cpe:2.3:o:fedoraproject:fedora:36:*:*:*:*:*:*:*Matching versions\nRust-websocket Project\u00bbRust-websocketVersions  before (<) 0.26.5cpe:2.3:a:rust-websocket_project:rust-websocket:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.13% Probability of exploitation activity in the next 30 days\n~ 48 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.18%  0.13%  -0.05 \n 2  2024-03-22  0.17%  0.18%  +0.01 \n 3  2024-03-08  0.15%  0.17%  +0.02 \n 4  2024-02-22  0.11%  0.15%  +0.04 \n 5  2024-01-12  0.10%  0.11%  +0.01 \n 6  2023-11-08  0.09%  0.10%  +0.01 \n 7  2023-09-03  0.07%  0.09%  +0.01 \n 8  2023-08-08  0.06%  0.07%  +0.01 \n 9  2023-07-02  0.05%  0.06%  +0.01 \n 10  2023-03-07  1.02%  0.05%  -0.97 ", "CVSS Scores": "7.5", "CWE": [{"CWE_ID": "CWE-119 Improper Restriction of Operations within the Bounds of a Memory Buffer", "CWE_link": "/cwe-details/119/Improper-Restriction-of-Operations-within-the-Bounds-of-a-Me.html"}, {"CWE_ID": "CWE-400 Uncontrolled Resource Consumption", "CWE_link": "/cwe-details/400/Uncontrolled-Resource-Consumption.html"}, {"CWE_ID": "CWE-770 Allocation of Resources Without Limits or Throttling", "CWE_link": "/cwe-details/770/Allocation-of-Resources-Without-Limits-or-Throttling.html"}], "Reference": [{"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/HYPNCM4H4OFBIZI6XMJ2DUTS54FT2TWP/", "ref_desc": "[SECURITY] Fedora 35 Update: rust-ffsend-0.2.71-3.fc35 - package-announce - Fedora Mailing-ListsMailing List;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/websockets-rs/rust-websocket/security/advisories/GHSA-qrjv-rf5q-qpxc", "ref_desc": "Memory allocation based on untrusted length \u00b7 Advisory \u00b7 websockets-rs/rust-websocket \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/websockets-rs/rust-websocket/commit/cbf6e9983e839d2ecad86de8cd1b3f20ed43390b", "ref_desc": "Implement dataframe and message size limits \u00b7 websockets-rs/rust-websocket@cbf6e99 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/4V2EOOU5OLEHVMKAH6BALQXKDKIZRXCI/", "ref_desc": "[SECURITY] Fedora 36 Update: rust-ffsend-0.2.76-2.fc36 - package-announce - Fedora Mailing-ListsMailing List;Third Party Advisory", "ref_cve_link": "N/A"}]}