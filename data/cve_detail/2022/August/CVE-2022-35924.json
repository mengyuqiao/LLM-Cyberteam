{"CVE Code": "CVE-2022-35924", "Description": "NextAuth.js is a complete open source authentication solution for Next.js applications. `next-auth` users who are using the `EmailProvider` either in versions before `4.10.3` or `3.29.10` are affected. If an attacker could forge a request that sent a comma-separated list of emails (eg.: `attacker@attacker.com,victim@victim.com`) to the sign-in endpoint, NextAuth.js would send emails to both the attacker and the victim's e-mail addresses. The attacker could then login as a newly created user with the email being `attacker@attacker.com,victim@victim.com`. This means that basic authorization like `email.endsWith(\"@victim.com\")` in the `signIn` callback would fail to communicate a threat to the developer and would let the attacker bypass authorization, even with an `@attacker.com` address. This vulnerability has been patched in `v4.10.3` and `v3.29.10` by normalizing the email value that is sent to the sign-in endpoint before accessing it anywhere else. We also added a `normalizeIdentifier` callback on the `EmailProvider` configuration, where you can further tweak your requirements for what your system considers a valid e-mail address. (E.g.: strict RFC2821 compliance). Users are advised to upgrade. There are no known workarounds for this vulnerability. If for some reason you cannot upgrade, you can normalize the incoming request using Advanced Initialization.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-35924", "Vulnerability Categories": "Input validation", "Affected Products": "\nNextauth.js\u00bbNext-auth\u00bbForNode.jsVersions  from including (>=) 4.0.0andbefore (<) 4.10.3cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*Matching versions\nNextauth.js\u00bbNext-auth\u00bbForNode.jsVersions  before (<) 3.29.10cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*Matching versions", "EPSS Score": "0.30% Probability of exploitation activity in the next 30 days\n~ 69 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.34%  0.30%  -0.04 \n 2  2024-02-23  0.32%  0.34%  +0.02 \n 3  2024-01-13  0.27%  0.32%  +0.05 \n 4  2023-11-07  0.22%  0.27%  +0.05 \n 5  2023-08-09  0.11%  0.22%  +0.11 \n 6  2023-07-03  0.10%  0.11%  +0.02 \n 7  2023-03-07  1.18%  0.10%  -1.08 ", "CVSS Scores": "9.1", "CWE": [{"CWE_ID": "CWE-20 Improper Input Validation", "CWE_link": "/cwe-details/20/Improper-Input-Validation.html"}, {"CWE_ID": "CWE-863 Incorrect Authorization", "CWE_link": "/cwe-details/863/Incorrect-Authorization.html"}], "Reference": [{"ref_link": "https://github.com/nextauthjs/next-auth/commit/afb1fcdae3cc30445038ef588e491d139b916003", "ref_desc": "fix(providers): add `normalizeIdentifier` to EmailProvider \u00b7 nextauthjs/next-auth@afb1fcd \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/nextauthjs/next-auth/security/advisories/GHSA-xv97-c62v-4587", "ref_desc": "Sending verification requests (magic link) to unwanted emails \u00b7 Advisory \u00b7 nextauthjs/next-auth \u00b7 GitHubMitigation;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://next-auth.js.org/configuration/initialization#advanced-initialization", "ref_desc": "Initialization | NextAuth.jsVendor AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/7sj56KZ6sNRCDWaPqss-m-HzKDA.html"}, {"ref_link": "https://nodemailer.com/message/addresses", "ref_desc": "Address object :: NodemailerThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://next-auth.js.org/configuration/callbacks#sign-in-callback", "ref_desc": "Callbacks | NextAuth.jsVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://en.wikipedia.org/wiki/Email_address#Local-part", "ref_desc": "Email address - WikipediaThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://next-auth.js.org/providers/email#normalizing-the-e-mail-address", "ref_desc": "Email | NextAuth.jsVendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://next-auth.js.org/providers/email", "ref_desc": "Email | NextAuth.jsVendor Advisory", "ref_cve_link": "N/A"}]}