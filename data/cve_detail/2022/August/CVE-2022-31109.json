{"CVE Code": "CVE-2022-31109", "Description": "laminas-diactoros is a PHP package containing implementations of the PSR-7 HTTP message interfaces and PSR-17 HTTP message factory interfaces. Applications that use Diactoros, and are either not behind a proxy, or can be accessed via untrusted proxies, can potentially have the host, protocol, and/or port of a `Laminas\\Diactoros\\Uri` instance associated with the incoming server request modified to reflect values from `X-Forwarded-*` headers. Such changes can potentially lead to XSS attacks (if a fully-qualified URL is used in links) and/or URL poisoning. Since the `X-Forwarded-*` headers do have valid use cases, particularly in clustered environments using a load balancer, the library offers mitigation measures only in the v2 releases, as doing otherwise would break these use cases immediately. Users of v2 releases from 2.11.1 can provide an additional argument to `Laminas\\Diactoros\\ServerRequestFactory::fromGlobals()` in the form of a `Laminas\\Diactoros\\RequestFilter\\RequestFilterInterface` instance, including the shipped `Laminas\\Diactoros\\RequestFilter\\NoOpRequestFilter` implementation which ignores the `X-Forwarded-*` headers. Starting in version 3.0, the library will reverse behavior to use the `NoOpRequestFilter` by default, and require users to opt-in to `X-Forwarded-*` header usage via a configured `Laminas\\Diactoros\\RequestFilter\\LegacyXForwardedHeaderFilter` instance. Users are advised to upgrade to version 2.11.1 or later to resolve this issue. Users unable to upgrade may configure web servers to reject `X-Forwarded-*` headers at the web server level.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-31109", "Vulnerability Categories": "Cross site scripting (XSS)", "Affected Products": "\nGetlaminas\u00bbLaminas-diactorosVersions  before (<) 2.11.1cpe:2.3:a:getlaminas:laminas-diactoros:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.08% Probability of exploitation activity in the next 30 days\n~ 33 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-02-22  0.08%  0.08%  +0.00 \n 2  2024-01-12  0.07%  0.08%  +0.01 \n 3  2023-09-03  0.07%  0.07%  +0.01 \n 4  2023-07-02  0.06%  0.07%  +0.00 \n 5  2023-03-07  0.95%  0.06%  -0.89 ", "CVSS Scores": "6.1", "CWE": [{"CWE_ID": "CWE-79 Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "CWE_link": "/cwe-details/79/Improper-Neutralization-of-Input-During-Web-Page-Generation-.html"}, {"CWE_ID": "CWE-444 Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')", "CWE_link": "/cwe-details/444/Inconsistent-Interpretation-of-HTTP-Requests-HTTP-Request-.html"}], "Reference": [{"ref_link": "https://github.com/laminas/laminas-diactoros/security/advisories/GHSA-8274-h5jp-97vr", "ref_desc": "HTTP Host Header Attack Vulnerability \u00b7 Advisory \u00b7 laminas/laminas-diactoros \u00b7 GitHubMitigation;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://portswigger.net/web-security/host-header", "ref_desc": "HTTP Host header attacks | Web Security AcademyThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/P_uKTdtBMug-SMXec6zeRM0XL2s.html"}, {"ref_link": "https://github.com/laminas/laminas-diactoros/commit/25b11d422c2e5dad868f68619888763b30f91e2d", "ref_desc": "Merge pull request from GHSA-8274-h5jp-97vr \u00b7 laminas/laminas-diactoros@25b11d4 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}]}