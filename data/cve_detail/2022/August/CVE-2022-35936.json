{"CVE Code": "CVE-2022-35936", "Description": "Ethermint is an Ethereum library. In Ethermint running versions before `v0.17.2`, the contract `selfdestruct` invocation permanently removes the corresponding bytecode from the internal database storage. However, due to a bug in the `DeleteAccount`function, all contracts that used the identical bytecode (i.e shared the same `CodeHash`) will also stop working once one contract invokes `selfdestruct`, even though the other contracts did not invoke the `selfdestruct` OPCODE. This vulnerability has been patched in Ethermint version v0.18.0. The patch has state machine-breaking changes for applications using Ethermint, so a coordinated upgrade procedure is required. A workaround is available. If a contract is subject to DoS due to this issue, the user can redeploy the same contract, i.e. with identical bytecode, so that the original contract's code is recovered. The new contract deployment restores the `bytecode hash -> bytecode` entry in the internal state.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-35936", "Vulnerability Categories": "Denial of service", "Affected Products": "\nCrypto\u00bbCronosVersions  up to, including, (<=) 0.7.0cpe:2.3:a:crypto:cronos:*:*:*:*:*:*:*:*Matching versions\nEvmos\u00bbEthermintVersions  before (<) 0.18.0cpe:2.3:a:evmos:ethermint:*:*:*:*:*:*:*:*Matching versions\nEvmos\u00bbEvmosVersions  before (<) 7.0.0cpe:2.3:a:evmos:evmos:*:*:*:*:*:*:*:*Matching versions\nKava\u00bbKavaVersions  before (<) 0.18.0cpe:2.3:a:kava:kava:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.11% Probability of exploitation activity in the next 30 days\n~ 46 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.13%  0.11%  -0.02 \n 2  2024-10-27  0.10%  0.13%  +0.03 \n 3  2024-02-26  0.10%  0.10%  +0.00 \n 4  2024-01-16  0.09%  0.10%  +0.01 \n 5  2023-09-07  0.08%  0.09%  +0.01 \n 6  2023-08-12  0.06%  0.08%  +0.02 \n 7  2023-07-06  0.05%  0.06%  +0.01 \n 8  2023-03-07  0.95%  0.05%  -0.90 ", "CVSS Scores": "5.3", "CWE": [{"CWE_ID": "CWE-668 Exposure of Resource to Wrong Sphere", "CWE_link": "/cwe-details/668/Exposure-of-Resource-to-Wrong-Sphere.html"}], "Reference": [{"ref_link": "https://github.com/evmos/ethermint/security/advisories/GHSA-f92v-grc2-w2fg", "ref_desc": "DoS through unintended Contract Selfdestruct \u00b7 Advisory \u00b7 evmos/ethermint \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/evmos/ethermint/blob/c9d42d667b753147977a725e98ed116c933c76cb/x/evm/keeper/statedb.go#L199-L203", "ref_desc": "ethermint/statedb.go at c9d42d667b753147977a725e98ed116c933c76cb \u00b7 evmos/ethermint \u00b7 GitHubExploit;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/evmos/ethermint/commit/144741832007a26dbe950512acbda4ed95b2a451", "ref_desc": "Merge pull request from GHSA-f92v-grc2-w2fg \u00b7 evmos/ethermint@1447418 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}]}