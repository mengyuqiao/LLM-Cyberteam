{"CVE Code": "CVE-2022-21682", "Description": "Flatpak is a Linux application sandboxing and distribution framework. A path traversal vulnerability affects versions of Flatpak prior to 1.12.3 and 1.10.6. flatpak-builder applies `finish-args` last in the build. At this point the build directory will have the full access that is specified in the manifest, so running `flatpak build` against it will gain those permissions. Normally this will not be done, so this is not problem. However, if `--mirror-screenshots-url` is specified, then flatpak-builder will launch `flatpak build --nofilesystem=host appstream-utils mirror-screenshots` after finalization, which can lead to issues even with the `--nofilesystem=host` protection. In normal use, the only issue is that these empty directories can be created wherever the user has write permissions. However, a malicious application could replace the `appstream-util` binary and potentially do something more hostile. This has been resolved in Flatpak 1.12.3 and 1.10.6 by changing the behaviour of `--nofilesystem=home` and `--nofilesystem=host`.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-21682", "Vulnerability Categories": "Directory traversal", "Affected Products": "\nDebian\u00bbDebian Linux\u00bbVersion:9.0cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*Matching versions\nDebian\u00bbDebian Linux\u00bbVersion:10.0cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*Matching versions\nDebian\u00bbDebian Linux\u00bbVersion:11.0cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*Matching versions\nRedhat\u00bbEnterprise Linux\u00bbVersion:8.0cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*Matching versions\nFedoraproject\u00bbFedora\u00bbVersion:35cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*Matching versions\nFlatpak\u00bbFlatpakVersions  from including (>=) 1.11.1andbefore (<) 1.12.4cpe:2.3:a:flatpak:flatpak:*:*:*:*:*:*:*:*Matching versions\nFlatpak\u00bbFlatpakVersions  before (<) 1.10.7cpe:2.3:a:flatpak:flatpak:*:*:*:*:*:*:*:*Matching versions\nFlatpak\u00bbFlatpak-builderVersions  before (<) 1.2.2cpe:2.3:a:flatpak:flatpak-builder:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.27% Probability of exploitation activity in the next 30 days\n~ 67 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.33%  0.27%  -0.06 \n 2  2024-04-06  0.16%  0.33%  +0.17 \n 3  2023-12-24  0.15%  0.16%  +0.02 \n 4  2023-11-08  0.18%  0.15%  -0.04 \n 5  2023-08-06  0.19%  0.18%  -0.01 \n 6  2023-04-20  0.18%  0.19%  +0.01 \n 7  2023-03-07  1.03%  0.18%  -0.86 ", "CVSS Scores": "4.0", "CWE": [{"CWE_ID": "CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')", "CWE_link": "/cwe-details/22/Improper-Limitation-of-a-Pathname-to-a-Restricted-Directory-.html"}], "Reference": [{"ref_link": "https://github.com/flatpak/flatpak/security/advisories/GHSA-8ch7-5j3h-g4fx", "ref_desc": "CVE-2022-21682: flatpak-builder --mirror-screenshots-url can access files outside the build directory \u00b7 Advisory \u00b7 flatpak/flatpak \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/flatpak/flatpak/commit/445bddeee657fdc8d2a0a1f0de12975400d4fc1a", "ref_desc": "Make --nofilesystem=host/home remove access to subdirs of those \u00b7 flatpak/flatpak@445bdde \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/flatpak/flatpak/commit/4d11f77aa7fd3e64cfa80af89d92567ab9e8e6fa", "ref_desc": "manpages: Document the new details of --nofilesystem behaviour. \u00b7 flatpak/flatpak@4d11f77 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/IXKBERLJRYV7KXKGXOLI6IOXVBQNN4DP/", "ref_desc": "[SECURITY] Fedora 35 Update: flatpak-builder-1.2.2-1.fc35 - package-announce - Fedora Mailing-Lists", "ref_cve_link": "N/A"}, {"ref_link": "https://www.debian.org/security/2022/dsa-5049", "ref_desc": "Debian -- Security Information -- DSA-5049-1 flatpakThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/gaznIhSAb-cALMd_0SVOAC8YkiY.html"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/IXKBERLJRYV7KXKGXOLI6IOXVBQNN4DP/", "ref_desc": "[SECURITY] Fedora 35 Update: flatpak-builder-1.2.2-1.fc35 - package-announce - Fedora Mailing-ListsMailing List;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/APFTBYGJJVJPFVHRXUW5PII5XOAFI4KH/", "ref_desc": "[SECURITY] Fedora 35 Update: flatpak-1.12.3-1.fc35 - package-announce - Fedora Mailing-ListsMailing List;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/nTyAkDaQY-JbvRT7jHE29bSWi4o.html"}, {"ref_link": "https://security.gentoo.org/glsa/202312-12", "ref_desc": "Flatpak: Multiple Vulnerabilities (GLSA 202312-12) \u2014 Gentoo securityCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/QhrImzUJpyGPk8qiCq8575VbcGg.html"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/APFTBYGJJVJPFVHRXUW5PII5XOAFI4KH/", "ref_desc": "[SECURITY] Fedora 35 Update: flatpak-1.12.3-1.fc35 - package-announce - Fedora Mailing-ListsCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/RWB4E5Gl865sU65G5X3qZFsS2FM.html"}]}