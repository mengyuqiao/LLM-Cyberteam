{"CVE Code": "CVE-2022-29246", "Description": "Azure RTOS USBX is a USB host, device, and on-the-go (OTG) embedded stack. Prior to version 6.1.11, he USBX DFU UPLOAD functionality may be utilized to introduce a buffer overflow resulting in overwrite of memory contents. In particular cases this may allow an attacker to bypass security features or execute arbitrary code. The implementation of `ux_device_class_dfu_control_request` function does not assure that a buffer overflow will not occur during handling of the DFU UPLOAD command. When an attacker issues the `UX_SLAVE_CLASS_DFU_COMMAND_UPLOAD` control transfer request with `wLenght` larger than the buffer size (`UX_SLAVE_REQUEST_CONTROL_MAX_LENGTH`, 256 bytes), depending on the actual implementation of `dfu -> ux_slave_class_dfu_read`, a buffer overflow may occur. In example `ux_slave_class_dfu_read` may read 4096 bytes (or more up to 65k) to a 256 byte buffer ultimately resulting in an overflow. Furthermore in case an attacker has some control over the read flash memory, this may result in execution of arbitrary code and platform compromise. A fix for this issue has been included in USBX release 6.1.11. As a workaround, align request and buffer size to assure that buffer boundaries are respected.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-29246", "Vulnerability Categories": "Overflow;Execute code", "Affected Products": "\nMicrosoft\u00bbAzure Rtos UsbxVersions  before (<) 6.1.11cpe:2.3:o:microsoft:azure_rtos_usbx:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "1.69% Probability of exploitation activity in the next 30 days\n~ 87 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  2.39%  1.69%  -0.70 \n 2  2024-12-02  2.02%  2.39%  +0.38 \n 3  2024-11-19  1.43%  2.02%  +0.59 \n 4  2024-06-06  1.24%  1.43%  +0.20 \n 5  2024-03-12  0.87%  1.24%  +0.36 \n 6  2024-02-11  0.79%  0.87%  +0.08 \n 7  2024-01-13  0.53%  0.79%  +0.26 \n 8  2023-12-30  0.46%  0.53%  +0.07 \n 9  2023-12-15  0.41%  0.46%  +0.05 \n 10  2023-11-05  0.35%  0.41%  +0.06 \n 11  2023-08-03  0.35%  0.35%  0.00 \n 12  2023-06-26  0.30%  0.35%  +0.05 \n 13  2023-05-31  0.26%  0.30%  +0.04 \n 14  2023-04-24  0.28%  0.26%  -0.02 \n 15  2023-03-31  0.18%  0.28%  +0.10 \n 16  2023-03-20  0.18%  0.18%  0.00 \n 17  2023-03-07  6.17%  0.18%  -5.99 ", "CVSS Scores": "7.5", "CWE": [{"CWE_ID": "CWE-120 Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')", "CWE_link": "/cwe-details/120/Buffer-Copy-without-Checking-Size-of-Input-Classic-Buffer-.html"}], "Reference": [{"ref_link": "https://github.com/azure-rtos/usbx/blob/master/common/usbx_device_classes/src/ux_device_class_dfu_control_request.c", "ref_desc": "usbx/ux_device_class_dfu_control_request.c at master \u00b7 azure-rtos/usbx \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/azure-rtos/usbx/security/advisories/GHSA-hh5p-x584-j8hv", "ref_desc": "Potential buffer overflow in function DFU upload \u00b7 Advisory \u00b7 azure-rtos/usbx \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/azure-rtos/usbx/releases/tag/v6.1.11_rel", "ref_desc": "Release Azure RTOS 6.1.11 \u00b7 azure-rtos/usbx \u00b7 GitHubRelease Notes;Third Party Advisory", "ref_cve_link": "N/A"}]}