{"CVE Code": "CVE-2022-24897", "Description": "APIs to evaluate content with Velocity is a package for APIs to evaluate content with Velocity. Starting with version 2.3 and prior to 12.6.7, 12.10.3, and 13.0, the velocity scripts are not properly sandboxed against using the Java File API to perform read or write operations on the filesystem. Writing an attacking script in Velocity requires the Script rights in XWiki so not all users can use it, and it also requires finding an XWiki API which returns a File. The problem has been patched in versions 12.6.7, 12.10.3, and 13.0. There is no easy workaround for fixing this vulnerability other than upgrading and being careful when giving Script rights.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-24897", "Vulnerability Categories": "Directory traversal", "Affected Products": "\nXwiki\u00bbXwikiVersions  from including (>=) 12.7andbefore (<) 12.10.3cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*Matching versions\nXwiki\u00bbXwikiVersions  from including (>=) 2.3andbefore (<) 12.6.7cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.46% Probability of exploitation activity in the next 30 days\n~ 75 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.27%  0.46%  +0.19 \n 2  2024-07-24  0.21%  0.27%  +0.06 \n 3  2023-12-22  0.22%  0.21%  -0.01 \n 4  2023-12-08  0.18%  0.22%  +0.04 \n 5  2023-11-23  0.13%  0.18%  +0.04 \n 6  2023-05-09  0.08%  0.13%  +0.05 \n 7  2023-04-02  0.07%  0.08%  +0.01 \n 8  2023-03-07  0.95%  0.07%  -0.88 ", "CVSS Scores": "6.0", "CWE": [{"CWE_ID": "CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')", "CWE_link": "/cwe-details/22/Improper-Limitation-of-a-Pathname-to-a-Restricted-Directory-.html"}, {"CWE_ID": "CWE-668 Exposure of Resource to Wrong Sphere", "CWE_link": "/cwe-details/668/Exposure-of-Resource-to-Wrong-Sphere.html"}], "Reference": [{"ref_link": "https://github.com/xwiki/xwiki-commons/commit/215951cfb0f808d0bf5b1097c9e7d1e503449ab8", "ref_desc": "XWIKI-5168: Don't allow some methods in velocity introspector (#127) \u00b7 xwiki/xwiki-commons@215951c \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://jira.xwiki.org/browse/XWIKI-5168", "ref_desc": "[XWIKI-5168] Arbitrary filesystem write access from velocity. - XWiki.org JIRAExploit;Vendor Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/xwiki/xwiki-commons/security/advisories/GHSA-cvx5-m8vg-vxgc", "ref_desc": "Arbitrary filesystem write access from velocity. \u00b7 Advisory \u00b7 xwiki/xwiki-commons \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/xwiki/xwiki-commons/pull/127", "ref_desc": "XWIKI-5168: Don't allow some methods in velocity introspector by surli \u00b7 Pull Request #127 \u00b7 xwiki/xwiki-commons \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}]}