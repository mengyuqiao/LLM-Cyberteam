{"CVE Code": "CVE-2022-46167", "Description": "Capsule is a multi-tenancy and policy-based framework for Kubernetes. Prior to version 0.1.3, a ServiceAccount deployed in a Tenant Namespace, when granted with `PATCH` capabilities on its own Namespace, is able to edit it and remove the Owner Reference, breaking the reconciliation of the Capsule Operator and removing all the enforcement like Pod Security annotations, Network Policies, Limit Range and Resource Quota items. An attacker could detach the Namespace from a Tenant that is forbidding starting privileged Pods using the Pod Security labels by removing the OwnerReference, removing the enforcement labels, and being able to start privileged containers that would be able to start a generic Kubernetes privilege escalation. Patches have been released for version 0.1.3. No known workarounds are available.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-46167", "Vulnerability Categories": "Gain privilege", "Affected Products": "\nClastix\u00bbCapsuleVersions  before (<) 0.1.3cpe:2.3:a:clastix:capsule:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.14% Probability of exploitation activity in the next 30 days\n~ 50 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-07-23  0.13%  0.14%  +0.01 \n 2  2024-07-09  0.13%  0.13%  +0.01 \n 3  2024-06-24  0.12%  0.13%  +0.01 \n 4  2023-12-09  0.07%  0.12%  +0.05 \n 5  2023-11-02  0.06%  0.07%  +0.01 \n 6  2023-03-07  0.95%  0.06%  -0.89 ", "CVSS Scores": "8.8", "CWE": [{"CWE_ID": "CWE-863 Incorrect Authorization", "CWE_link": "/cwe-details/863/Incorrect-Authorization.html"}], "Reference": [{"ref_link": "https://github.com/clastix/capsule/commit/75525ac19254b0c5111e34d7985e2be7bc8b1ac1", "ref_desc": "fix: preventing serviceaccount privilege escalation \u00b7 clastix/capsule@75525ac \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/clastix/capsule/releases/tag/v0.1.3", "ref_desc": "Release v0.1.3 \u00b7 clastix/capsule \u00b7 GitHubPatch;Release Notes;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/clastix/capsule/security/advisories/GHSA-x45c-cvp8-q4fm", "ref_desc": "Privilege escalation by ServiceAccount deployed in a Tenant Namespace \u00b7 Advisory \u00b7 clastix/capsule \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/clastix/capsule/commit/1df430e71be8c4778c82eca3459978ad7d0b4b7b", "ref_desc": "test: preventing serviceaccount privilege escalation \u00b7 clastix/capsule@1df430e \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}]}