{"CVE Code": "CVE-2022-46152", "Description": "OP-TEE Trusted OS is the secure side implementation of OP-TEE project, a Trusted Execution Environment. Versions prior to 3.19.0, contain an Improper Validation of Array Index vulnerability. The function `cleanup_shm_refs()` is called by both `entry_invoke_command()` and `entry_open_session()`. The commands `OPTEE_MSG_CMD_OPEN_SESSION` and `OPTEE_MSG_CMD_INVOKE_COMMAND` can be executed from the normal world via an OP-TEE SMC. This function is not validating the `num_params` argument, which is only limited to `OPTEE_MSG_MAX_NUM_PARAMS` (127) in the function `get_cmd_buffer()`. Therefore, an attacker in the normal world can craft an SMC call that will cause out-of-bounds reading in `cleanup_shm_refs` and potentially freeing of fake-objects in the function `mobj_put()`. A normal-world attacker with permission to execute SMC instructions may exploit this flaw. Maintainers believe this problem permits local privilege escalation from the normal world to the secure world. Version 3.19.0 contains a fix for this issue. There are no known workarounds.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-46152", "Vulnerability Categories": "Gain privilege", "Affected Products": "\nOp-tee\u00bbOp-tee OsVersions  before (<) 3.19.0cpe:2.3:o:op-tee:op-tee_os:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.05% Probability of exploitation activity in the next 30 days\n~ 22 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.04%  0.05%  +0.01 \n 2  2023-03-07  1.37%  0.04%  -1.32 ", "CVSS Scores": "8.8", "CWE": [{"CWE_ID": "CWE-129 Improper Validation of Array Index", "CWE_link": "/cwe-details/129/Improper-Validation-of-Array-Index.html"}], "Reference": [{"ref_link": "https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H/E:U/RL:X/RC:X/CR:M/IR:M/AR:M/MAV:L/MAC:L/MPR:H/MUI:N/MS:C/MC:H/MI:H/MA:H&version=3.1", "ref_desc": "NVD - CVSS v3 CalculatorThird Party Advisory;US Government Resource", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/OP-TEE/optee_os/blob/c2d449482de098f1c894b94f338440e5a327813d/core/tee/entry_std.c#L257", "ref_desc": "optee_os/entry_std.c at c2d449482de098f1c894b94f338440e5a327813d \u00b7 OP-TEE/optee_os \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/OP-TEE/optee_os/commit/728616b28df659cf0bdde6e58a471f6ef25d023c", "ref_desc": "core: tee_entry: fix array out of bounds check in cleanup_shm_refs() \u00b7 OP-TEE/optee_os@728616b \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/OP-TEE/optee_os/security/advisories/GHSA-65w8-6mrg-52g7", "ref_desc": "Improper Validation of Array Index in the cleanup_shm_refs function \u00b7 Advisory \u00b7 OP-TEE/optee_os \u00b7 GitHubExploit;Third Party Advisory", "ref_cve_link": "N/A"}]}