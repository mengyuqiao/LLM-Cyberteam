{"CVE Code": "CVE-2022-39389", "Description": "Lightning Network Daemon (lnd) is an implementation of a lightning bitcoin overlay network node. All lnd nodes before version `v0.15.4` are vulnerable to a block parsing bug that can cause a node to enter a degraded state once encountered. In this degraded state, nodes can continue to make payments and forward HTLCs, and close out channels. Opening channels is prohibited, and also on chain transaction events will be undetected. This can cause loss of funds if a CSV expiry is researched during a breach attempt or a CLTV delta expires forgetting the funds in the HTLC. A patch is available in `lnd` version 0.15.4. Users are advised to upgrade. Users unable to upgrade may use the `lncli updatechanpolicy` RPC call to increase their CLTV value to a very high amount or increase their fee policies. This will prevent nodes from routing through your node, meaning that no pending HTLCs can be present.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-39389", "Vulnerability Categories": "Input validation", "Affected Products": "\nBtcd Project\u00bbBtcdVersions  before (<) 0.23.3cpe:2.3:a:btcd_project:btcd:*:*:*:*:*:*:*:*Matching versions\nLightning Network Daemon Project\u00bbLightning Network DaemonVersions  before (<) 0.15.4cpe:2.3:a:lightning_network_daemon_project:lightning_network_daemon:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.20% Probability of exploitation activity in the next 30 days\n~ 57 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.10%  0.20%  +0.10 \n 2  2024-06-09  0.08%  0.10%  +0.01 \n 3  2024-04-29  0.08%  0.08%  +0.01 \n 4  2023-12-20  0.07%  0.08%  +0.01 \n 5  2023-11-24  0.05%  0.07%  +0.02 \n 6  2023-10-18  0.05%  0.05%  0.00 \n 7  2023-03-07  1.02%  0.05%  -0.97 ", "CVSS Scores": "6.5", "CWE": [{"CWE_ID": "CWE-20 Improper Input Validation", "CWE_link": "/cwe-details/20/Improper-Input-Validation.html"}], "Reference": [{"ref_link": "https://github.com/lightningnetwork/lnd/issues/7096", "ref_desc": "[bug]: CRITICAL! Unable to process chain reorg / too many witness items to fit into max message size \u00b7 Issue #7096 \u00b7 lightningnetwork/lnd \u00b7 GitHubExploit;Issue Tracking;Patch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/lightningnetwork/lnd/releases/tag/v0.15.4-beta", "ref_desc": "Release lnd v0.15.4-beta \u00b7 lightningnetwork/lnd \u00b7 GitHubRelease Notes;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/lightningnetwork/lnd/pull/7098", "ref_desc": "mod+build: bump btcd version to v0.23.3 and bump lnd version to v0.15.4-beta by guggero \u00b7 Pull Request #7098 \u00b7 lightningnetwork/lnd \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/lightningnetwork/lnd/security/advisories/GHSA-hc82-w9v8-83pr", "ref_desc": "Witness Block Parsing DoS Vulnerability \u00b7 Advisory \u00b7 lightningnetwork/lnd \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}]}