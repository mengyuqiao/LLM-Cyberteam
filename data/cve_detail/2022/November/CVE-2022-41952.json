{"CVE Code": "CVE-2022-41952", "Description": "Synapse before 1.52.0 with URL preview functionality enabled will attempt to generate URL previews for media stream URLs without properly limiting connection time. Connections will only be terminated after `max_spider_size` (default: 10M) bytes have been downloaded, which can in some cases lead to long-lived connections towards the streaming media server (for instance, Icecast). This can cause excessive traffic and connections toward such servers if their stream URL is, for example, posted to a large room with many Synapse instances with URL preview enabled. Version 1.52.0 implements a timeout mechanism which will terminate URL preview connections after 30 seconds. Since generating URL previews for media streams is not supported and always fails, 1.53.0 additionally implements an allow list for content types for which Synapse will even attempt to generate a URL preview. Upgrade to 1.53.0 to fully resolve the issue. As a workaround, turn off URL preview functionality by setting `url_preview_enabled: false` in the Synapse configuration file.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-41952", "Vulnerability Categories": "N/A", "Affected Products": "\nMatrix\u00bbSynapseVersions  before (<) 1.53.0cpe:2.3:a:matrix:synapse:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.19% Probability of exploitation activity in the next 30 days\n~ 56 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-06-14  0.19%  0.19%  -0.01 \n 2  2024-05-04  0.16%  0.19%  +0.03 \n 3  2024-02-27  0.14%  0.16%  +0.02 \n 4  2023-12-25  0.12%  0.14%  +0.02 \n 5  2023-11-29  0.07%  0.12%  +0.04 \n 6  2023-10-23  0.06%  0.07%  +0.01 \n 7  2023-03-07  1.02%  0.06%  -0.96 \n 8  2023-02-23  7.18%  1.02%  -6.16 ", "CVSS Scores": "5.3", "CWE": [{"CWE_ID": "CWE-400 Uncontrolled Resource Consumption", "CWE_link": "/cwe-details/400/Uncontrolled-Resource-Consumption.html"}, {"CWE_ID": "CWE-772 Missing Release of Resource after Effective Lifetime", "CWE_link": "/cwe-details/772/Missing-Release-of-Resource-after-Effective-Lifetime.html"}], "Reference": [{"ref_link": "https://github.com/matrix-org/synapse/releases/tag/v1.53.0", "ref_desc": "Release v1.53.0 \u00b7 matrix-org/synapse \u00b7 GitHubRelease Notes;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/matrix-org/synapse/pull/11784", "ref_desc": "Apply a timeout to reading the body when fetching a file. by clokep \u00b7 Pull Request #11784 \u00b7 matrix-org/synapse \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/matrix-org/synapse/pull/11936", "ref_desc": "Implement a content type allow list for URL previews by dkasak \u00b7 Pull Request #11936 \u00b7 matrix-org/synapse \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/matrix-org/synapse/security/advisories/GHSA-4822-jvwx-w47h", "ref_desc": "Generating URL previews of media streams causing long-lived connections \u00b7 Advisory \u00b7 matrix-org/synapse \u00b7 GitHubMitigation;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/matrix-org/synapse/releases/tag/v1.52.0", "ref_desc": "Release v1.52.0 \u00b7 matrix-org/synapse \u00b7 GitHubRelease Notes;Third Party Advisory", "ref_cve_link": "N/A"}]}