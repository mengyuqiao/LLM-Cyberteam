{"CVE Code": "CVE-2022-39254", "Description": "matrix-nio is a Python Matrix client library, designed according to sans I/O principles. Prior to version 0.20, when a users requests a room key from their devices, the software correctly remember the request. Once they receive a forwarded room key, they accept it without checking who the room key came from. This allows homeservers to try to insert room keys of questionable validity, potentially mounting an impersonation attack. Version 0.20 fixes the issue.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-39254", "Vulnerability Categories": "Bypass;Gain privilege", "Affected Products": "\nMatrix-nio Project\u00bbMatrix-nioVersions  before (<) 0.20cpe:2.3:a:matrix-nio_project:matrix-nio:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.05% Probability of exploitation activity in the next 30 days\n~ 18 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-04-21  0.05%  0.05%  +0.00 \n 2  2023-08-30  0.05%  0.05%  +0.00 \n 3  2023-03-07  0.89%  0.05%  -0.84 ", "CVSS Scores": "6.5", "CWE": [{"CWE_ID": "CWE-287 Improper Authentication", "CWE_link": "/cwe-details/287/Improper-Authentication.html"}, {"CWE_ID": "CWE-322 Key Exchange without Entity Authentication", "CWE_link": "/cwe-details/322/Key-Exchange-without-Entity-Authentication.html"}], "Reference": [{"ref_link": "https://github.com/poljar/matrix-nio/commit/b1cbf234a831daa160673defd596e6450e9c29f0", "ref_desc": "fix(crypto): Only accept forwarded room keys from our own trusted dev\u2026 \u00b7 poljar/matrix-nio@b1cbf23 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/poljar/matrix-nio/security/advisories/GHSA-w4pr-4vjg-hffh", "ref_desc": "When receiving forwarded room keys, we don't check that the forwarder device matches the device we requested from \u00b7 Advisory \u00b7 poljar/matrix-nio \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}]}