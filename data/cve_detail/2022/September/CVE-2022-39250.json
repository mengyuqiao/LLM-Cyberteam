{"CVE Code": "CVE-2022-39250", "Description": "Matrix JavaScript SDK is the Matrix Client-Server software development kit (SDK) for JavaScript. Prior to version 19.7.0, an attacker cooperating with a malicious homeserver could interfere with the verification flow between two users, injecting its own cross-signing user identity in place of one of the users\u2019 identities. This would lead to the other device trusting/verifying the user identity under the control of the homeserver instead of the intended one. The vulnerability is a bug in the matrix-js-sdk, caused by checking and signing user identities and devices in two separate steps, and inadequately fixing the keys to be signed between those steps. Even though the attack is partly made possible due to the design decision of treating cross-signing user identities as Matrix devices on the server side (with their device ID set to the public part of the user identity key), no other examined implementations were vulnerable. Starting with version 19.7.0, the matrix-js-sdk has been modified to double check that the key signed is the one that was verified instead of just referencing the key by ID. An additional check has been made to report an error when one of the device ID matches a cross-signing key. As this attack requires coordination between a malicious homeserver and an attacker, those who trust their homeservers do not need a particular workaround.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-39250", "Vulnerability Categories": "Bypass;Gain privilege", "Affected Products": "\nMatrix\u00bbJavascript Sdk\u00bbForNode.jsVersions  before (<) 19.7.0cpe:2.3:a:matrix:javascript_sdk:*:*:*:*:*:node.js:*:*Matching versions", "EPSS Score": "0.11% Probability of exploitation activity in the next 30 days\n~ 46 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.12%  0.11%  0.00 \n 2  2024-04-21  0.11%  0.12%  +0.01 \n 3  2024-03-11  0.09%  0.11%  +0.02 \n 4  2024-01-04  0.08%  0.09%  +0.01 \n 5  2023-11-01  0.08%  0.08%  +0.01 \n 6  2023-10-06  0.06%  0.08%  +0.01 \n 7  2023-08-30  0.05%  0.06%  +0.01 \n 8  2023-03-07  1.02%  0.05%  -0.96 ", "CVSS Scores": "7.5", "CWE": [{"CWE_ID": "CWE-287 Improper Authentication", "CWE_link": "/cwe-details/287/Improper-Authentication.html"}, {"CWE_ID": "CWE-322 Key Exchange without Entity Authentication", "CWE_link": "/cwe-details/322/Key-Exchange-without-Entity-Authentication.html"}], "Reference": [{"ref_link": "https://security.gentoo.org/glsa/202210-35", "ref_desc": "Mozilla Thunderbird: Multiple Vulnerabilities (GLSA 202210-35) \u2014 Gentoo securityThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/-SpHnfl23DBlUIts3gE3aubrSeg.html"}, {"ref_link": "https://github.com/matrix-org/matrix-js-sdk/commit/a587d7c36026fe1fcf93dfff63588abee359be76", "ref_desc": "Resolve multiple CVEs \u00b7 matrix-org/matrix-js-sdk@a587d7c \u00b7 GitHubPatch;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/eDOAomlXwOGe9qjFeUuUUc3rvpU.html"}, {"ref_link": "https://github.com/matrix-org/matrix-js-sdk/security/advisories/GHSA-5w8r-8pgj-5jmf", "ref_desc": "Key/device identifier confusion in SAS verification \u00b7 Advisory \u00b7 matrix-org/matrix-js-sdk \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://matrix.org/blog/2022/09/28/upgrade-now-to-address-encryption-vulns-in-matrix-sdks-and-clients", "ref_desc": "Upgrade now to address E2EE vulnerabilities in matrix-js-sdk, matrix-ios-sdk and matrix-android-sdk2 | Matrix.orgVendor AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/M0cEKVJibKxbSiyBnfkDcFWKlmo.html"}, {"ref_link": "https://github.com/matrix-org/matrix-js-sdk/releases/tag/v19.7.0", "ref_desc": "Release v19.7.0 \u00b7 matrix-org/matrix-js-sdk \u00b7 GitHubRelease Notes;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/s0I6yTKRmv3EyKvbridobc9JZvg.html"}]}