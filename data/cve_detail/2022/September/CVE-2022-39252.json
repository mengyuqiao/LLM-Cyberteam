{"CVE Code": "CVE-2022-39252", "Description": "matrix-rust-sdk is an implementation of a Matrix client-server library in Rust, and matrix-sdk-crypto is the Matrix encryption library. Prior to version 0.6, when a user requests a room key from their devices, the software correctly remembers the request. When the user receives a forwarded room key, the software accepts it without checking who the room key came from. This allows homeservers to try to insert room keys of questionable validity, potentially mounting an impersonation attack. Version 0.6 fixes this issue.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-39252", "Vulnerability Categories": "Bypass;Gain privilege", "Affected Products": "\nMatrix\u00bbMatrix-rust-sdkVersions  before (<) 0.6cpe:2.3:a:matrix:matrix-rust-sdk:*:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.09% Probability of exploitation activity in the next 30 days\n~ 37 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-04-21  0.09%  0.09%  0.00 \n 2  2024-03-11  0.08%  0.09%  +0.01 \n 3  2023-11-01  0.08%  0.08%  +0.01 \n 4  2023-10-06  0.06%  0.08%  +0.01 \n 5  2023-08-30  0.05%  0.06%  +0.01 \n 6  2023-03-07  1.02%  0.05%  -0.96 ", "CVSS Scores": "7.5", "CWE": [{"CWE_ID": "CWE-287 Improper Authentication", "CWE_link": "/cwe-details/287/Improper-Authentication.html"}, {"CWE_ID": "CWE-322 Key Exchange without Entity Authentication", "CWE_link": "/cwe-details/322/Key-Exchange-without-Entity-Authentication.html"}], "Reference": [{"ref_link": "https://github.com/matrix-org/matrix-rust-sdk/releases/tag/matrix-sdk-0.6.0", "ref_desc": "Release 2022-09-28 - Matrix SDK 0.6.0 \u00b7 matrix-org/matrix-rust-sdk \u00b7 GitHubRelease Notes;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/matrix-org/matrix-rust-sdk/commit/41449d2cc360e347f5d4e1c154ec1e3185f11acd", "ref_desc": "test(crypto): Test that we reject forwarded room keys from other users \u00b7 matrix-org/matrix-rust-sdk@41449d2 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/matrix-org/matrix-rust-sdk/security/advisories/GHSA-vp68-2wrm-69qm", "ref_desc": "When receiving forwarded room keys, we don't check that the forwarder device matches the device we requested from \u00b7 Advisory \u00b7 matrix-org/matrix-rust-sdk \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/matrix-org/matrix-rust-sdk/commit/093fb5d0aa21c0b5eaea6ec96b477f1075271cbb", "ref_desc": "fix(crypto): Only accept forwarded room keys from our own trusted dev\u2026 \u00b7 matrix-org/matrix-rust-sdk@093fb5d \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}]}