{"CVE Code": "CVE-2022-24795", "Description": "yajl-ruby is a C binding to the YAJL JSON parsing and generation library. The 1.x branch and the 2.x branch of `yajl` contain an integer overflow which leads to subsequent heap memory corruption when dealing with large (~2GB) inputs. The reallocation logic at `yajl_buf.c#L64` may result in the `need` 32bit integer wrapping to 0 when `need` approaches a value of 0x80000000 (i.e. ~2GB of data), which results in a reallocation of buf->alloc into a small heap chunk. These integers are declared as `size_t` in the 2.x branch of `yajl`, which practically prevents the issue from triggering on 64bit platforms, however this does not preclude this issue triggering on 32bit builds on which `size_t` is a 32bit integer. Subsequent population of this under-allocated heap chunk is based on the original buffer size, leading to heap memory corruption. This vulnerability mostly impacts process availability. Maintainers believe exploitation for arbitrary code execution is unlikely. A patch is available and anticipated to be part of yajl-ruby version 1.4.2. As a workaround, avoid passing large inputs to YAJL.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2022-24795", "Vulnerability Categories": "Overflow;Memory Corruption", "Affected Products": "\nYajl-ruby Project\u00bbYajl-ruby\u00bbForRubyVersions  before (<) 1.4.2cpe:2.3:a:yajl-ruby_project:yajl-ruby:*:*:*:*:*:ruby:*:*Matching versions", "EPSS Score": "1.43% Probability of exploitation activity in the next 30 days\n~ 86 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  1.50%  1.43%  -0.08 \n 2  2024-11-09  1.29%  1.50%  +0.21 \n 3  2024-06-27  1.00%  1.29%  +0.29 \n 4  2023-12-24  0.99%  1.00%  +0.02 \n 5  2023-11-25  0.58%  0.99%  +0.40 \n 6  2023-11-11  0.47%  0.58%  +0.11 \n 7  2023-10-27  0.46%  0.47%  +0.02 \n 8  2023-09-16  0.39%  0.46%  +0.07 \n 9  2023-08-06  0.15%  0.39%  +0.24 \n 10  2023-07-27  0.13%  0.15%  +0.03 \n 11  2023-07-16  0.11%  0.13%  +0.02 \n 12  2023-07-12  0.09%  0.11%  +0.02 \n 13  2023-05-08  0.08%  0.09%  +0.01 \n 14  2023-04-12  0.07%  0.08%  +0.01 \n 15  2023-03-07  2.51%  0.07%  -2.44 ", "CVSS Scores": "5.0", "CWE": [{"CWE_ID": "CWE-122 Heap-based Buffer Overflow", "CWE_link": "/cwe-details/122/Heap-based-Buffer-Overflow.html"}, {"CWE_ID": "CWE-190 Integer Overflow or Wraparound", "CWE_link": "/cwe-details/190/Integer-Overflow-or-Wraparound.html"}], "Reference": [{"ref_link": "https://github.com/brianmario/yajl-ruby/security/advisories/GHSA-jj47-x69x-mxrm", "ref_desc": "Reallocation bug can trigger heap memory corruption \u00b7 Advisory \u00b7 brianmario/yajl-ruby \u00b7 GitHubExploit;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/brianmario/yajl-ruby/commit/7168bd79b888900aa94523301126f968a93eb3a6", "ref_desc": "Merge pull request #204 from eileencodes/fix-c-warnings \u00b7 brianmario/yajl-ruby@7168bd7 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/brianmario/yajl-ruby/blob/7168bd79b888900aa94523301126f968a93eb3a6/ext/yajl/yajl_buf.c#L64", "ref_desc": "yajl-ruby/yajl_buf.c at 7168bd79b888900aa94523301126f968a93eb3a6 \u00b7 brianmario/yajl-ruby \u00b7 GitHubExploit;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://lists.debian.org/debian-lts-announce/2023/08/msg00003.html", "ref_desc": "[SECURITY] [DLA 3516-1] burp security updateCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/oy_KmXSDGVH96iVQ2rHhPi6ilmI.html"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KLE3C4CECEJ4EUYI56KXI6OWACWXX7WN/", "ref_desc": "[SECURITY] Fedora 38 Update: yajl-2.1.0-21.fc38 - package-announce - Fedora Mailing-ListsCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/s40JEEjHlYTFljfsmWXQJxJbluI.html"}, {"ref_link": "https://lists.debian.org/debian-lts-announce/2023/07/msg00013.html", "ref_desc": "[SECURITY] [DLA 3492-1] yajl security updateCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/xXXvoWhFMUB5B3pKzFOKm3-iSog.html"}, {"ref_link": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/YO32YDJ74DADC7CMJNLSLBVWN5EXGF5J/", "ref_desc": "[SECURITY] Fedora 37 Update: yajl-2.1.0-21.fc37 - package-announce - Fedora Mailing-ListsCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/yP3RgfsjVvuFSGcHU0IuwVpsnzQ.html"}]}