{"CVE Code": "CVE-2020-12887", "Description": "Memory leaks were discovered in the CoAP library in Arm Mbed OS 5.15.3 when using the Arm mbed-coap library 5.1.5. The CoAP parser is responsible for parsing received CoAP packets. The function sn_coap_parser_options_parse() parses the CoAP option number field of all options present in the input packet. Each option number is calculated as a sum of the previous option number and a delta of the current option. The delta and the previous option number are expressed as unsigned 16-bit integers. Due to lack of overflow detection, it is possible to craft a packet that wraps the option number around and results in the same option number being processed again in a single packet. Certain options allocate memory by calling a memory allocation function. In the cases of COAP_OPTION_URI_QUERY, COAP_OPTION_URI_PATH, COAP_OPTION_LOCATION_QUERY, and COAP_OPTION_ETAG, there is no check on whether memory has already been allocated, which in conjunction with the option number integer overflow may lead to multiple assignments of allocated memory to a single pointer. This has been demonstrated to lead to memory leak by buffer orphaning. As a result, the memory is never freed.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2020-12887", "Vulnerability Categories": "Overflow", "Affected Products": "\nARM\u00bbMbed-coap\u00bbVersion:5.1.5cpe:2.3:a:arm:mbed-coap:5.1.5:*:*:*:*:*:*:*Matching versionsWhen used together with:ARM\u00bbMbed Os\u00bbVersion:5.15.3", "EPSS Score": "0.40% Probability of exploitation activity in the next 30 days\n~ 73 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.49%  0.40%  -0.10 \n 2  2024-04-22  0.36%  0.49%  +0.14 \n 3  2024-04-07  0.30%  0.36%  +0.06 \n 4  2023-03-07  1.02%  0.30%  -0.72 ", "CVSS Scores": "5.0", "CWE": [{"CWE_ID": "CWE-190 Integer Overflow or Wraparound", "CWE_link": "/cwe-details/190/Integer-Overflow-or-Wraparound.html"}, {"CWE_ID": "CWE-401 Missing Release of Memory after Effective Lifetime", "CWE_link": "/cwe-details/401/Missing-Release-of-Memory-after-Effective-Lifetime.html"}], "Reference": [{"ref_link": "https://github.com/ARMmbed/mbed-coap/pull/116", "ref_desc": "Bugfix/coap parser mem access bugs by mjurczak \u00b7 Pull Request #116 \u00b7 ARMmbed/mbed-coap \u00b7 GitHubThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/B7ILbZKq1E0svdYFqazihHhhX2s.html"}, {"ref_link": "https://github.com/ARMmbed/mbed-os/issues/12930", "ref_desc": "Integer overflow in MbedOS CoAP library parser \u00b7 Issue #12930 \u00b7 ARMmbed/mbed-os \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/ARMmbed/mbed-os/issues/12957", "ref_desc": "Memory leak in MbedOS CoAP library parser - sn_coap_parser_options_parse() \u00b7 Issue #12957 \u00b7 ARMmbed/mbed-os \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/mjurczak/mbed-coap/commit/4647a68e364401e81dbd370728127d844f221d93", "ref_desc": "Implemented measures to prevent memory leaks in sn_coap_parser_option\u2026 \u00b7 mjurczak/mbed-coap@4647a68 \u00b7 GitHubPatch;Third Party Advisory", "ref_cve_link": "N/A"}]}