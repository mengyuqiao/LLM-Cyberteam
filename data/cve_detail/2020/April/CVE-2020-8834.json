{"CVE Code": "CVE-2020-8834", "Description": "KVM in the Linux kernel on Power8 processors has a conflicting use of HSTATE_HOST_R1 to store r1 state in kvmppc_hv_entry plus in kvmppc_{save,restore}_tm, leading to a stack corruption. Because of this, an attacker with the ability run code in kernel space of a guest VM can cause the host kernel to panic. There were two commits that, according to the reporter, introduced the vulnerability: f024ee098476 (\"KVM: PPC: Book3S HV: Pull out TM state save/restore into separate procedures\") 87a11bb6a7f7 (\"KVM: PPC: Book3S HV: Work around XER[SO] bug in fake suspend mode\") The former landed in 4.8, the latter in 4.17. This was fixed without realizing the impact in 4.18 with the following three commits, though it's believed the first is the only strictly necessary commit: 6f597c6b63b6 (\"KVM: PPC: Book3S PR: Add guest MSR parameter for kvmppc_save_tm()/kvmppc_restore_tm()\") 7b0e827c6970 (\"KVM: PPC: Book3S HV: Factor fake-suspend handling out of kvmppc_save/restore_tm\") 009c872a8bc4 (\"KVM: PPC: Book3S PR: Move kvmppc_save_tm/kvmppc_restore_tm to separate file\")", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2020-8834", "Vulnerability Categories": "N/A", "Affected Products": "\nLinux\u00bbLinux Kernel\u00bbVersion:N/Acpe:2.3:o:linux:linux_kernel:-:*:*:*:*:*:*:*Matching versionsWhen used together with:IBM\u00bbPower8\u00bbVersion:N/A\nCanonical\u00bbUbuntu Linux\u00bbVersion:16.04    LTSEditioncpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*Matching versions\nCanonical\u00bbUbuntu Linux\u00bbVersion:18.04    LTSEditioncpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*Matching versions\nOpensuse\u00bbLeap\u00bbVersion:15.1cpe:2.3:o:opensuse:leap:15.1:*:*:*:*:*:*:*Matching versions", "EPSS Score": "0.07% Probability of exploitation activity in the next 30 days\n~ 33 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.05%  0.07%  +0.02 \n 2  2023-03-07  0.95%  0.05%  -0.90 \n 3  2023-02-23  1.67%  0.95%  -0.72 ", "CVSS Scores": "4.9", "CWE": [{"CWE_ID": "CWE-362 Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')", "CWE_link": "/cwe-details/362/Concurrent-Execution-using-Shared-Resource-with-Improper-Syn.html"}, {"CWE_ID": "CWE-368 Context Switching Race Condition", "CWE_link": "/cwe-details/368/Context-Switching-Race-Condition.html"}], "Reference": [{"ref_link": "https://www.openwall.com/lists/oss-security/2020/04/06/2", "ref_desc": "oss-security - CVE-2020-8834: Linux kernel Power8 conflicting use of HSTATE_HOST_R1 vulnerabilityMailing List;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://usn.ubuntu.com/4318-1/", "ref_desc": "USN-4318-1: Linux kernel vulnerabilities | Ubuntu security noticesThird Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/5LIykg-PXKafzFt5Fhuy27umdC8.html"}, {"ref_link": "https://usn.ubuntu.com/usn/usn-4318-1", "ref_desc": "USN-4318-1: Linux kernel vulnerabilities | Ubuntu security noticesThird Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://bugs.launchpad.net/ubuntu/+source/linux/+bug/1867717", "ref_desc": "Bug #1867717 \u201cPPC: KVM: Book3S HV: Fix conflicting use of HSTATE...\u201d : Bugs : linux package : UbuntuExploit;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "http://lists.opensuse.org/opensuse-security-announce/2020-04/msg00035.html", "ref_desc": "[security-announce] openSUSE-SU-2020:0543-1: important: Security updateMailing List;Third Party AdvisoryCVEs referencing this url", "ref_cve_link": "https://www.cvedetails.com/reference-url-info/nr_CPnd6nebpO022-pOxFun_pUg.html"}]}