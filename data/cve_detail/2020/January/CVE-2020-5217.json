{"CVE Code": "CVE-2020-5217", "Description": "In Secure Headers (RubyGem secure_headers), a directive injection vulnerability is present in versions before 3.8.0, 5.1.0, and 6.2.0. If user-supplied input was passed into append/override_content_security_policy_directives, a semicolon could be injected leading to directive injection. This could be used to e.g. override a script-src directive. Duplicate directives are ignored and the first one wins. The directives in secure_headers are sorted alphabetically so they pretty much all come before script-src. A previously undefined directive would receive a value even if SecureHeaders::OPT_OUT was supplied. The fixed versions will silently convert the semicolons to spaces and emit a deprecation warning when this happens. This will result in innocuous browser console messages if being exploited/accidentally used. In future releases, we will raise application errors resulting in 500s. Depending on what major version you are using, the fixed versions are 6.2.0, 5.1.0, 3.8.0.", "NVD Link": "https://nvd.nist.gov/vuln/detail/CVE-2020-5217", "Vulnerability Categories": "N/A", "Affected Products": "\nTwitter\u00bbSecure Headers\u00bbForRubyVersions  from including (>=) 5.0.0andbefore (<) 5.1.0cpe:2.3:a:twitter:secure_headers:*:*:*:*:*:ruby:*:*Matching versions\nTwitter\u00bbSecure Headers\u00bbForRubyVersions  from including (>=) 6.0.0andbefore (<) 6.2.0cpe:2.3:a:twitter:secure_headers:*:*:*:*:*:ruby:*:*Matching versions\nTwitter\u00bbSecure Headers\u00bbForRubyVersions  before (<) 3.8.0cpe:2.3:a:twitter:secure_headers:*:*:*:*:*:ruby:*:*Matching versions", "EPSS Score": "0.20% Probability of exploitation activity in the next 30 days\n~ 58 % Percentile, the proportion of vulnerabilities that are scored at or less", "EPSS History": "\n #  Date  Old EPSS Score  New EPSS Score  Delta (New - Old) \n 1  2024-12-17  0.15%  0.20%  +0.06 \n 2  2023-03-07  1.02%  0.15%  -0.87 ", "CVSS Scores": "5.0", "CWE": [{"CWE_ID": "CWE-74 Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')", "CWE_link": "/cwe-details/74/Improper-Neutralization-of-Special-Elements-in-Output-Used-b.html"}, {"CWE_ID": "CWE-95 Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')", "CWE_link": "/cwe-details/95/Improper-Neutralization-of-Directives-in-Dynamically-Evaluat.html"}], "Reference": [{"ref_link": "https://github.com/twitter/secure_headers/commit/936a160e3e9659737a9f9eafce13eea36b5c9fa3", "ref_desc": "Merge pull request #421 from twitter/escape-semi-colons-5.x \u00b7 github/secure_headers@936a160 \u00b7 GitHubPatch", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/twitter/secure_headers/issues/418", "ref_desc": "Filtering CSP entries to prevent bypassing rules \u00b7 Issue #418 \u00b7 github/secure_headers \u00b7 GitHubExploit;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/twitter/secure_headers/security/advisories/GHSA-xq52-rv6w-397c", "ref_desc": "Directive injection when using dynamic overrides with user input \u00b7 Advisory \u00b7 github/secure_headers \u00b7 GitHubMitigation;Third Party Advisory", "ref_cve_link": "N/A"}, {"ref_link": "https://github.com/twitter/secure_headers/pull/421", "ref_desc": "escape semicolons by replacing them with spaces for 5.x line by oreoshake \u00b7 Pull Request #421 \u00b7 github/secure_headers \u00b7 GitHubThird Party Advisory", "ref_cve_link": "N/A"}]}